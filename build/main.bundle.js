!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=127)}([function(e,t,r){"use strict";var n=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(2),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.__esModule=!0;var i=r(81),s=n(i),u=r(66),c=n(u),d="function"==typeof c.default&&"symbol"===(0,a.default)(s.default)?function(e){return void 0===e?"undefined":(0,a.default)(e)}:function(e){return e&&"function"==typeof c.default&&e.constructor===c.default&&e!==c.default.prototype?"symbol":void 0===e?"undefined":(0,a.default)(e)};t.default="function"==typeof c.default&&"symbol"===d(s.default)?function(e){return void 0===e?"undefined":d(e)}:function(e){return e&&"function"==typeof c.default&&e.constructor===c.default&&e!==c.default.prototype?"symbol":void 0===e?"undefined":d(e)}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(45),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){"use strict";e.exports={default:r(141),__esModule:!0}},function(e,t,r){"use strict";var n=r(9),o=r(0),a=r(21),i=r(24),s=function e(t,r,s){var u,c,d,l=t&e.F,f=t&e.G,p=t&e.S,m=t&e.P,h=t&e.B,v=t&e.W,_=f?o:o[r]||(o[r]={}),y=_.prototype,g=f?n:p?n[r]:(n[r]||{}).prototype;f&&(s=r);for(u in s)(c=!l&&g&&void 0!==g[u])&&u in _||(d=c?g[u]:s[u],_[u]=f&&"function"!=typeof g[u]?s[u]:h&&c?a(d,n):v&&g[u]==d?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):m&&"function"==typeof d?a(Function.call,d):d,m&&((_.virtual||(_.virtual={}))[u]=d,t&e.R&&y&&!y[u]&&i(y,u,d)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,r){"use strict";t.__esModule=!0;var n=r(2),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,o.default)(t))&&"function"!=typeof t?e:t}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(117),a=n(o),i=r(60),s=n(i),u=r(2),c=n(u);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,c.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a.default?(0,a.default)(e,t):e.__proto__=t)}},function(e,t,r){"use strict";var n=r(63)("wks"),o=r(48),a=r(9).Symbol,i="function"==typeof a;(e.exports=function(e){return n[e]||(n[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=n},function(e,t,r){"use strict";var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),a=n(o),i=r(3),s=n(i),u=r(187),c=n(u),d="mediasoup-client",l=function(){function e(t){(0,a.default)(this,e),t?(this._debug=(0,c.default)(d+":"+t),this._warn=(0,c.default)(d+":WARN:"+t),this._error=(0,c.default)(d+":ERROR:"+t)):(this._debug=(0,c.default)(d),this._warn=(0,c.default)(d+":WARN"),this._error=(0,c.default)(d+":ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,s.default)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();t.default=l},function(e,t,r){"use strict";e.exports={default:r(205),__esModule:!0}},function(e,t,r){"use strict";var n=r(2),o=function(e){return e&&e.__esModule?e:{default:e}}(n);e.exports=function(e){return"object"===(void 0===e?"undefined":(0,o.default)(e))?null!==e:"function"==typeof e}},function(e,t,r){"use strict";e.exports={default:r(216),__esModule:!0}},function(e,t,r){"use strict";var n,o=r(2),a=function(e){return e&&e.__esModule?e:{default:e}}(o);n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":(0,a.default)(window))&&(n=window)}e.exports=n},function(e,t,r){"use strict";var n=r(45),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(18),i=r(82),s=r(59),u=o.default;t.f=r(16)?o.default:function(e,t,r){if(a(e),t=s(t,!0),a(r),i)try{return u(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";e.exports=!r(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";e.exports={default:r(182),__esModule:!0}},function(e,t,r){"use strict";var n=r(12);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(70),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=o.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}},function(e,t,r){"use strict";e.exports={default:r(191),__esModule:!0}},function(e,t,r){"use strict";var n=r(36);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),a=n(o),i=r(4),s=n(i),u=r(1),c=n(u),d=r(3),l=n(d),f=r(6),p=n(f),m=r(7),h=n(m),v=r(54),_=r(10),y=n(_),g=function(e){function t(e){(0,c.default)(this,t);var r=(0,p.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return r.setMaxListeners(1/0),r._logger=e||new y.default("EnhancedEventEmitter"),r}return(0,h.default)(t,e),(0,l.default)(t,[{key:"safeEmit",value:function(e){try{for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.emit.apply(this,[e].concat(r))}catch(t){this._logger.error("safeEmit() | event listener threw an error [event:%s]:%o",e,t)}}},{key:"safeEmitAsPromise",value:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return new a.default(function(r,o){var a=function(e){r(e)},i=function(r){t._logger.error("safeEmitAsPromise() | errback called [event:%s]:%o",e,r),o(r)};t.safeEmit.apply(t,[e].concat(n,[a,i]))})}}]),t}(v.EventEmitter);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return d()}function a(e){return JSON.parse((0,s.default)(e))}Object.defineProperty(t,"__esModule",{value:!0});var i=r(34),s=n(i);t.randomNumber=o,t.clone=a;var u=r(119),c=n(u),d=c.default.generator({min:1e7,max:99999999,integer:!0})},function(e,t,r){"use strict";var n=r(15),o=r(37);e.exports=r(16)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";e.exports={default:r(137),__esModule:!0}},function(e,t,r){"use strict";var n=r(129)(!0);r(57)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,r){"use strict";var n=r(61),o=r(56);e.exports=function(e){return n(o(e))}},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";var n=r(56);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";var n=r(5),o=r(0),a=r(27);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],i={};i[e]=t(r),n(n.S+n.F*a(function(){r(1)}),"Object",i)}},function(e,t,r){"use strict";r(143);for(var n=r(9),o=r(24),a=r(30),i=r(8)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],d=n[c],l=d&&d.prototype;l&&!l[i]&&o(l,i,c),a[c]=a.Array}},function(e,t,r){"use strict";e.exports={default:r(188),__esModule:!0}},function(e,t,r){"use strict";var n=r(214),o=r(215);t.write=o,t.parse=n.parse,t.parseFmtpConfig=n.parseFmtpConfig,t.parseParams=n.parseParams,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates,t.parseImageAttributes=n.parseImageAttributes,t.parseSimulcastStreamList=n.parseSimulcastStreamList},function(e,t,r){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(25),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(86),i=r(64);e.exports=o.default||function(e){return a(e,i)}},function(e,t,r){"use strict";var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,r){"use strict";var n=r(15).f,o=r(28),a=r(8)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},function(e,t,r){"use strict";var n=r(21),o=r(101),a=r(102),i=r(18),s=r(47),u=r(71),c={},d={},l=e.exports=function(e,t,r,l,f){var p,m,h,v,_=f?function(){return e}:u(e),y=n(r,l,t?2:1),g=0;if("function"!=typeof _)throw TypeError(e+" is not iterable!");if(a(_)){for(p=s(e.length);p>g;g++)if((v=t?y(i(m=e[g])[0],m[1]):y(e[g]))===c||v===d)return v}else for(h=_.call(e);!(m=h.next()).done;)if((v=o(h,y,m.value,t))===c||v===d)return v};l.BREAK=c,l.RETURN=d},function(e,t,r){"use strict";function n(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=!0,o=!1,a=void 0;try{for(var i,s=(0,m.default)(t.codecs||[]);!(n=(i=s.next()).done);n=!0){(function(){var t=i.value;if("rtx"===t.name)return"continue";var n=(e.codecs||[]).find(function(e){return d(e,t)});if(n){var o={name:t.name,mimeType:t.mimeType,kind:t.kind,clockRate:t.clockRate,sendPayloadType:n.preferredPayloadType,sendRtxPayloadType:null,recvPayloadType:t.preferredPayloadType,recvRtxPayloadType:null,channels:t.channels,rtcpFeedback:f(n,t),parameters:t.parameters};o.channels||delete o.channels,r.codecs.push(o)}})()}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var u=!0,c=!1,p=void 0;try{for(var h,v=(0,m.default)(r.codecs||[]);!(u=(h=v.next()).done);u=!0)!function(){var r=h.value,n=(e.codecs||[]).find(function(e){return"rtx"===e.name&&e.parameters.apt===r.sendPayloadType}),o=(t.codecs||[]).find(function(e){return"rtx"===e.name&&e.parameters.apt===r.recvPayloadType});n&&o&&(r.sendRtxPayloadType=n.preferredPayloadType,r.recvRtxPayloadType=o.preferredPayloadType)}()}catch(e){c=!0,p=e}finally{try{!u&&v.return&&v.return()}finally{if(c)throw p}}var _=!0,y=!1,g=void 0;try{for(var b,w=(0,m.default)(t.headerExtensions||[]);!(_=(b=w.next()).done);_=!0)!function(){var t=b.value,n=(e.headerExtensions||[]).find(function(e){return l(e,t)});if(n){var o={kind:t.kind,uri:t.uri,sendId:n.preferredId,recvId:t.preferredId};r.headerExtensions.push(o)}}()}catch(e){y=!0,g=e}finally{try{!_&&w.return&&w.return()}finally{if(y)throw g}}return r}function o(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[]},r=!0,n=!1,o=void 0;try{for(var a,i=(0,m.default)(e.codecs);!(r=(a=i.next()).done);r=!0){var s=a.value,u={name:s.name,mimeType:s.mimeType,kind:s.kind,clockRate:s.clockRate,preferredPayloadType:s.recvPayloadType,channels:s.channels,rtcpFeedback:s.rtcpFeedback,parameters:s.parameters};if(u.channels||delete u.channels,t.codecs.push(u),s.recvRtxPayloadType){var c={name:"rtx",mimeType:s.kind+"/rtx",kind:s.kind,clockRate:s.clockRate,preferredPayloadType:s.recvRtxPayloadType,parameters:{apt:s.recvPayloadType}};t.codecs.push(c)}}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}var d=!0,l=!1,f=void 0;try{for(var p,h=(0,m.default)(e.headerExtensions);!(d=(p=h.next()).done);d=!0){var v=p.value,_={kind:v.kind,uri:v.uri,preferredId:v.recvId};t.headerExtensions.push(_)}}catch(e){l=!0,f=e}finally{try{!d&&h.return&&h.return()}finally{if(l)throw f}}return t.fecMechanisms=e.fecMechanisms,t}function a(e,t,r){if(!Array.isArray(t))return[];var n=[],o=e.codecs,a=r.codecs,i=!0,s=!1,u=void 0;try{for(var c,d=(0,m.default)(t);!(i=(c=d.next()).done);i=!0)!function(){var e=c.value;if(!a.some(function(t){return t.recvPayloadType===e})){var t=o.find(function(t){return t.preferredPayloadType===e});if(!t)throw new Error("mandatory codec PT "+e+" not found in remote codecs");n.push(t)}}()}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}return n}function i(e,t){return t.codecs.some(function(t){return t.kind===e})}function s(e,t){if(0===e.codecs.length)return!1;var r=e.codecs[0];return t.codecs.some(function(e){return e.recvPayloadType===r.payloadType})}function u(e,t){var r={muxId:null,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},n=!0,o=!1,a=void 0;try{for(var i,s=(0,m.default)(t.codecs);!(n=(i=s.next()).done);n=!0){var u=i.value;if(u.kind===e){var c={name:u.name,mimeType:u.mimeType,clockRate:u.clockRate,payloadType:u.sendPayloadType,channels:u.channels,rtcpFeedback:u.rtcpFeedback,parameters:u.parameters};if(c.channels||delete c.channels,r.codecs.push(c),u.sendRtxPayloadType){var d={name:"rtx",mimeType:u.kind+"/rtx",clockRate:u.clockRate,payloadType:u.sendRtxPayloadType,parameters:{apt:u.sendPayloadType}};r.codecs.push(d)}break}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var l=!0,f=!1,p=void 0;try{for(var h,v=(0,m.default)(t.headerExtensions);!(l=(h=v.next()).done);l=!0){var _=h.value;if(!_.kind||_.kind===e){var y={uri:_.uri,id:_.sendId};r.headerExtensions.push(y)}}}catch(e){f=!0,p=e}finally{try{!l&&v.return&&v.return()}finally{if(f)throw p}}return r}function c(e,t){var r={muxId:null,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},n=!0,o=!1,a=void 0;try{for(var i,s=(0,m.default)(t.codecs);!(n=(i=s.next()).done);n=!0){var u=i.value;if(u.kind===e){var c={name:u.name,mimeType:u.mimeType,clockRate:u.clockRate,payloadType:u.recvPayloadType,channels:u.channels,rtcpFeedback:u.rtcpFeedback,parameters:u.parameters};if(c.channels||delete c.channels,r.codecs.push(c),u.recvRtxPayloadType){var d={name:"rtx",mimeType:u.kind+"/rtx",clockRate:u.clockRate,payloadType:u.recvRtxPayloadType,parameters:{apt:u.recvPayloadType}};r.codecs.push(d)}}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var l=!0,f=!1,p=void 0;try{for(var h,v=(0,m.default)(t.headerExtensions);!(l=(h=v.next()).done);l=!0){var _=h.value;if(!_.kind||_.kind===e){var y={uri:_.uri,id:_.recvId};r.headerExtensions.push(y)}}}catch(e){f=!0,p=e}finally{try{!l&&v.return&&v.return()}finally{if(f)throw p}}return r}function d(e,t){var r=e.mimeType.toLowerCase();if(r!==t.mimeType.toLowerCase())return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;if("video/h264"===r){if(((e.parameters||{})["packetization-mode"]||0)!==((t.parameters||{})["packetization-mode"]||0))return!1}return!0}function l(e,t){return(!e.kind||!t.kind||e.kind===t.kind)&&e.uri===t.uri}function f(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=(0,m.default)(e.rtcpFeedback||[]);!(n=(i=s.next()).done);n=!0)!function(){var e=i.value,n=(t.rtcpFeedback||[]).find(function(t){return t.type===e.type&&t.parameter===e.parameter});n&&r.push(n)}()}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}Object.defineProperty(t,"__esModule",{value:!0});var p=r(13),m=function(e){return e&&e.__esModule?e:{default:e}}(p);t.getExtendedRtpCapabilities=n,t.getRtpCapabilities=o,t.getUnsupportedCodecs=a,t.canSend=i,t.canReceive=s,t.getSendingRtpParameters=u,t.getReceivingFullRtpParameters=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UnsupportedError=t.TimeoutError=t.InvalidStateError=void 0;var o=r(4),a=n(o),i=r(1),s=n(i),u=r(6),c=n(u),d=r(7),l=n(d);t.InvalidStateError=function(e){function t(e){(0,s.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return Object.defineProperty(r,"name",{enumerable:!1,writable:!1,value:"InvalidStateError"}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(r,t):Object.defineProperty(r,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),r}return(0,l.default)(t,e),t}(Error),t.TimeoutError=function(e){function t(e){(0,s.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return Object.defineProperty(r,"name",{enumerable:!1,writable:!1,value:"TimeoutError"}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(r,t):Object.defineProperty(r,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),r}return(0,l.default)(t,e),t}(Error),t.UnsupportedError=function(e){function t(e,r){(0,s.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return Object.defineProperty(n,"name",{enumerable:!1,writable:!1,value:"UnsupportedError"}),Object.defineProperty(n,"data",{enumerable:!0,writable:!1,value:r}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(n,t):Object.defineProperty(n,"stack",{enumerable:!1,writable:!1,value:new Error(e).stack}),n}return(0,l.default)(t,e),t}(Error)},function(e,t,r){"use strict";e.exports=!0},function(e,t,r){"use strict";e.exports={default:r(130),__esModule:!0}},function(e,t,r){"use strict";var n=r(60),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(18),i=r(84),s=r(64),u=r(62)("IE_PROTO"),c=function(){},d=function(){var e,t=r(58)("iframe"),n=s.length;for(t.style.display="none",r(87).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),d=e.F;n--;)delete d.prototype[s[n]];return d()};e.exports=o.default||function(e,t){var r;return null!==e?(c.prototype=a(e),r=new c,c.prototype=null,r[u]=e):r=d(),void 0===t?r:i(r,t)}},function(e,t,r){"use strict";var n=r(55),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){"use strict";var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(2),a=n(o),i=r(146),s=n(i),u=r(149),c=n(u),d=r(48)("meta"),l=r(12),f=r(28),p=r(15).f,m=0,h=c.default||function(){return!0},v=!r(27)(function(){return h((0,s.default)({}))}),_=function(e){p(e,d,{value:{i:"O"+ ++m,w:{}}})},y=function(e,t){if(!l(e))return"symbol"==(void 0===e?"undefined":(0,a.default)(e))?e:("string"==typeof e?"S":"P")+e;if(!f(e,d)){if(!h(e))return"F";if(!t)return"E";_(e)}return e[d].i},g=function(e,t){if(!f(e,d)){if(!h(e))return!0;if(!t)return!1;_(e)}return e[d].w},b=function(e){return v&&w.NEED&&h(e)&&!f(e,d)&&_(e),e},w=e.exports={KEY:d,NEED:!1,fastKey:y,getWeak:g,onFreeze:b}},function(e,t,r){"use strict";t.f={}.propertyIsEnumerable},function(e,t,r){"use strict"},function(e,t,r){"use strict";var n=r(39),o=r(8)("toStringTag"),a="Arguments"==n(function(){return arguments}()),i=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=i(t=Object(e),o))?r:a?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){"use strict";e.exports={default:r(200),__esModule:!0}},function(e,t,r){"use strict";function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function a(e){return"number"==typeof e}function i(e){return"object"===(void 0===e?"undefined":(0,c.default)(e))&&null!==e}function s(e){return void 0===e}var u=r(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u);e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(r=this._events[e],s(r))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(i(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,u=0;u<n;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,a,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],a=r.length,n=-1,r===t||o(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(s=a;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],o(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},function(e,t,r){"use strict";e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){"use strict";var n=r(44),o=r(5),a=r(83),i=r(24),s=r(28),u=r(30),c=r(132),d=r(40),l=r(88),f=r(8)("iterator"),p=!([].keys&&"next"in[].keys()),m=function(){return this};e.exports=function(e,t,r,h,v,_,y){c(r,t,h);var g,b,w,k=function(e){if(!p&&e in E)return E[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},P=t+" Iterator",C="values"==v,S=!1,E=e.prototype,x=E[f]||E["@@iterator"]||v&&E[v],T=!p&&x||k(v),R=v?C?k("entries"):T:void 0,O="Array"==t?E.entries||x:x;if(O&&(w=l(O.call(new e)))!==Object.prototype&&w.next&&(d(w,P,!0),n||s(w,f)||i(w,f,m)),C&&x&&"values"!==x.name&&(S=!0,T=function(){return x.call(this)}),n&&!y||!p&&!S&&E[f]||i(E,f,T),u[t]=T,u[P]=m,v)if(g={values:C?T:k("values"),keys:_?T:k("keys"),entries:R},y)for(b in g)b in E||a(E,b,g[b]);else o(o.P+o.F*(p||S),t,g);return g}},function(e,t,r){"use strict";var n=r(12),o=r(9).document,a=n(o)&&n(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,r){"use strict";var n=r(12);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){"use strict";e.exports={default:r(133),__esModule:!0}},function(e,t,r){"use strict";var n=r(39);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){"use strict";var n=r(63)("keys"),o=r(48);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t,r){"use strict";var n=r(9),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t,r){"use strict";e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){"use strict";t.f=r(8)},function(e,t,r){"use strict";e.exports={default:r(145),__esModule:!0}},function(e,t,r){"use strict";var n=r(9),o=r(0),a=r(44),i=r(65),s=r(15).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=a?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:i.f(e)})}},function(e,t,r){"use strict";var n=r(153),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.f=o.default},function(e,t,r){"use strict";var n=r(157),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(50),i=r(37),s=r(29),u=r(59),c=r(28),d=r(82),l=o.default;t.f=r(16)?l:function(e,t){if(e=s(e),t=u(t,!0),d)try{return l(e,t)}catch(e){}if(c(e,t))return i(!a.f.call(e,t),e[t])}},function(e,t,r){"use strict";e.exports={default:r(177),__esModule:!0}},function(e,t,r){"use strict";var n=r(52),o=r(8)("iterator"),a=r(30);e.exports=r(0).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||a[n(e)]}},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),a=n(o),i=r(3),s=n(i),u=r(185),c=n(u),d=r(10),l=n(d),f=r(190),p=n(f),m=r(222),h=n(m),v=r(223),_=n(v),y=r(226),g=n(y),b=new l.default("Device"),w=function(){function t(){(0,a.default)(this,t)}return(0,s.default)(t,null,[{key:"isSupported",value:function(){return t._detected||t._detect(),Boolean(t._handlerClass)}},{key:"_detect",value:function(){var r=e.navigator.userAgent,n=c.default._detect(r);t._detected=!0,t._flag=void 0,t._name=n.name||"unknown device",t._version=n.version||"unknown vesion",t._bowser=n,t._handlerClass=null,c.default.check({chrome:"55",chromium:"55"},!0,r)?(t._flag="chrome",t._handlerClass=p.default):c.default.check({firefox:"50"},!0,r)?(t._flag="firefox",t._handlerClass=_.default):c.default.check({safari:"11"},!0,r)?(t._flag="safari",t._handlerClass=h.default):c.default.check({msedge:"11"},!0,r)&&(t._flag="msedge",t._handlerClass=g.default),c.default.check({opera:"44"},!0,r)&&(t._flag="opera",t._handlerClass=p.default),t.isSupported()?b.debug('device supported [flag:%s, name:"%s", version:%s, handler:%s]',t._flag,t._name,t._version,t._handlerClass.name):b.warn("device not supported [name:%s, version:%s]",t._name,t._version)}},{key:"flag",get:function(){return t._detected||t._detect(),t._flag}},{key:"name",get:function(){return t._detected||t._detect(),t._name}},{key:"version",get:function(){return t._detected||t._detect(),t._version}},{key:"bowser",get:function(){return t._detected||t._detect(),t._bowser}},{key:"Handler",get:function(){return t._detected||t._detect(),t._handlerClass}}]),t}();t.default=w,w._detected=!1,w._flag=void 0,w._name=void 0,w._version=void 0,w._bowser=void 0,w._handlerClass=null}).call(t,r(14))},function(e,t,r){"use strict";var n=r(24);e.exports=function(e,t,r){for(var o in t)r&&e[o]?e[o]=t[o]:n(e,o,t[o]);return e}},function(e,t,r){"use strict";e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){"use strict";var n=r(12);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=o(t),this.reject=o(r)}var o=r(36);e.exports.f=function(e){return new n(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=new f.default,r=[],n=!1,o=!1,a=!0,i=!1,s=void 0;try{for(var c,l=(0,u.default)(e.media);!(a=(c=l.next()).done);a=!0){var p=c.value,h=p.type;switch(h){case"audio":if(n)continue;n=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var v=!0,_=!1,y=void 0;try{for(var g,b=(0,u.default)(p.rtp);!(v=(g=b.next()).done);v=!0){var w=g.value,k={name:w.codec,mimeType:h+"/"+w.codec,kind:h,clockRate:w.rate,preferredPayloadType:w.payload,channels:w.encoding,rtcpFeedback:[],parameters:{}};"audio"!==k.kind?delete k.channels:k.channels||(k.channels=1),t.set(k.preferredPayloadType,k)}}catch(e){_=!0,y=e}finally{try{!v&&b.return&&b.return()}finally{if(_)throw y}}var P=!0,C=!1,S=void 0;try{for(var E,x=(0,u.default)(p.fmtp||[]);!(P=(E=x.next()).done);P=!0){var T=E.value,R=m.default.parseFmtpConfig(T.config),O=t.get(T.payload);O&&(O.parameters=R)}}catch(e){C=!0,S=e}finally{try{!P&&x.return&&x.return()}finally{if(C)throw S}}var M=!0,I=!1,A=void 0;try{for(var N,j=(0,u.default)(p.rtcpFb||[]);!(M=(N=j.next()).done);M=!0){var D=N.value,F=t.get(D.payload);if(F){var L={type:D.type,parameter:D.subtype};L.parameter||delete L.parameter,F.rtcpFeedback.push(L)}}}catch(e){I=!0,A=e}finally{try{!M&&j.return&&j.return()}finally{if(I)throw A}}var W=!0,U=!1,B=void 0;try{for(var G,q=(0,u.default)(p.ext||[]);!(W=(G=q.next()).done);W=!0){var z=G.value,V={kind:h,uri:z.uri,preferredId:z.value};r.push(V)}}catch(e){U=!0,B=e}finally{try{!W&&q.return&&q.return()}finally{if(U)throw B}}}}catch(e){i=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw s}}return{codecs:(0,d.default)(t.values()),headerExtensions:r,fecMechanisms:[]}}function a(e){var t=i(e),r=t.fingerprint||e.fingerprint,n=void 0;switch(t.setup){case"active":n="client";break;case"passive":n="server";break;case"actpass":n="auto"}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}}function i(e){return(e.media||[]).find(function(e){return e.iceUfrag&&0!==e.port})}Object.defineProperty(t,"__esModule",{value:!0});var s=r(13),u=n(s),c=r(17),d=n(c),l=r(20),f=n(l);t.extractRtpCapabilities=o,t.extractDtlsParameters=a;var p=r(35),m=n(p)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setRoomUrl=function(e){return{type:"SET_ROOM_URL",payload:{url:e}}},t.setRoomState=function(e){return{type:"SET_ROOM_STATE",payload:{state:e}}},t.setRoomActiveSpeaker=function(e){return{type:"SET_ROOM_ACTIVE_SPEAKER",payload:{peerName:e}}},t.setMe=function(e){return{type:"SET_ME",payload:{peerName:e.peerName,displayName:e.displayName,displayNameSet:e.displayNameSet,device:e.device}}},t.setMediaCapabilities=function(e){return{type:"SET_MEDIA_CAPABILITIES",payload:{canSendMic:e.canSendMic,canSendWebcam:e.canSendWebcam}}},t.setCanChangeWebcam=function(e){return{type:"SET_CAN_CHANGE_WEBCAM",payload:e}},t.setDisplayName=function(e){return{type:"SET_DISPLAY_NAME",payload:{displayName:e}}},t.setAudioOnlyState=function(e){return{type:"SET_AUDIO_ONLY_STATE",payload:{enabled:e}}},t.setAudioOnlyInProgress=function(e){return{type:"SET_AUDIO_ONLY_IN_PROGRESS",payload:{flag:e}}},t.setRestartIceInProgress=function(e){return{type:"SET_RESTART_ICE_IN_PROGRESS",payload:{flag:e}}},t.addProducer=function(e){return{type:"ADD_PRODUCER",payload:{producer:e}}},t.removeProducer=function(e){return{type:"REMOVE_PRODUCER",payload:{producerId:e}}},t.setProducerPaused=function(e,t){return{type:"SET_PRODUCER_PAUSED",payload:{producerId:e,originator:t}}},t.setProducerResumed=function(e,t){return{type:"SET_PRODUCER_RESUMED",payload:{producerId:e,originator:t}}},t.setProducerTrack=function(e,t){return{type:"SET_PRODUCER_TRACK",payload:{producerId:e,track:t}}},t.setWebcamInProgress=function(e){return{type:"SET_WEBCAM_IN_PROGRESS",payload:{flag:e}}},t.addPeer=function(e){return{type:"ADD_PEER",payload:{peer:e}}},t.removePeer=function(e){return{type:"REMOVE_PEER",payload:{peerName:e}}},t.setPeerDisplayName=function(e,t){return{type:"SET_PEER_DISPLAY_NAME",payload:{displayName:e,peerName:t}}},t.addConsumer=function(e,t){return{type:"ADD_CONSUMER",payload:{consumer:e,peerName:t}}},t.removeConsumer=function(e,t){return{type:"REMOVE_CONSUMER",payload:{consumerId:e,peerName:t}}},t.setConsumerPaused=function(e,t){return{type:"SET_CONSUMER_PAUSED",payload:{consumerId:e,originator:t}}},t.setConsumerResumed=function(e,t){return{type:"SET_CONSUMER_RESUMED",payload:{consumerId:e,originator:t}}},t.setConsumerEffectiveProfile=function(e,t){return{type:"SET_CONSUMER_EFFECTIVE_PROFILE",payload:{consumerId:e,profile:t}}},t.setConsumerTrack=function(e,t){return{type:"SET_CONSUMER_TRACK",payload:{consumerId:e,track:t}}},t.addNotification=function(e){return{type:"ADD_NOTIFICATION",payload:{notification:e}}},t.removeNotification=function(e){return{type:"REMOVE_NOTIFICATION",payload:{notificationId:e}}},t.removeAllNotifications=function(){return{type:"REMOVE_ALL_NOTIFICATIONS"}}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(45),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t,r){return t in e?(0,o.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(1),a=n(o),i=r(3),s=n(i),u=r(123),c="protoo-client",d=function(){function e(t){(0,a.default)(this,e),t?(this._debug=u(c+":"+t),this._warn=u(c+":WARN:"+t),this._error=u(c+":ERROR:"+t)):(this._debug=u(c),this._warn=u(c+":WARN"),this._error=u(c+":ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,s.default)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();e.exports=function(e){return new d(e)}},function(e,t,r){"use strict";e.exports={default:r(128),__esModule:!0}},function(e,t,r){"use strict";e.exports=!r(16)&&!r(27)(function(){return 7!=Object.defineProperty(r(58)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";e.exports=r(24)},function(e,t,r){"use strict";var n=r(85),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(15),i=r(18),s=r(38);e.exports=r(16)?o.default:function(e,t){i(e);for(var r,n=s(t),o=n.length,u=0;o>u;)a.f(e,r=n[u++],t[r]);return e}},function(e,t,r){"use strict";e.exports={default:r(135),__esModule:!0}},function(e,t,r){"use strict";var n=r(28),o=r(29),a=r(139)(!1),i=r(62)("IE_PROTO");e.exports=function(e,t){var r,s=o(e),u=0,c=[];for(r in s)r!=i&&n(s,r)&&c.push(r);for(;t.length>u;)n(s,r=t[u++])&&(~a(c,r)||c.push(r));return c}},function(e,t,r){"use strict";var n=r(9).document;e.exports=n&&n.documentElement},function(e,t,r){"use strict";var n=r(4),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(28),i=r(31),s=r(62)("IE_PROTO"),u=Object.prototype;e.exports=o.default||function(e){return e=i(e),a(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},function(e,t,r){"use strict";e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(2),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(9),i=r(28),s=r(16),u=r(5),c=r(83),d=r(49).KEY,l=r(27),f=r(63),p=r(40),m=r(48),h=r(8),v=r(65),_=r(67),y=r(152),g=r(91),b=r(18),w=r(12),k=r(29),P=r(59),C=r(37),S=r(46),E=r(92),x=r(69),T=r(15),R=r(38),O=x.f,M=T.f,I=E.f,A=a.Symbol,N=a.JSON,j=N&&N.stringify,D=h("_hidden"),F=h("toPrimitive"),L={}.propertyIsEnumerable,W=f("symbol-registry"),U=f("symbols"),B=f("op-symbols"),G=Object.prototype,q="function"==typeof A,z=a.QObject,V=!z||!z.prototype||!z.prototype.findChild,K=s&&l(function(){return 7!=S(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=O(G,t);n&&delete G[t],M(e,t,r),n&&e!==G&&M(G,t,n)}:M,H=function(e){var t=U[e]=S(A.prototype);return t._k=e,t},Y=q&&"symbol"==(0,o.default)(A.iterator)?function(e){return"symbol"==(void 0===e?"undefined":(0,o.default)(e))}:function(e){return e instanceof A},J=function(e,t,r){return e===G&&J(B,t,r),b(e),t=P(t,!0),b(r),i(U,t)?(r.enumerable?(i(e,D)&&e[D][t]&&(e[D][t]=!1),r=S(r,{enumerable:C(0,!1)})):(i(e,D)||M(e,D,C(1,{})),e[D][t]=!0),K(e,t,r)):M(e,t,r)},Q=function(e,t){b(e);for(var r,n=y(t=k(t)),o=0,a=n.length;a>o;)J(e,r=n[o++],t[r]);return e},$=function(e,t){return void 0===t?S(e):Q(S(e),t)},Z=function(e){var t=L.call(this,e=P(e,!0));return!(this===G&&i(U,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(U,e)||i(this,D)&&this[D][e])||t)},X=function(e,t){if(e=k(e),t=P(t,!0),e!==G||!i(U,t)||i(B,t)){var r=O(e,t);return!r||!i(U,t)||i(e,D)&&e[D][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=I(k(e)),n=[],o=0;r.length>o;)i(U,t=r[o++])||t==D||t==d||n.push(t);return n},te=function(e){for(var t,r=e===G,n=I(r?B:k(e)),o=[],a=0;n.length>a;)!i(U,t=n[a++])||r&&!i(G,t)||o.push(U[t]);return o};q||(A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=m(arguments.length>0?arguments[0]:void 0),t=function t(r){this===G&&t.call(B,r),i(this,D)&&i(this[D],e)&&(this[D][e]=!1),K(this,e,C(1,r))};return s&&V&&K(G,e,{configurable:!0,set:t}),H(e)},c(A.prototype,"toString",function(){return this._k}),x.f=X,T.f=J,r(94).f=E.f=ee,r(50).f=Z,r(68).f=te,s&&!r(44)&&c(G,"propertyIsEnumerable",Z,!0),v.f=function(e){return H(h(e))}),u(u.G+u.W+u.F*!q,{Symbol:A});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)h(re[ne++]);for(var oe=R(h.store),ae=0;oe.length>ae;)_(oe[ae++]);u(u.S+u.F*!q,"Symbol",{for:function(e){return i(W,e+="")?W[e]:W[e]=A(e)},keyFor:function(e){if(!Y(e))throw TypeError(e+" is not a symbol!");for(var t in W)if(W[t]===e)return t},useSetter:function(){V=!0},useSimple:function(){V=!1}}),u(u.S+u.F*!q,"Object",{create:$,defineProperty:J,defineProperties:Q,getOwnPropertyDescriptor:X,getOwnPropertyNames:ee,getOwnPropertySymbols:te}),N&&u(u.S+u.F*(!q||l(function(){var e=A();return"[null]"!=j([e])||"{}"!=j({a:e})||"{}"!=j(Object(e))})),"JSON",{stringify:function(e){for(var t,r,n=[e],o=1;arguments.length>o;)n.push(arguments[o++]);if(r=t=n[1],(w(t)||void 0!==e)&&!Y(e))return g(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Y(t))return t}),n[1]=t,j.apply(N,n)}}),A.prototype[F]||r(24)(A.prototype,F,A.prototype.valueOf),p(A,"Symbol"),p(Math,"Math",!0),p(a.JSON,"JSON",!0)},function(e,t,r){"use strict";var n=r(39);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(93),a=n(o),i=r(2),s=n(i),u=r(29),c=r(94).f,d={}.toString,l="object"==("undefined"==typeof window?"undefined":(0,s.default)(window))&&window&&a.default?(0,a.default)(window):[],f=function(e){try{return c(e)}catch(e){return l.slice()}};e.exports.f=function(e){return l&&"[object Window]"==d.call(e)?f(e):c(u(e))}},function(e,t,r){"use strict";e.exports={default:r(155),__esModule:!0}},function(e,t,r){"use strict";var n=r(93),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(86),i=r(64).concat("length","prototype");t.f=o.default||function(e){return a(e,i)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.applyMiddleware=t.bindActionCreators=t.combineReducers=t.createStore=void 0;var o=r(96),a=n(o),i=r(174),s=n(i),u=r(175),c=n(u),d=r(176),l=n(d),f=r(100),p=n(f),m=r(99);n(m);t.createStore=a.default,t.combineReducers=s.default,t.bindActionCreators=c.default,t.applyMiddleware=l.default,t.compose=p.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){function n(){y===_&&(y=_.slice())}function a(){return v}function s(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return n(),y.push(e),function(){if(t){t=!1,n();var r=y.indexOf(e);y.splice(r,1)}}}function c(e){if(!(0,u.default)(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(g)throw new Error("Reducers may not dispatch actions.");try{g=!0,v=h(v,e)}finally{g=!1}for(var t=_=y,r=0;r<t.length;r++){(0,t[r])()}return e}function f(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");h=e,c({type:l.INIT})}function p(){var e,t=s;return e={subscribe:function(e){function r(){e.next&&e.next(a())}if("object"!==(void 0===e?"undefined":(0,i.default)(e)))throw new TypeError("Expected the observer to be an object.");return r(),{unsubscribe:t(r)}}},e[d.default]=function(){return this},e}var m;if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(o)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var h=e,v=t,_=[],y=_,g=!1;return c({type:l.INIT}),m={dispatch:c,subscribe:s,getState:a,replaceReducer:f},m[d.default]=p,m}Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0;var a=r(2),i=n(a);t.default=o;var s=r(97),u=n(s),c=r(170),d=n(c),l=t.ActionTypes={INIT:"@@redux/INIT"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!(0,d.default)(e)||(0,i.default)(e)!=l)return!1;var t=(0,u.default)(e);if(null===t)return!0;var r=h.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&m.call(r)==v}Object.defineProperty(t,"__esModule",{value:!0});var a=r(162),i=n(a),s=r(167),u=n(s),c=r(169),d=n(c),l="[object Object]",f=Function.prototype,p=Object.prototype,m=f.toString,h=p.hasOwnProperty,v=m.call(Object);t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(163),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=o.default.Symbol;t.default=a},function(e,t,r){"use strict";function n(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";var n=r(18);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var a=e.return;throw void 0!==a&&n(a.call(e)),t}}},function(e,t,r){"use strict";var n=r(30),o=r(8)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||a[o]===e)}},function(e,t,r){"use strict";var n=r(17),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(8)("iterator"),i=!1;try{var s=[7][a]();s.return=function(){i=!0},(0,o.default)(s,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var n=[7],o=n[a]();o.next=function(){return{done:r=!0}},n[a]=function(){return o},e(n)}catch(e){}return r}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return s.default.isSupported()}function a(){return{flag:s.default.flag,name:s.default.name,version:s.default.version,bowser:s.default.bowser}}Object.defineProperty(t,"__esModule",{value:!0}),t.Room=void 0,t.isDeviceSupported=o,t.getDeviceInfo=a;var i=r(72),s=n(i),u=r(228),c=n(u);t.Room=c.default},function(e,t,r){"use strict";function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){v&&m&&(v=!1,m.length?h=m.concat(h):_=-1,h.length&&u())}function u(){if(!v){var e=a(s);v=!0;for(var t=h.length;t;){for(m=h,h=[];++_<t;)m&&m[_].run();_=-1,t=h.length}m=null,v=!1,i(e)}}function c(e,t){this.fun=e,this.array=t}function d(){}var l,f,p=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var m,h=[],v=!1,_=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];h.push(new c(e,t)),1!==h.length||v||a(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=d,p.addListener=d,p.once=d,p.off=d,p.removeListener=d,p.removeAllListeners=d,p.emit=d,p.prependListener=d,p.prependOnceListener=d,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*v;case"days":case"day":case"d":return r*h;case"hours":case"hour":case"hrs":case"hr":case"h":return r*m;case"minutes":case"minute":case"mins":case"min":case"m":return r*p;case"seconds":case"second":case"secs":case"sec":case"s":return r*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function a(e){return e>=h?Math.round(e/h)+"d":e>=m?Math.round(e/m)+"h":e>=p?Math.round(e/p)+"m":e>=f?Math.round(e/f)+"s":e+"ms"}function i(e){return s(e,h,"day")||s(e,m,"hour")||s(e,p,"minute")||s(e,f,"second")||e+" ms"}function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var u=r(34),c=n(u),d=r(2),l=n(d),f=1e3,p=60*f,m=60*p,h=24*m,v=365.25*h;e.exports=function(e,t){t=t||{};var r=void 0===e?"undefined":(0,l.default)(e);if("string"===r&&e.length>0)return o(e);if("number"===r&&!1===isNaN(e))return t.long?i(e):a(e);throw new Error("val is not a non-empty string or a valid number. val="+(0,c.default)(e))}},function(e,t,r){"use strict";var n=r(15).f,o=r(46),a=r(73),i=r(21),s=r(74),u=r(41),c=r(57),d=r(89),l=r(108),f=r(16),p=r(49).fastKey,m=r(75),h=f?"_s":"size",v=function(e,t){var r,n=p(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,c){var d=e(function(e,n){s(e,d,t,"_i"),e._t=t,e._i=o(null),e._f=void 0,e._l=void 0,e[h]=0,void 0!=n&&u(n,r,e[c],e)});return a(d.prototype,{clear:function(){for(var e=m(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var r=m(this,t),n=v(r,e);if(n){var o=n.n,a=n.p;delete r._i[n.i],n.r=!0,a&&(a.n=o),o&&(o.p=a),r._f==n&&(r._f=o),r._l==n&&(r._l=a),r[h]--}return!!n},forEach:function(e){m(this,t);for(var r,n=i(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!v(m(this,t),e)}}),f&&n(d.prototype,"size",{get:function(){return m(this,t)[h]}}),d},def:function(e,t,r){var n,o,a=v(e,t);return a?a.v=r:(e._l=a={i:o=p(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=a),n&&(n.n=a),e[h]++,"F"!==o&&(e._i[o]=a)),e},getEntry:v,setStrong:function(e,t,r){c(e,t,function(e,r){this._t=m(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?d(0,r.k):"values"==t?d(0,r.v):d(0,[r.k,r.v]):(e._t=void 0,d(1))},r?"entries":"values",!r,!0),l(t)}}},function(e,t,r){"use strict";var n=r(9),o=r(0),a=r(15),i=r(16),s=r(8)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:n[e];i&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){"use strict";var n=r(9),o=r(5),a=r(49),i=r(27),s=r(24),u=r(73),c=r(41),d=r(74),l=r(12),f=r(40),p=r(15).f,m=r(193)(0),h=r(16);e.exports=function(e,t,r,v,_,y){var g=n[e],b=g,w=_?"set":"add",k=b&&b.prototype,P={};return h&&"function"==typeof b&&(y||k.forEach&&!i(function(){(new b).entries().next()}))?(b=t(function(t,r){d(t,b,e,"_c"),t._c=new g,void 0!=r&&c(r,_,t[w],t)}),m("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in k&&(!y||"clear"!=e)&&s(b.prototype,e,function(r,n){if(d(this,b,e),!t&&y&&!l(r))return"get"==e&&void 0;var o=this._c[e](0===r?0:r,n);return t?this:o})}),y||p(b.prototype,"size",{get:function(){return this._c.size}})):(b=v.getConstructor(t,e,_,w),u(b.prototype,r),a.NEED=!0),f(b,e),P[e]=b,o(o.G+o.W+o.F,P),y||v.setStrong(b,e,_),b}},function(e,t,r){"use strict";var n=r(52),o=r(197);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return o(this)}}},function(e,t,r){"use strict";var n=r(5);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){"use strict";var n=r(5),o=r(36),a=r(21),i=r(41);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,u=arguments[1];return o(this),t=void 0!==u,t&&o(u),void 0==e?new this:(r=[],t?(n=0,s=a(u,arguments[2],2),i(e,!1,function(e){r.push(s(e,n++))})):i(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";var n=r(18),o=r(36),a=r(8)("species");e.exports=function(e,t){var r,i=n(e).constructor;return void 0===i||void 0==(r=n(i)[a])?t:o(r)}},function(e,t,r){"use strict";var n,o,a,i=r(21),s=r(207),u=r(87),c=r(58),d=r(9),l=d.process,f=d.setImmediate,p=d.clearImmediate,m=d.MessageChannel,h=d.Dispatch,v=0,_={},y=function(){var e=+this;if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},g=function(e){y.call(e.data)};f&&p||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return _[++v]=function(){s("function"==typeof e?e:Function(e),t)},n(v),v},p=function(e){delete _[e]},"process"==r(39)(l)?n=function(e){l.nextTick(i(y,e,1))}:h&&h.now?n=function(e){h.now(i(y,e,1))}:m?(o=new m,a=o.port2,o.port1.onmessage=g,n=i(a.postMessage,a,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(n=function(e){d.postMessage(e+"","*")},d.addEventListener("message",g,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(e)}}:function(e){setTimeout(i(y,e,1),0)}),e.exports={set:f,clear:p}},function(e,t,r){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){"use strict";var n=r(18),o=r(12),a=r(76);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=a.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";e.exports={default:r(211),__esModule:!0}},function(e,t,r){"use strict";var n=r(25),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};(0,o.default)(a).forEach(function(e){a[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},function(e,t,r){"use strict";!function(t){function r(e){var e=e||{},t=e.min,r=e.max,n=e.integer||!1;if(null==t&&null==r?(t=0,r=1):null==t?t=r-1:null==r&&(r=t+1),r<t)throw new Error("invalid options, max must be >= min");return{min:t,max:r,integer:n}}function n(e){if(e=r(e),e.max===e.min)return e.min;var t=Math.random()*(e.max-e.min+Number(!!e.integer))+e.min;return e.integer?Math.floor(t):t}function o(e){return e=r(e),function(t,r,o){return e.min=null!=t?t:e.min,e.max=null!=r?r:e.max,e.integer=null!=o?o:e.integer,n(e)}}e.exports=n,e.exports.generator=o,e.exports.defaults=r}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){var n=r.kind,o={cname:null,reducedSize:!0,mux:!0},a=(t.media||[]).find(function(e){return e.type===n});if(!a)throw new Error("m="+n+" section not found");var i=void 0,u=new p.default,d=!0,f=!1,m=void 0;try{for(var h,v=(0,c.default)(a.ssrcs||[]);!(d=(h=v.next()).done);d=!0){var _=h.value;if("msid"===_.attribute){if(_.value.split(" ")[1]===r.id){var y=_.id;u.add(y),i||(i=y)}}}}catch(e){f=!0,m=e}finally{try{!d&&v.return&&v.return()}finally{if(f)throw m}}if(0===u.size)throw new Error("a=ssrc line not found for local track [track.id:"+r.id+"]");var g=new l.default,b=!0,w=!1,k=void 0;try{for(var P,C=(0,c.default)(a.ssrcGroups||[]);!(b=(P=C.next()).done);b=!0){var S=P.value;if("FID"===S.semantics){var E=S.ssrcs.split(/\s+/),x=(0,s.default)(E,2),T=x[0],R=x[1];T=Number(T),R=Number(R),u.has(T)&&(u.delete(T),u.delete(R),g.set(T,R))}}}catch(e){w=!0,k=e}finally{try{!b&&C.return&&C.return()}finally{if(w)throw k}}var O=!0,M=!1,I=void 0;try{for(var A,N=(0,c.default)(u);!(O=(A=N.next()).done);O=!0){var j=A.value;g.set(j,null)}}catch(e){M=!0,I=e}finally{try{!O&&N.return&&N.return()}finally{if(M)throw I}}var D=a.ssrcs.find(function(e){return"cname"===e.attribute&&e.id===i});D&&(o.cname=D.value),e.rtcp=o,e.encodings=[];var F=g.size>1,L=["low","medium","high"],W=!0,U=!1,B=void 0;try{for(var G,q=(0,c.default)(g);!(W=(G=q.next()).done);W=!0){var z=(0,s.default)(G.value,2),V=z[0],R=z[1],K={ssrc:V};R&&(K.rtx={ssrc:R}),F&&(K.profile=L.shift()),e.encodings.push(K)}}catch(e){U=!0,B=e}finally{try{!W&&q.return&&q.return()}finally{if(U)throw B}}}function a(e,t){var r=t.kind,n=(e.media||[]).find(function(e){return e.type===r});if(!n)throw new Error("m="+r+" section not found");var o=void 0,a=void 0,i=void 0;if(!(n.ssrcs||[]).find(function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===t.id?(o=e.id,i=e.value.split(" ")[0],!0):void 0)}))throw new Error("a=ssrc line not found for local track [track.id:"+t.id+"]");(n.ssrcGroups||[]).some(function(e){if("FID"===e.semantics){var t=e.ssrcs.split(/\s+/);return Number(t[0])===o?(a=Number(t[1]),!0):void 0}});var s=n.ssrcs.find(function(e){return"cname"===e.attribute&&e.id===o});if(!s)throw new Error("CNAME line not found for local track [track.id:"+t.id+"]");var u=s.value,c=o+1,d=o+2;if(n.ssrcGroups=n.ssrcGroups||[],n.ssrcGroups.push({semantics:"SIM",ssrcs:o+" "+c+" "+d}),n.ssrcs.push({id:c,attribute:"cname",value:u}),n.ssrcs.push({id:c,attribute:"msid",value:i+" "+t.id}),n.ssrcs.push({id:d,attribute:"cname",value:u}),n.ssrcs.push({id:d,attribute:"msid",value:i+" "+t.id}),a){var l=a+1,f=a+2;n.ssrcGroups.push({semantics:"FID",ssrcs:c+" "+l}),n.ssrcs.push({id:l,attribute:"cname",value:u}),n.ssrcs.push({id:l,attribute:"msid",value:i+" "+t.id}),n.ssrcGroups.push({semantics:"FID",ssrcs:d+" "+f}),n.ssrcs.push({id:f,attribute:"cname",value:u}),n.ssrcs.push({id:f,attribute:"msid",value:i+" "+t.id})}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(218),s=n(i),u=r(13),c=n(u),d=r(20),l=n(d),f=r(53),p=n(f);t.fillRtpParametersForTrack=o,t.addSimulcastForTrack=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(25),a=n(o),i=r(13),s=n(i),u=r(4),c=n(u),d=r(6),l=n(d),f=r(7),p=n(f),m=r(1),h=n(m),v=r(3),_=n(v),y=r(35),g=n(y),b=r(10),w=n(b),k=r(23),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(k),C=new w.default("RemotePlanBSdp"),S=function(){function e(t){(0,h.default)(this,e),this._rtpParametersByKind=t,this._transportLocalParameters=null,this._transportRemoteParameters=null,this._sdpGlobalFields={id:P.randomNumber(),version:0}}return(0,_.default)(e,[{key:"setTransportLocalParameters",value:function(e){C.debug("setTransportLocalParameters() [transportLocalParameters:%o]",e),this._transportLocalParameters=e}},{key:"setTransportRemoteParameters",value:function(e){C.debug("setTransportRemoteParameters() [transportRemoteParameters:%o]",e),this._transportRemoteParameters=e}},{key:"updateTransportRemoteIceParameters",value:function(e){C.debug("updateTransportRemoteIceParameters() [remoteIceParameters:%o]",e),this._transportRemoteParameters.iceParameters=e}}]),e}(),E=function(e){function t(e){return(0,h.default)(this,t),(0,l.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e))}return(0,p.default)(t,e),(0,_.default)(t,[{key:"createAnswerSdp",value:function(e){if(C.debug("createAnswerSdp()"),!this._transportLocalParameters)throw new Error("no transport local parameters");if(!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,o={},i=(e.media||[]).map(function(e){return e.mid});this._sdpGlobalFields.version++,o.version=0,o.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},o.name="-",o.timing={start:0,stop:0},o.icelite=t.iceLite?"ice-lite":null,o.msidSemantic={semantic:"WMS",token:"*"},o.groups=[{type:"BUNDLE",mids:i.join(" ")}],o.media=[];var u=n.fingerprints.length;o.fingerprint={type:n.fingerprints[u-1].algorithm,hash:n.fingerprints[u-1].value};var c=!0,d=!1,l=void 0;try{for(var f,p=(0,s.default)(e.media||[]);!(c=(f=p.next()).done);c=!0){var m=f.value,h=m.type,v=this._rtpParametersByKind[h].codecs,_=this._rtpParametersByKind[h].headerExtensions,y={};y.type=m.type,y.port=7,y.protocol="RTP/SAVPF",y.connection={ip:"127.0.0.1",version:4},y.mid=m.mid,y.iceUfrag=t.usernameFragment,y.icePwd=t.password,y.candidates=[];var b=!0,w=!1,k=void 0;try{for(var P,S=(0,s.default)(r);!(b=(P=S.next()).done);b=!0){var E=P.value,x={};x.component=1,x.foundation=E.foundation,x.ip=E.ip,x.port=E.port,x.priority=E.priority,x.transport=E.protocol,x.type=E.type,E.tcpType&&(x.tcptype=E.tcpType),y.candidates.push(x)}}catch(e){w=!0,k=e}finally{try{!b&&S.return&&S.return()}finally{if(w)throw k}}switch(y.endOfCandidates="end-of-candidates",y.iceOptions="renomination",n.role){case"client":y.setup="active";break;case"server":y.setup="passive"}switch(m.direction){case"sendrecv":case"sendonly":y.direction="recvonly";break;case"recvonly":case"inactive":y.direction="inactive"}"video"===h&&(y.xGoogleFlag="conference"),y.rtp=[],y.rtcpFb=[],y.fmtp=[];var T=!0,R=!1,O=void 0;try{for(var M,I=(0,s.default)(v);!(T=(M=I.next()).done);T=!0){var A=M.value,N={payload:A.payloadType,codec:A.name,rate:A.clockRate};if(A.channels>1&&(N.encoding=A.channels),y.rtp.push(N),A.parameters){var j={payload:A.payloadType,config:""},D=!0,F=!1,L=void 0;try{for(var W,U=(0,s.default)((0,a.default)(A.parameters));!(D=(W=U.next()).done);D=!0){var B=W.value;j.config&&(j.config+=";"),j.config+=B+"="+A.parameters[B]}}catch(e){F=!0,L=e}finally{try{!D&&U.return&&U.return()}finally{if(F)throw L}}j.config&&y.fmtp.push(j)}if(A.rtcpFeedback){var G=!0,q=!1,z=void 0;try{for(var V,K=(0,s.default)(A.rtcpFeedback);!(G=(V=K.next()).done);G=!0){var H=V.value;y.rtcpFb.push({payload:A.payloadType,type:H.type,subtype:H.parameter||""})}}catch(e){q=!0,z=e}finally{try{!G&&K.return&&K.return()}finally{if(q)throw z}}}}}catch(e){R=!0,O=e}finally{try{!T&&I.return&&I.return()}finally{if(R)throw O}}y.payloads=v.map(function(e){return e.payloadType}).join(" "),y.ext=[];var Y=!0,J=!1,Q=void 0;try{for(var $,Z=(0,s.default)(_);!(Y=($=Z.next()).done);Y=!0){(function(){var e=$.value;if(!(m.ext||[]).find(function(t){return t.uri===e.uri}))return"continue";y.ext.push({uri:e.uri,value:e.id})})()}}catch(e){J=!0,Q=e}finally{try{!Y&&Z.return&&Z.return()}finally{if(J)throw Q}}y.rtcpMux="rtcp-mux",y.rtcpRsize="rtcp-rsize",o.media.push(y)}}catch(e){d=!0,l=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw l}}return g.default.write(o)}}]),t}(S),x=function(e){function t(e){(0,h.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return r._streamId="recv-stream-"+P.randomNumber(),r}return(0,p.default)(t,e),(0,_.default)(t,[{key:"createOfferSdp",value:function(e,t){var r=this;if(C.debug("createOfferSdp()"),!this._transportRemoteParameters)throw new Error("no transport remote parameters");var n=this._transportRemoteParameters.iceParameters,o=this._transportRemoteParameters.iceCandidates,i=this._transportRemoteParameters.dtlsParameters,u={},c=e;this._sdpGlobalFields.version++,u.version=0,u.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},u.name="-",u.timing={start:0,stop:0},u.icelite=n.iceLite?"ice-lite":null,u.msidSemantic={semantic:"WMS",token:"*"},u.groups=[{type:"BUNDLE",mids:c.join(" ")}],u.media=[];var d=i.fingerprints.length;u.fingerprint={type:i.fingerprints[d-1].algorithm,hash:i.fingerprints[d-1].value};var l=!0,f=!1,p=void 0;try{for(var m,h=(0,s.default)(e);!(l=(m=h.next()).done);l=!0)!function(){var e=m.value,i=r._rtpParametersByKind[e].codecs,c=r._rtpParametersByKind[e].headerExtensions,d={};d.type=e,d.port=7,d.protocol="RTP/SAVPF",d.connection={ip:"127.0.0.1",version:4},d.mid=e,d.iceUfrag=n.usernameFragment,d.icePwd=n.password,d.candidates=[];var l=!0,f=!1,p=void 0;try{for(var h,v=(0,s.default)(o);!(l=(h=v.next()).done);l=!0){var _=h.value,y={};y.component=1,y.foundation=_.foundation,y.ip=_.ip,y.port=_.port,y.priority=_.priority,y.transport=_.protocol,y.type=_.type,_.tcpType&&(y.tcptype=_.tcpType),d.candidates.push(y)}}catch(e){f=!0,p=e}finally{try{!l&&v.return&&v.return()}finally{if(f)throw p}}d.endOfCandidates="end-of-candidates",d.iceOptions="renomination",d.setup="actpass",t.some(function(t){return t.kind===e})?d.direction="sendonly":d.direction="inactive",d.rtp=[],d.rtcpFb=[],d.fmtp=[];var g=!0,b=!1,w=void 0;try{for(var k,P=(0,s.default)(i);!(g=(k=P.next()).done);g=!0){var C=k.value,S={payload:C.payloadType,codec:C.name,rate:C.clockRate};if(C.channels>1&&(S.encoding=C.channels),d.rtp.push(S),C.parameters){var E={payload:C.payloadType,config:""},x=!0,T=!1,R=void 0;try{for(var O,M=(0,s.default)((0,a.default)(C.parameters));!(x=(O=M.next()).done);x=!0){var I=O.value;E.config&&(E.config+=";"),E.config+=I+"="+C.parameters[I]}}catch(e){T=!0,R=e}finally{try{!x&&M.return&&M.return()}finally{if(T)throw R}}E.config&&d.fmtp.push(E)}if(C.rtcpFeedback){var A=!0,N=!1,j=void 0;try{for(var D,F=(0,s.default)(C.rtcpFeedback);!(A=(D=F.next()).done);A=!0){var L=D.value;d.rtcpFb.push({payload:C.payloadType,type:L.type,subtype:L.parameter||""})}}catch(e){N=!0,j=e}finally{try{!A&&F.return&&F.return()}finally{if(N)throw j}}}}}catch(e){b=!0,w=e}finally{try{!g&&P.return&&P.return()}finally{if(b)throw w}}d.payloads=i.map(function(e){return e.payloadType}).join(" "),d.ext=[];var W=!0,U=!1,B=void 0;try{for(var G,q=(0,s.default)(c);!(W=(G=q.next()).done);W=!0){var z=G.value;d.ext.push({uri:z.uri,value:z.id})}}catch(e){U=!0,B=e}finally{try{!W&&q.return&&q.return()}finally{if(U)throw B}}d.rtcpMux="rtcp-mux",d.rtcpRsize="rtcp-rsize",d.ssrcs=[],d.ssrcGroups=[];var V=!0,K=!1,H=void 0;try{for(var Y,J=(0,s.default)(t);!(V=(Y=J.next()).done);V=!0){var Q=Y.value;Q.kind===e&&(d.ssrcs.push({id:Q.ssrc,attribute:"msid",value:r._streamId+" "+Q.trackId}),d.ssrcs.push({id:Q.ssrc,attribute:"mslabel",value:r._streamId}),d.ssrcs.push({id:Q.ssrc,attribute:"label",value:Q.trackId}),d.ssrcs.push({id:Q.ssrc,attribute:"cname",value:Q.cname}),Q.rtxSsrc&&(d.ssrcs.push({id:Q.rtxSsrc,attribute:"msid",value:r._streamId+" "+Q.trackId}),d.ssrcs.push({id:Q.rtxSsrc,attribute:"mslabel",value:r._streamId}),d.ssrcs.push({id:Q.rtxSsrc,attribute:"label",value:Q.trackId}),d.ssrcs.push({id:Q.rtxSsrc,attribute:"cname",value:Q.cname}),d.ssrcGroups.push({semantics:"FID",ssrcs:Q.ssrc+" "+Q.rtxSsrc})))}}catch(e){K=!0,H=e}finally{try{!V&&J.return&&J.return()}finally{if(K)throw H}}u.media.push(d)}()}catch(e){f=!0,p=e}finally{try{!l&&h.return&&h.return()}finally{if(f)throw p}}return g.default.write(u)}}]),t}(S),T=function e(t,r){switch((0,h.default)(this,e),C.debug("constructor() [direction:%s, rtpParametersByKind:%o]",t,r),t){case"send":return new E(r);case"recv":return new x(r)}};t.default=T},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),a=n(o),i=r(3),s=n(i),u=r(123),c=n(u),d="mediasoup",l=function(){function e(t){(0,a.default)(this,e),t?(this._debug=(0,c.default)(d+":"+t),this._warn=(0,c.default)(d+":WARN:"+t),this._error=(0,c.default)(d+":ERROR:"+t)):(this._debug=(0,c.default)(d),this._warn=(0,c.default)(d+":WARN"),this._error=(0,c.default)(d+":ERROR")),this._debug.enabled=!1}return(0,s.default)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();t.default=l},function(e,t,r){"use strict";(function(n){function o(e){return e&&e.__esModule?e:{default:e}}function a(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))}),e.splice(a,0,n)}}function s(){return"object"===("undefined"==typeof console?"undefined":(0,l.default)(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function u(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=Object({NODE_ENV:"production"}).DEBUG),e}var d=r(2),l=o(d),f=r(34),p=o(f);t=e.exports=r(234),t.log=s,t.formatArgs=i,t.save=u,t.load=c,t.useColors=a,t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return(0,p.default)(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,r(105))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notify=t.restartIce=t.disableAudioOnly=t.enableAudioOnly=t.changeWebcam=t.disableWebcam=t.enableWebcam=t.unmuteMic=t.muteMic=t.changeDisplayName=t.leaveRoom=t.joinRoom=void 0;var n=r(236),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(78),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a);t.joinRoom=function(e){return{type:"JOIN_ROOM",payload:{media_server_wss:e.media_server_wss,roomId:e.roomId,peerName:e.peerName,displayName:e.displayName,device:e.device,useSimulcast:e.useSimulcast,produce:e.produce,turnservers:e.turnservers}}},t.leaveRoom=function(){return{type:"LEAVE_ROOM"}},t.changeDisplayName=function(e){return{type:"CHANGE_DISPLAY_NAME",payload:{displayName:e}}},t.muteMic=function(){return{type:"MUTE_MIC"}},t.unmuteMic=function(){return{type:"UNMUTE_MIC"}},t.enableWebcam=function(){return{type:"ENABLE_WEBCAM"}},t.disableWebcam=function(){return{type:"DISABLE_WEBCAM"}},t.changeWebcam=function(){return{type:"CHANGE_WEBCAM"}},t.enableAudioOnly=function(){return{type:"ENABLE_AUDIO_ONLY"}},t.disableAudioOnly=function(){return{type:"DISABLE_AUDIO_ONLY"}},t.restartIce=function(){return{type:"RESTART_ICE"}},t.notify=function(e){var t=e.type,r=void 0===t?"info":t,n=e.text,a=e.timeout;if(!a)switch(r){case"info":a=3e3;break;case"error":a=5e3}var s={id:(0,o.default)({length:6}).toLowerCase(),type:r,text:n,timeout:a};return function(e){e(i.addNotification(s)),setTimeout(function(){e(i.removeNotification(s.id))},a)}}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(17),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,o.default)(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(2),a=n(o),i=r(1),s=n(i),u=r(3),c=n(u),d=r(80)("Message"),l=r(248),f=function(){function e(){(0,s.default)(this,e)}return(0,c.default)(e,null,[{key:"parse",value:function(e){var t=void 0,r={};try{t=JSON.parse(e)}catch(e){return void d.error("parse() | invalid JSON: %s",e)}if("object"!==(void 0===t?"undefined":(0,a.default)(t))||Array.isArray(t))return void d.error("parse() | not an object");if("number"!=typeof t.id)return void d.error("parse() | missing/invalid id field");if(r.id=t.id,t.request){if(r.request=!0,"string"!=typeof t.method)return void d.error("parse() | missing/invalid method field");r.method=t.method,r.data=t.data||{}}else{if(!t.response)return void d.error("parse() | missing request/response field");r.response=!0,t.ok?(r.ok=!0,r.data=t.data||{}):(r.errorCode=t.errorCode,r.errorReason=t.errorReason)}return r}},{key:"requestFactory",value:function(e,t){return{request:!0,id:l.randomNumber(),method:e,data:t||{}}}},{key:"successResponseFactory",value:function(e,t){return{response:!0,id:e.id,ok:!0,data:t||{}}}},{key:"errorResponseFactory",value:function(e,t,r){return{response:!0,id:e.id,codeCode:t,errorReason:r}}}]),e}();e.exports=f},function(e,t,r){"use strict";(function(e){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Init=void 0;var a=r(1),i=o(a),s=r(95),u=r(180),c=o(u),d=(r(181),r(104)),l=r(122),f=o(l),p=r(235),m=(n(p),r(124)),h=n(m),v=r(78),_=n(v),y=r(237),g=o(y),b=r(244),w=o(b),k=r(258),P=n(k);t.Init=function t(r){var n=this;(0,i.default)(this,t),e.emitter=this.emitter=new P.default,this.roomClientMiddleware=w.default;new f.default;this.emitter.on("joinRoom",function(e){n.client=e});var o=[c.default,w.default],a=this.store=(0,s.createStore)(g.default,void 0,s.applyMiddleware.apply(void 0,o)),u=r.peerName,l=r.roomId,p=r.produce||!0,m=r.displayName,v=r.sipEndpoint||!1,y=r.useSimulcast||!1,b=r.media_server_wss,k=r.turnservers||[],C=void 0;m?C=!0:(m="",C=!1);var S=(0,d.getDeviceInfo)();v&&(S.flag="sipendpoint",S.name="SIP Endpoint",S.version=void 0),a.dispatch(_.setMe({peerName:u,displayName:m,displayNameSet:C,device:S})),a.dispatch(h.joinRoom({media_server_wss:b,roomId:l,peerName:u,displayName:m,device:S,useSimulcast:y,produce:p,turnservers:k}))}}).call(t,r(14))},function(e,t,r){"use strict";r(26),r(33),e.exports=r(65).f("iterator")},function(e,t,r){"use strict";var n=r(55),o=r(56);e.exports=function(e){return function(t,r){var a,i,s=String(o(t)),u=n(r),c=s.length;return u<0||u>=c?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===c||(i=s.charCodeAt(u+1))<56320||i>57343?e?s.charAt(u):a:e?s.slice(u,u+2):i-56320+(a-55296<<10)+65536)}}},function(e,t,r){"use strict";r(131);var n=r(0).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){"use strict";var n=r(5);n(n.S+n.F*!r(16),"Object",{defineProperty:r(15).f})},function(e,t,r){"use strict";var n=r(46),o=r(37),a=r(40),i={};r(24)(i,r(8)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(i,{next:o(1,r)}),a(e,t+" Iterator")}},function(e,t,r){"use strict";r(134);var n=r(0).Object;e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){"use strict";var n=r(5);n(n.S,"Object",{create:r(46)})},function(e,t,r){"use strict";r(136);var n=r(0).Object;e.exports=function(e,t){return n.defineProperties(e,t)}},function(e,t,r){"use strict";var n=r(5);n(n.S+n.F*!r(16),"Object",{defineProperties:r(84)})},function(e,t,r){"use strict";r(138),e.exports=r(0).Object.keys},function(e,t,r){"use strict";var n=r(31),o=r(38);r(32)("keys",function(){return function(e){return o(n(e))}})},function(e,t,r){"use strict";var n=r(29),o=r(47),a=r(140);e.exports=function(e){return function(t,r,i){var s,u=n(t),c=o(u.length),d=a(i,c);if(e&&r!=r){for(;c>d;)if((s=u[d++])!=s)return!0}else for(;c>d;d++)if((e||d in u)&&u[d]===r)return e||d||0;return!e&&-1}}},function(e,t,r){"use strict";var n=r(55),o=Math.max,a=Math.min;e.exports=function(e,t){return e=n(e),e<0?o(e+t,0):a(e,t)}},function(e,t,r){"use strict";r(142),e.exports=r(0).Object.getPrototypeOf},function(e,t,r){"use strict";var n=r(31),o=r(88);r(32)("getPrototypeOf",function(){return function(e){return o(n(e))}})},function(e,t,r){"use strict";var n=r(144),o=r(89),a=r(30),i=r(29);e.exports=r(57)(Array,"Array",function(e,t){this._t=i(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):"keys"==t?o(0,r):"values"==t?o(0,e[r]):o(0,[r,e[r]])},"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},function(e,t,r){"use strict";e.exports=function(){}},function(e,t,r){"use strict";r(90),r(51),r(160),r(161),e.exports=r(0).Symbol},function(e,t,r){"use strict";e.exports={default:r(147),__esModule:!0}},function(e,t,r){"use strict";r(148),e.exports=r(0).Object.preventExtensions},function(e,t,r){"use strict";var n=r(12),o=r(49).onFreeze;r(32)("preventExtensions",function(e){return function(t){return e&&n(t)?e(o(t)):t}})},function(e,t,r){"use strict";e.exports={default:r(150),__esModule:!0}},function(e,t,r){"use strict";r(151),e.exports=r(0).Object.isExtensible},function(e,t,r){"use strict";var n=r(12);r(32)("isExtensible",function(e){return function(t){return!!n(t)&&(!e||e(t))}})},function(e,t,r){"use strict";var n=r(38),o=r(68),a=r(50);e.exports=function(e){var t=n(e),r=o.f;if(r)for(var i,s=r(e),u=a.f,c=0;s.length>c;)u.call(e,i=s[c++])&&t.push(i);return t}},function(e,t,r){"use strict";e.exports={default:r(154),__esModule:!0}},function(e,t,r){"use strict";r(90),e.exports=r(0).Object.getOwnPropertySymbols},function(e,t,r){"use strict";r(156);var n=r(0).Object;e.exports=function(e){return n.getOwnPropertyNames(e)}},function(e,t,r){"use strict";r(32)("getOwnPropertyNames",function(){return r(92).f})},function(e,t,r){"use strict";e.exports={default:r(158),__esModule:!0}},function(e,t,r){"use strict";r(159);var n=r(0).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},function(e,t,r){"use strict";var n=r(29),o=r(69).f;r(32)("getOwnPropertyDescriptor",function(){return function(e,t){return o(n(e),t)}})},function(e,t,r){"use strict";r(67)("asyncIterator")},function(e,t,r){"use strict";r(67)("observable")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return null==e?void 0===e?f:l:p&&p in Object(e)?(0,u.default)(e):(0,d.default)(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(98),i=n(a),s=r(165),u=n(s),c=r(166),d=n(c),l="[object Null]",f="[object Undefined]",p=i.default?i.default.toStringTag:void 0;t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=n(o),i=r(164),s=n(i),u="object"==("undefined"==typeof self?"undefined":(0,a.default)(self))&&self&&self.Object===Object&&self,c=s.default||u||Function("return this")();t.default=c},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a="object"==(void 0===e?"undefined":(0,o.default)(e))&&e&&e.Object===Object&&e;t.default=a}).call(t,r(14))},function(e,t,r){"use strict";function n(e){var t=s.call(e,c),r=e[c];try{e[c]=void 0;var n=!0}catch(e){}var o=u.call(e);return n&&(t?e[c]=r:delete e[c]),o}Object.defineProperty(t,"__esModule",{value:!0});var o=r(98),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=Object.prototype,s=i.hasOwnProperty,u=i.toString,c=a.default?a.default.toStringTag:void 0;t.default=n},function(e,t,r){"use strict";function n(e){return a.call(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.prototype,a=o.toString;t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),a=n(o),i=r(168),s=n(i),u=(0,s.default)(a.default,Object);t.default=u},function(e,t,r){"use strict";function n(e,t){return function(r){return e(t(r))}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e){return null!=e&&"object"==(void 0===e?"undefined":(0,a.default)(e))}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=n},function(e,t,r){"use strict";e.exports=r(171)},function(e,t,r){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0});var o,a=r(173),i=function(e){return e&&e.__esModule?e:{default:e}}(a);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var s=(0,i.default)(o);t.default=s}).call(t,r(14),r(172)(e))},function(e,t,r){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=t&&t.type;return"Given action "+(r&&'"'+r.toString()+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function a(e){(0,u.default)(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:c.ActionTypes.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+c.ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}function i(e){for(var t=(0,u.default)(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var s=(0,u.default)(r),c=void 0;try{a(r)}catch(e){c=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(c)throw c;for(var n=!1,a={},i=0;i<s.length;i++){var u=s[i],d=r[u],l=e[u],f=d(l,t);if(void 0===f){var p=o(u,t);throw new Error(p)}a[u]=f,n=n||f!==l}return n?a:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=r(25),u=n(s);t.default=i;var c=r(96),d=r(97),l=(n(d),r(99));n(l)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return function(){return t(e.apply(void 0,arguments))}}function a(e,t){if("function"==typeof e)return o(e,t);if("object"!==(void 0===e?"undefined":(0,c.default)(e))||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":void 0===e?"undefined":(0,c.default)(e))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=(0,s.default)(e),n={},a=0;a<r.length;a++){var i=r[a],u=e[i];"function"==typeof u&&(n[i]=o(u,t))}return n}Object.defineProperty(t,"__esModule",{value:!0});var i=r(25),s=n(i),u=r(2),c=n(u);t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(r,n,o){var a=e(r,n,o),i=a.dispatch,s=[],d={getState:a.getState,dispatch:function(e){return i(e)}};return s=t.map(function(e){return e(d)}),i=u.default.apply(void 0,s)(a.dispatch),c({},a,{dispatch:i})}}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(70),i=n(a);t.default=o;var s=r(100),u=n(s),c=i.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}},function(e,t,r){"use strict";r(178),e.exports=r(0).Object.assign},function(e,t,r){"use strict";var n=r(5);n(n.S+n.F,"Object",{assign:r(179)})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(25),a=n(o),i=r(66),s=n(i),u=r(70),c=n(u),d=r(38),l=r(68),f=r(50),p=r(31),m=r(61),h=c.default;e.exports=!h||r(27)(function(){var e={},t={},r=(0,s.default)(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=h({},e)[r]||(0,a.default)(h({},t)).join("")!=n})?function(e,t){for(var r=p(e),n=arguments.length,o=1,a=l.f,i=f.f;n>o;)for(var s,u=m(arguments[o++]),c=a?d(u).concat(a(u)):d(u),h=c.length,v=0;h>v;)i.call(u,s=c[v++])&&(r[s]=u[s]);return r}:h},function(e,t,r){"use strict";function n(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(o){return"function"==typeof o?o(r,n,e):t(o)}}}}t.__esModule=!0;var o=n();o.withExtraArgument=n,t.default=o},function(e,t,r){"use strict";(function(n){function o(e){return e&&e.__esModule?e:{default:e}}var a,i,s,u=r(85),c=o(u),d=r(17),l=o(d),f=r(81),p=o(f),m=r(66),h=o(m),v=r(19),_=o(v),y=r(25),g=o(y),b=r(60),w=o(b),k=r(2),P=o(k);!function(r,n){"object"==(0,P.default)(t)&&void 0!==e?n(t):(i=[t],a=n,void 0!==(s="function"==typeof a?a.apply(t,i):a)&&(e.exports=s))}(0,function(e){function t(e,t){e.super_=t,e.prototype=(0,w.default)(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function o(e,t,r){o.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function a(e,t){a.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function i(e,t){i.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,r){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function u(e,t,r){var n=e.slice((r||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n),e}function d(e){var t=void 0===e?"undefined":L(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function f(e,t,r,n,c,l,p){c=c||[],p=p||[];var m=c.slice(0);if(void 0!==l){if(n){if("function"==typeof n&&n(m,l))return;if("object"===(void 0===n?"undefined":L(n))){if(n.prefilter&&n.prefilter(m,l))return;if(n.normalize){var h=n.normalize(m,l,e,t);h&&(e=h[0],t=h[1])}}}m.push(l)}"regexp"===d(e)&&"regexp"===d(t)&&(e=e.toString(),t=t.toString());var v=void 0===e?"undefined":L(e),_=void 0===t?"undefined":L(t),y="undefined"!==v||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(l),b="undefined"!==_||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(l);if(!y&&b)r(new a(m,t));else if(!b&&y)r(new i(m,e));else if(d(e)!==d(t))r(new o(m,e,t));else if("date"===d(e)&&e-t!=0)r(new o(m,e,t));else if("object"===v&&null!==e&&null!==t)if(p.filter(function(t){return t.lhs===e}).length)e!==t&&r(new o(m,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var w;for(e.length,w=0;w<e.length;w++)w>=t.length?r(new s(m,w,new i(void 0,e[w]))):f(e[w],t[w],r,n,m,w,p);for(;w<t.length;)r(new s(m,w,new a(void 0,t[w++])))}else{var k=(0,g.default)(e),P=(0,g.default)(t);k.forEach(function(o,a){var i=P.indexOf(o);i>=0?(f(e[o],t[o],r,n,m,o,p),P=u(P,i)):f(e[o],void 0,r,n,m,o,p)}),P.forEach(function(e){f(void 0,t[e],r,n,m,e,p)})}p.length=p.length-1}else e!==t&&("number"===v&&isNaN(e)&&isNaN(t)||r(new o(m,e,t)))}function m(e,t,r,n){return n=n||[],f(e,t,function(e){e&&n.push(e)},r),n.length?n:void 0}function v(e,t,r){if(r.path&&r.path.length){var n,o=e[t],a=r.path.length-1;for(n=0;n<a;n++)o=o[r.path[n]];switch(r.kind){case"A":v(o[r.path[n]],r.index,r.item);break;case"D":delete o[r.path[n]];break;case"E":case"N":o[r.path[n]]=r.rhs}}else switch(r.kind){case"A":v(e[t],r.index,r.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=r.rhs}return e}function y(e,t,r){if(e&&t&&r&&r.kind){for(var n=e,o=-1,a=r.path?r.path.length-1:0;++o<a;)void 0===n[r.path[o]]&&(n[r.path[o]]="number"==typeof r.path[o]?[]:{}),n=n[r.path[o]];switch(r.kind){case"A":v(r.path?n[r.path[o]]:n,r.index,r.item);break;case"D":delete n[r.path[o]];break;case"E":case"N":n[r.path[o]]=r.rhs}}}function b(e,t,r){if(r.path&&r.path.length){var n,o=e[t],a=r.path.length-1;for(n=0;n<a;n++)o=o[r.path[n]];switch(r.kind){case"A":b(o[r.path[n]],r.index,r.item);break;case"D":case"E":o[r.path[n]]=r.lhs;break;case"N":delete o[r.path[n]]}}else switch(r.kind){case"A":b(e[t],r.index,r.item);break;case"D":case"E":e[t]=r.lhs;break;case"N":e=u(e,t)}return e}function k(e,t,r){if(e&&t&&r&&r.kind){var n,o,a=e;for(o=r.path.length-1,n=0;n<o;n++)void 0===a[r.path[n]]&&(a[r.path[n]]={}),a=a[r.path[n]];switch(r.kind){case"A":b(a[r.path[n]],r.index,r.item);break;case"D":case"E":a[r.path[n]]=r.lhs;break;case"N":delete a[r.path[n]]}}}function C(e,t,r){if(e&&t){f(e,t,function(n){r&&!r(e,t,n)||y(e,t,n)})}}function S(e){return"color: "+B[e].color+"; font-weight: bold"}function E(e){var t=e.kind,r=e.path,n=e.lhs,o=e.rhs,a=e.index,i=e.item;switch(t){case"E":return[r.join("."),n,"→",o];case"N":return[r.join("."),o];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+a+"]",i];default:return[]}}function x(e,t,r,n){var o=m(e,t);try{n?r.groupCollapsed("diff"):r.group("diff")}catch(e){r.log("diff")}o?o.forEach(function(e){var t=e.kind,n=E(e);r.log.apply(r,["%c "+B[t].text,S(t)].concat(W(n)))}):r.log("—— no diff ——");try{r.groupEnd()}catch(e){r.log("—— diff end —— ")}}function T(e,t,r,n){switch(void 0===e?"undefined":L(e)){case"object":return"function"==typeof e[n]?e[n].apply(e,W(r)):e[n];case"function":return e(t);default:return e}}function R(e){var t=e.timestamp,r=e.duration;return function(e,n,o){var a=["action"];return a.push("%c"+String(e.type)),t&&a.push("%c@ "+n),r&&a.push("%c(in "+o.toFixed(2)+" ms)"),a.join(" ")}}function O(e,t){var r=t.logger,n=t.actionTransformer,o=t.titleFormatter,a=void 0===o?R(t):o,i=t.collapsed,s=t.colors,u=t.level,c=t.diff,d=void 0===t.titleFormatter;e.forEach(function(o,l){var f=o.started,p=o.startedTime,m=o.action,h=o.prevState,v=o.error,_=o.took,y=o.nextState,g=e[l+1];g&&(y=g.prevState,_=g.started-f);var b=n(m),w="function"==typeof i?i(function(){return y},m,o):i,k=D(p),P=s.title?"color: "+s.title(b)+";":"",C=["color: gray; font-weight: lighter;"];C.push(P),t.timestamp&&C.push("color: gray; font-weight: lighter;"),t.duration&&C.push("color: gray; font-weight: lighter;");var S=a(b,k,_);try{w?s.title&&d?r.groupCollapsed.apply(r,["%c "+S].concat(C)):r.groupCollapsed(S):s.title&&d?r.group.apply(r,["%c "+S].concat(C)):r.group(S)}catch(e){r.log(S)}var E=T(u,b,[h],"prevState"),R=T(u,b,[b],"action"),O=T(u,b,[v,h],"error"),M=T(u,b,[y],"nextState");if(E)if(s.prevState){var I="color: "+s.prevState(h)+"; font-weight: bold";r[E]("%c prev state",I,h)}else r[E]("prev state",h);if(R)if(s.action){var A="color: "+s.action(b)+"; font-weight: bold";r[R]("%c action    ",A,b)}else r[R]("action    ",b);if(v&&O)if(s.error){var N="color: "+s.error(v,h)+"; font-weight: bold;";r[O]("%c error     ",N,v)}else r[O]("error     ",v);if(M)if(s.nextState){var j="color: "+s.nextState(y)+"; font-weight: bold";r[M]("%c next state",j,y)}else r[M]("next state",y);c&&x(h,y,r,w);try{r.groupEnd()}catch(e){r.log("—— log end ——")}})}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,_.default)({},G,e),r=t.logger,n=t.stateTransformer,o=t.errorTransformer,a=t.predicate,i=t.logErrors,s=t.diffPredicate;if(void 0===r)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var u=[];return function(e){var r=e.getState;return function(e){return function(c){if("function"==typeof a&&!a(r,c))return e(c);var d={};u.push(d),d.started=F.now(),d.startedTime=new Date,d.prevState=n(r()),d.action=c;var l=void 0;if(i)try{l=e(c)}catch(e){d.error=o(e)}else l=e(c);d.took=F.now()-d.started,d.nextState=n(r());var f=t.diff&&"function"==typeof s?s(r,c):t.diff;if(O(u,(0,_.default)({},t,{diff:f})),u.length=0,d.error)throw d.error;return l}}}}var I,A,N=function(e,t){return new Array(t+1).join(e)},j=function(e,t){return N("0",t-e.toString().length)+e},D=function(e){return j(e.getHours(),2)+":"+j(e.getMinutes(),2)+":"+j(e.getSeconds(),2)+"."+j(e.getMilliseconds(),3)},F="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,L="function"==typeof h.default&&"symbol"==(0,P.default)(p.default)?function(e){return void 0===e?"undefined":(0,P.default)(e)}:function(e){return e&&"function"==typeof h.default&&e.constructor===h.default&&e!==h.default.prototype?"symbol":void 0===e?"undefined":(0,P.default)(e)},W=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,l.default)(e)},U=[];I="object"===(void 0===n?"undefined":L(n))&&n?n:"undefined"!=typeof window?window:{},A=I.DeepDiff,A&&U.push(function(){void 0!==A&&I.DeepDiff===m&&(I.DeepDiff=A,A=void 0)}),t(o,r),t(a,r),t(i,r),t(s,r),(0,c.default)(m,{diff:{value:m,enumerable:!0},observableDiff:{value:f,enumerable:!0},applyDiff:{value:C,enumerable:!0},applyChange:{value:y,enumerable:!0},revertChange:{value:k,enumerable:!0},isConflict:{value:function(){return void 0!==A},enumerable:!0},noConflict:{value:function(){return U&&(U.forEach(function(e){e()}),U=null),m},enumerable:!0}});var B={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},G={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,r=e.getState;return"function"==typeof t||"function"==typeof r?M()({dispatch:t,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=G,e.createLogger=M,e.logger=q,e.default=q,Object.defineProperty(e,"__esModule",{value:!0})})}).call(t,r(14))},function(e,t,r){"use strict";r(26),r(183),e.exports=r(0).Array.from},function(e,t,r){"use strict";var n=r(17),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(21),i=r(5),s=r(31),u=r(101),c=r(102),d=r(47),l=r(184),f=r(71);i(i.S+i.F*!r(103)(function(e){(0,o.default)(e)}),"Array",{from:function(e){var t,r,n,o,i=s(e),p="function"==typeof this?this:Array,m=arguments.length,h=m>1?arguments[1]:void 0,v=void 0!==h,_=0,y=f(i);if(v&&(h=a(h,m>2?arguments[2]:void 0,2)),void 0==y||p==Array&&c(y))for(t=d(i.length),r=new p(t);t>_;_++)l(r,_,v?h(i[_],_):i[_]);else for(o=y.call(i),r=new p;!(n=o.next()).done;_++)l(r,_,v?u(o,h,[n.value,_],!0):n.value);return r.length=_,r}})},function(e,t,r){"use strict";var n=r(15),o=r(37);e.exports=function(e,t,r){t in e?n.f(e,t,o(0,r)):e[t]=r}},function(e,t,r){"use strict";/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function(t,n,o){void 0!==e&&e.exports?e.exports=o():r(186)("bowser",o)}(0,0,function(){function e(e){function t(t){var r=e.match(t);return r&&r.length>1&&r[1]||""}function r(t){var r=e.match(t);return r&&r.length>1&&r[2]||""}var n,o=t(/(ipod|iphone|ipad)/i).toLowerCase(),a=/like android/i.test(e),s=!a&&/android/i.test(e),u=/nexus\s*[0-6]\s*/i.test(e),c=!u&&/nexus\s*[0-9]+/i.test(e),d=/CrOS/.test(e),l=/silk/i.test(e),f=/sailfish/i.test(e),p=/tizen/i.test(e),m=/(web|hpw)os/i.test(e),h=/windows phone/i.test(e),v=(/SamsungBrowser/i.test(e),!h&&/windows/i.test(e)),_=!o&&!l&&/macintosh/i.test(e),y=!s&&!f&&!p&&!m&&/linux/i.test(e),g=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),b=t(/version\/(\d+(\.\d+)?)/i),w=/tablet/i.test(e)&&!/tablet pc/i.test(e),k=!w&&/[^-]mobi/i.test(e),P=/xbox/i.test(e);/opera/i.test(e)?n={name:"Opera",opera:i,version:b||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?n={name:"Opera",opera:i,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||b}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:i,version:b||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:i,version:b||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:i,version:b||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:i,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:i,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:i,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:i,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:i,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:i,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:h?(n={name:"Windows Phone",osname:"Windows Phone",windowsphone:i},g?(n.msedge=i,n.version=g):(n.msie=i,n.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:i,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:d?n={name:"Chrome",osname:"Chrome OS",chromeos:i,chromeBook:i,chrome:i,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?n={name:"Microsoft Edge",msedge:i,version:g}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:i,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||b}:f?n={name:"Sailfish",osname:"Sailfish OS",sailfish:i,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:i,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:i,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=i,n.osname="Firefox OS")):l?n={name:"Amazon Silk",silk:i,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:i,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:i,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",osname:"BlackBerry OS",blackberry:i,version:b||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:m?(n={name:"WebOS",osname:"WebOS",webos:i,version:b||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=i)):/bada/i.test(e)?n={name:"Bada",osname:"Bada",bada:i,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:p?n={name:"Tizen",osname:"Tizen",tizen:i,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||b}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:i,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||b}:/chromium/i.test(e)?n={name:"Chromium",chromium:i,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||b}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:i,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?n={name:"Android",version:b}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:i},b&&(n.version=b)):o?(n={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},b&&(n.version=b)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:i,version:t(/googlebot\/(\d+(\.\d+))/i)||b}:{name:t(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=i):(n.name=n.name||"Webkit",n.webkit=i),!n.version&&b&&(n.version=b)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=i,n.version=n.version||t(/gecko\/(\d+(\.\d+)?)/i)),n.windowsphone||!s&&!n.silk?!n.windowsphone&&o?(n[o]=i,n.ios=i,n.osname="iOS"):_?(n.mac=i,n.osname="macOS"):P?(n.xbox=i,n.osname="Xbox"):v?(n.windows=i,n.osname="Windows"):y&&(n.linux=i,n.osname="Linux"):(n.android=i,n.osname="Android");var C="";n.windows?C=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(t(/Windows ((NT|XP)( \d\d?.\d)?)/i)):n.windowsphone?C=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n.mac?(C=t(/Mac OS X (\d+([_\.\s]\d+)*)/i),C=C.replace(/[_\s]/g,".")):o?(C=t(/os (\d+([_\s]\d+)*) like mac os x/i),C=C.replace(/[_\s]/g,".")):s?C=t(/android[ \/-](\d+(\.\d+)*)/i):n.webos?C=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?C=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?C=t(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(C=t(/tizen[\/\s](\d+(\.\d+)*)/i)),C&&(n.osversion=C);var S=!n.windows&&C.split(".")[0];return w||c||"ipad"==o||s&&(3==S||S>=4&&!k)||n.silk?n.tablet=i:(k||"iphone"==o||"ipod"==o||s||u||n.blackberry||n.webos||n.bada)&&(n.mobile=i),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=i:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=i:n.x=i,n}function t(e){return e.split(".").length}function r(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function n(e){for(var n=Math.max(t(e[0]),t(e[1])),o=r(e,function(e){var o=n-t(e);return e+=new Array(o+1).join(".0"),r(e.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--n>=0;){if(o[0][n]>o[1][n])return 1;if(o[0][n]!==o[1][n])return-1;if(0===n)return 0}}function o(t,r,o){var a=s;"string"==typeof r&&(o=r,r=void 0),void 0===r&&(r=!1),o&&(a=e(o));var i=""+a.version;for(var u in t)if(t.hasOwnProperty(u)&&a[u]){if("string"!=typeof t[u])throw new Error("Browser version in the minVersion map should be a string: "+u+": "+String(t));return n([i,t[u]])<0}return r}function a(e,t,r){return!o(e,t,r)}var i=!0,s=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return s.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if("string"==typeof r&&r in s)return!0}return!1},s.isUnsupportedBrowser=o,s.compareVersions=n,s.check=a,s._detect=e,s})},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,r){"use strict";(function(n){function o(e){return e&&e.__esModule?e:{default:e}}function a(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(a=o))}),e.splice(a,0,n)}}function s(){return"object"===("undefined"==typeof console?"undefined":(0,l.default)(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function u(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function c(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=Object({NODE_ENV:"production"}).DEBUG),e}var d=r(2),l=o(d),f=r(34),p=o(f);t=e.exports=r(189),t.log=s,t.formatArgs=i,t.save=u,t.load=c,t.useColors=a,t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return(0,p.default)(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(c())}).call(t,r(105))},function(e,t,r){"use strict";var n=r(34),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(0),i=a.JSON||(a.JSON={stringify:o.default});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,r){"use strict";function n(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function o(e){function r(){if(r.enabled){var e=r,n=+new Date,a=n-(o||n);e.diff=a,e.prev=o,e.curr=n,o=n;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var o=t.formatters[n];if("function"==typeof o){var a=i[u];r=o.call(e,a),i.splice(u,1),u--}return r}),t.formatArgs.call(e,i);(r.log||t.log||console.log.bind(console)).apply(e,i)}}var o;return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),r.destroy=a,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function a(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function i(e){t.save(e),t.names=[],t.skips=[];var r,n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&(e=n[r].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var a=t.instances[r];a.enabled=t.enabled(a.namespace)}}function s(){t.enable("")}function u(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o.debug=o.default=o,t.coerce=c,t.disable=s,t.enable=i,t.enabled=u,t.humanize=r(106),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(17),i=o(a),s=r(20),u=o(s),c=r(53),d=o(c),l=r(11),f=o(l),p=r(4),m=o(p),h=r(1),v=o(h),_=r(3),y=o(_),g=r(6),b=o(g),w=r(7),k=o(w),P=r(35),C=o(P),S=r(10),E=o(S),x=r(22),T=o(x),R=r(23),O=n(R),M=r(42),I=n(M),A=r(77),N=n(A),j=r(120),D=n(j),F=r(121),L=o(F),W=new E.default("Chrome55"),U=function(e){function t(e,r,n){(0,v.default)(this,t);var o=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,W));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new L.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,k.default)(t,e),(0,y.default)(t,[{key:"close",value:function(){W.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(T.default),B=function(e){function t(e,r){(0,v.default)(this,t);var n=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n}return(0,k.default)(t,e),(0,y.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(W.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return f.default.reject("track already added");var n=void 0;return f.default.resolve().then(function(){return t._stream.addTrack(r),t._pc.addStream(t._stream),t._pc.createOffer()}).then(function(n){if(e.simulcast){W.debug("addProducer() | enabling simulcast");var o=C.default.parse(n.sdp);D.addSimulcastForTrack(o,r);n={type:"offer",sdp:C.default.write(o)}}return W.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",n),t._pc.setLocalDescription(n)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){n=C.default.parse(t._pc.localDescription.sdp);var e=t._remoteSdp.createAnswerSdp(n),r={type:"answer",sdp:e};return W.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){var o=O.clone(t._rtpParametersByKind[e.kind]);return D.fillRtpParametersForTrack(o,n,r),o}).catch(function(e){throw t._stream.removeTrack(r),t._pc.addStream(t._stream),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return W.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),f.default.resolve().then(function(){return t._stream.removeTrack(r),t._pc.addStream(t._stream),t._pc.createOffer()}).then(function(e){return W.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).catch(function(e){if(0===t._stream.getTracks().length)return void W.warn("removeProducer() | ignoring expected error due no sending tracks: %s",e.toString());throw e}).then(function(){if("stable"!==t._pc.signalingState){var e=C.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return W.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;W.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track,o=void 0;return f.default.resolve().then(function(){return r._stream.removeTrack(n),r._stream.addTrack(t),r._pc.addStream(r._stream),r._pc.createOffer()}).then(function(n){if(e.simulcast){W.debug("addProducer() | enabling simulcast");var o=C.default.parse(n.sdp);D.addSimulcastForTrack(o,t);n={type:"offer",sdp:C.default.write(o)}}return W.debug("replaceProducerTrack() | calling pc.setLocalDescription() [offer:%o]",n),r._pc.setLocalDescription(n)}).then(function(){o=C.default.parse(r._pc.localDescription.sdp);var e=r._remoteSdp.createAnswerSdp(o),t={type:"answer",sdp:e};return W.debug("replaceProducerTrack() | calling pc.setRemoteDescription() [answer:%o]",t),r._pc.setRemoteDescription(t)}).then(function(){var n=O.clone(r._rtpParametersByKind[e.kind]);D.fillRtpParametersForTrack(n,o,t),r.safeEmit("@needupdateproducer",e,n)}).catch(function(e){throw r._stream.removeTrack(t),r._stream.addTrack(n),r._pc.addStream(r._stream),e})}},{key:"restartIce",value:function(e){var t=this;return W.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),f.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return W.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=C.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return W.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)})}},{key:"_setupTransport",value:function(){var e=this;return W.debug("_setupTransport()"),f.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=C.default.parse(r),o=N.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(U),G=function(e){function t(e,r){(0,v.default)(this,t);var n=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,"recv",e,r));return n._transportCreated=!1,n._transportUpdated=!1,n._kinds=new d.default,n._consumerInfos=new u.default,n}return(0,k.default)(t,e),(0,y.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(W.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return f.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={kind:e.kind,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),this._kinds.add(e.kind),f.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getRemoteStreams()[0],r=e.getTrackById(o.trackId);if(!r)throw new Error("remote track not found");return r})}},{key:"removeConsumer",value:function(e){var t=this;return W.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id)?(this._consumerInfos.delete(e.id),f.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):f.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return W.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),f.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return W.debug("_setupTransport()"),f.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){W.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=C.default.parse(e),r=N.extractDtlsParameters(t),n={dtlsParameters:r};this.safeEmit("@needupdatetransport",n),this._transportUpdated=!0}}]),t}(U),q=function(){function e(t,r,n){(0,v.default)(this,e),W.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:I.getSendingRtpParameters("audio",r),video:I.getSendingRtpParameters("video",r)},new B(o,n);case"recv":return o={audio:I.getReceivingFullRtpParameters("audio",r),video:I.getReceivingFullRtpParameters("video",r)},new G(o,n)}}return(0,y.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){W.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});return e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(t){try{e.close()}catch(e){}var r=C.default.parse(t.sdp);return N.extractRtpCapabilities(r)}).catch(function(t){try{e.close()}catch(e){}throw t})}},{key:"name",get:function(){return"Chrome55"}}]),e}();t.default=q},function(e,t,r){"use strict";r(51),r(26),r(33),r(192),r(196),r(198),r(199),e.exports=r(0).Map},function(e,t,r){"use strict";var n=r(107),o=r(75);e.exports=r(109)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=n.getEntry(o(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(o(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,r){"use strict";var n=r(21),o=r(61),a=r(31),i=r(47),s=r(194);e.exports=function(e,t){var r=1==e,u=2==e,c=3==e,d=4==e,l=6==e,f=5==e||l,p=t||s;return function(t,s,m){for(var h,v,_=a(t),y=o(_),g=n(s,m,3),b=i(y.length),w=0,k=r?p(t,b):u?p(t,0):void 0;b>w;w++)if((f||w in y)&&(h=y[w],v=g(h,w,_),e))if(r)k[w]=v;else if(v)switch(e){case 3:return!0;case 5:return h;case 6:return w;case 2:k.push(h)}else if(d)return!1;return l?-1:c||d?d:k}}},function(e,t,r){"use strict";var n=r(195);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){"use strict";var n=r(12),o=r(91),a=r(8)("species");e.exports=function(e){var t;return o(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!o(t.prototype)||(t=void 0),n(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){"use strict";var n=r(5);n(n.P+n.R,"Map",{toJSON:r(110)("Map")})},function(e,t,r){"use strict";var n=r(41);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t,r){"use strict";r(111)("Map")},function(e,t,r){"use strict";r(112)("Map")},function(e,t,r){"use strict";r(51),r(26),r(33),r(201),r(202),r(203),r(204),e.exports=r(0).Set},function(e,t,r){"use strict";var n=r(107),o=r(75);e.exports=r(109)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(o(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){"use strict";var n=r(5);n(n.P+n.R,"Set",{toJSON:r(110)("Set")})},function(e,t,r){"use strict";r(111)("Set")},function(e,t,r){"use strict";r(112)("Set")},function(e,t,r){"use strict";r(51),r(26),r(33),r(206),r(209),r(210),e.exports=r(0).Promise},function(e,t,r){"use strict";var n,o,a,i,s=r(44),u=r(9),c=r(21),d=r(52),l=r(5),f=r(12),p=r(36),m=r(74),h=r(41),v=r(113),_=r(114).set,y=r(208)(),g=r(76),b=r(115),w=r(116),k=u.TypeError,P=u.process,C=u.Promise,S="process"==d(P),E=function(){},x=o=g.f,T=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(8)("species")]=function(e){e(E,E)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(E)instanceof t}catch(e){}}(),R=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},O=function(e,t){if(!e._n){e._n=!0;var r=e._c;y(function(){for(var n=e._v,o=1==e._s,a=0;r.length>a;)!function(t){var r,a,i=o?t.ok:t.fail,s=t.resolve,u=t.reject,c=t.domain;try{i?(o||(2==e._h&&A(e),e._h=1),!0===i?r=n:(c&&c.enter(),r=i(n),c&&c.exit()),r===t.promise?u(k("Promise-chain cycle")):(a=R(r))?a.call(r,s,u):s(r)):u(n)}catch(e){u(e)}}(r[a++]);e._c=[],e._n=!1,t&&!e._h&&M(e)})}},M=function(e){_.call(u,function(){var t,r,n,o=e._v,a=I(e);if(a&&(t=b(function(){S?P.emit("unhandledRejection",o,e):(r=u.onunhandledrejection)?r({promise:e,reason:o}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=S||I(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},I=function(e){return 1!==e._h&&0===(e._a||e._c).length},A=function(e){_.call(u,function(){var t;S?P.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},N=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},j=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw k("Promise can't be resolved itself");(r=R(t))?y(function(){var o={_w:n,_d:!1};try{r.call(t,c(e,o,1),c(N,o,1))}catch(e){N.call(o,e)}}):(n._v=t,n._s=1,O(n,!1))}catch(e){N.call({_w:n,_d:!1},e)}}};T||(C=function(e){m(this,C,"Promise","_h"),p(e),n.call(this);try{e(c(j,this,1),c(N,this,1))}catch(e){N.call(this,e)}},n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},n.prototype=r(73)(C.prototype,{then:function(e,t){var r=x(v(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=S?P.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&O(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new n;this.promise=e,this.resolve=c(j,e,1),this.reject=c(N,e,1)},g.f=x=function(e){return e===C||e===i?new a(e):o(e)}),l(l.G+l.W+l.F*!T,{Promise:C}),r(40)(C,"Promise"),r(108)("Promise"),i=r(0).Promise,l(l.S+l.F*!T,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(s||!T),"Promise",{resolve:function(e){return w(s&&this===i?C:this,e)}}),l(l.S+l.F*!(T&&r(103)(function(e){C.all(e).catch(E)})),"Promise",{all:function(e){var t=this,r=x(t),n=r.resolve,o=r.reject,a=b(function(){var r=[],a=0,i=1;h(e,!1,function(e){var s=a++,u=!1;r.push(void 0),i++,t.resolve(e).then(function(e){u||(u=!0,r[s]=e,--i||n(r))},o)}),--i||n(r)});return a.e&&o(a.v),r.promise},race:function(e){var t=this,r=x(t),n=r.reject,o=b(function(){h(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){"use strict";var n=r(9),o=r(114).set,a=n.MutationObserver||n.WebKitMutationObserver,i=n.process,s=n.Promise,u="process"==r(39)(i);e.exports=function(){var e,t,r,c=function(){var n,o;for(u&&(n=i.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(u)r=function(){i.nextTick(c)};else if(!a||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var d=s.resolve();r=function(){d.then(c)}}else r=function(){o.call(n,c)};else{var l=!0,f=document.createTextNode("");new a(c).observe(f,{characterData:!0}),r=function(){f.data=l=!l}}return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},function(e,t,r){"use strict";var n=r(5),o=r(0),a=r(9),i=r(113),s=r(116);n(n.P+n.R,"Promise",{finally:function(e){var t=i(this,o.Promise||a.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var n=r(5),o=r(76),a=r(115);n(n.S,"Promise",{try:function(e){var t=o.f(this),r=a(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){"use strict";r(212),e.exports=r(0).Object.setPrototypeOf},function(e,t,r){"use strict";var n=r(5);n(n.S,"Object",{setPrototypeOf:r(213).set})},function(e,t,r){"use strict";var n=r(117),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=r(12),i=r(18),s=function(e,t){if(i(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:o.default||("__proto__"in{}?function(e,t,n){try{n=r(21)(Function.call,r(69).f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return s(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:s}},function(e,t,r){"use strict";var n=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,r,o){if(o&&!r)t[o]=n(e[1]);else for(var a=0;a<r.length;a+=1)null!=e[a+1]&&(t[r[a]]=n(e[a+1]))},a=function(e,t,r){var n=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:n&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:n?t[e.name]:t;o(r.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},i=r(118),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],o=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var u=i[t][s];if(u.reg.test(o))return a(u,n,o)}}),t.media=r,t};var u=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length&&(e[r[0]]=n(r[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(u,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),o=0;o<r.length;o+=3)t.push({component:r[o],ip:r[o+1],port:r[o+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(u,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}})})}},function(e,t,r){"use strict";var n=r(118),o=/%[sdv%]/g,a=function(e){var t=1,r=arguments,n=r.length;return e.replace(o,function(e){if(t>=n)return e;var o=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},i=function(e,t,r){var n=t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format,o=[e+"="+n];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?o.push(r[t.name][s]):o.push(r[t.names[i]])}else o.push(r[t.name]);return a.apply(null,o)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||s,o=t.innerOrder||u,a=[];return r.forEach(function(t){n[t].forEach(function(r){r.name in e&&null!=e[r.name]?a.push(i(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){a.push(i(t,r,e))})})}),e.media.forEach(function(e){a.push(i("m",n.m[0],e)),o.forEach(function(t){n[t].forEach(function(r){r.name in e&&null!=e[r.name]?a.push(i(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach(function(e){a.push(i(t,r,e))})})})}),a.join("\r\n")+"\r\n"}},function(e,t,r){"use strict";r(33),r(26),e.exports=r(217)},function(e,t,r){"use strict";var n=r(18),o=r(71);e.exports=r(0).getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(219),a=n(o),i=r(13),s=n(i);t.default=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=(0,s.default)(e);!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(e,t,r){"use strict";e.exports={default:r(220),__esModule:!0}},function(e,t,r){"use strict";r(33),r(26),e.exports=r(221)},function(e,t,r){"use strict";var n=r(52),o=r(8)("iterator"),a=r(30);e.exports=r(0).isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||a.hasOwnProperty(n(t))}},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(17),i=o(a),s=r(20),u=o(s),c=r(53),d=o(c),l=r(11),f=o(l),p=r(4),m=o(p),h=r(1),v=o(h),_=r(3),y=o(_),g=r(6),b=o(g),w=r(7),k=o(w),P=r(35),C=o(P),S=r(10),E=o(S),x=r(22),T=o(x),R=r(23),O=n(R),M=r(42),I=n(M),A=r(77),N=n(A),j=r(120),D=n(j),F=r(121),L=o(F),W=new E.default("Safari11"),U=function(e){function t(e,r,n){(0,v.default)(this,t);var o=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,W));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new L.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,k.default)(t,e),(0,y.default)(t,[{key:"close",value:function(){W.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(T.default),B=function(e){function t(e,r){(0,v.default)(this,t);var n=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n}return(0,k.default)(t,e),(0,y.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(W.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return f.default.reject("track already added");var n=void 0,o=void 0;return f.default.resolve().then(function(){return t._stream.addTrack(r),n=t._pc.addTrack(r,t._stream),t._pc.createOffer()}).then(function(e){return W.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){o=C.default.parse(t._pc.localDescription.sdp);var e=t._remoteSdp.createAnswerSdp(o),r={type:"answer",sdp:e};return W.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){var n=O.clone(t._rtpParametersByKind[e.kind]);return D.fillRtpParametersForTrack(n,o,r),n}).catch(function(e){try{t._pc.removeTrack(n)}catch(e){}throw t._stream.removeTrack(r),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return W.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),f.default.resolve().then(function(){var e=t._pc.getSenders().find(function(e){return e.track===r});if(!e)throw new Error("RTCRtpSender found");return t._pc.removeTrack(e),t._stream.removeTrack(r),t._pc.createOffer()}).then(function(e){return W.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).catch(function(e){if(0===t._stream.getTracks().length)return void W.warn("removeLocalTrack() | ignoring expected error due no sending tracks: %s",e.toString());throw e}).then(function(){if("stable"!==t._pc.signalingState){var e=C.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return W.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;W.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track;return f.default.resolve().then(function(){var e=r._pc.getSenders().find(function(e){return e.track===n});if(!e)throw new Error("local track not found");return e.replaceTrack(t)}).then(function(){r._stream.removeTrack(n),r._stream.addTrack(t)})}},{key:"restartIce",value:function(e){var t=this;return W.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),f.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return W.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=C.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return W.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)})}},{key:"_setupTransport",value:function(){var e=this;return W.debug("_setupTransport()"),f.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=C.default.parse(r),o=N.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(U),G=function(e){function t(e,r){(0,v.default)(this,t);var n=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,"recv",e,r));return n._transportCreated=!1,n._transportUpdated=!1,n._kinds=new d.default,n._consumerInfos=new u.default,n}return(0,k.default)(t,e),(0,y.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(W.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return f.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={kind:e.kind,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),this._kinds.add(e.kind),f.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getReceivers().find(function(e){var t=e.track;return!!t&&t.id===o.trackId});if(!e)throw new Error("remote track not found");return e.track})}},{key:"removeConsumer",value:function(e){var t=this;return W.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id)?(this._consumerInfos.delete(e.id),f.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):f.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return W.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),f.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._kinds),(0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return W.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return W.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return W.debug("_setupTransport()"),f.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){W.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=C.default.parse(e),r=N.extractDtlsParameters(t),n={dtlsParameters:r};this.safeEmit("@needupdatetransport",n),this._transportUpdated=!0}}]),t}(U),q=function(){function e(t,r,n){(0,v.default)(this,e),W.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:I.getSendingRtpParameters("audio",r),video:I.getSendingRtpParameters("video",r)},new B(o,n);case"recv":return o={audio:I.getReceivingFullRtpParameters("audio",r),video:I.getReceivingFullRtpParameters("video",r)},new G(o,n)}}return(0,y.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){W.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});return e.addTransceiver("audio"),e.addTransceiver("video"),e.createOffer().then(function(t){try{e.close()}catch(e){}var r=C.default.parse(t.sdp);return N.extractRtpCapabilities(r)}).catch(function(t){try{e.close()}catch(e){}throw t})}},{key:"name",get:function(){return"Safari11"}}]),e}();t.default=q},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(17),i=o(a),s=r(20),u=o(s),c=r(11),d=o(c),l=r(4),f=o(l),p=r(1),m=o(p),h=r(3),v=o(h),_=r(6),y=o(_),g=r(7),b=o(g),w=r(35),k=o(w),P=r(10),C=o(P),S=r(22),E=o(S),x=r(23),T=n(x),R=r(42),O=n(R),M=r(77),I=n(M),A=r(224),N=n(A),j=r(225),D=o(j),F=new C.default("Firefox50"),L=function(e){function t(e,r,n){(0,m.default)(this,t);var o=(0,y.default)(this,(t.__proto__||(0,f.default)(t)).call(this,F));return o._pc=new RTCPeerConnection({iceServers:n.turnServers||[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),o._rtpParametersByKind=r,o._remoteSdp=new D.default(e,r),o._pc.addEventListener("iceconnectionstatechange",function(){switch(o._pc.iceConnectionState){case"checking":o.emit("@connectionstatechange","connecting");break;case"connected":case"completed":o.emit("@connectionstatechange","connected");break;case"failed":o.emit("@connectionstatechange","failed");break;case"disconnected":o.emit("@connectionstatechange","disconnected");break;case"closed":o.emit("@connectionstatechange","closed")}}),o}return(0,b.default)(t,e),(0,v.default)(t,[{key:"close",value:function(){F.debug("close()");try{this._pc.close()}catch(e){}}}]),t}(E.default),W=function(e){function t(e,r){(0,m.default)(this,t);var n=(0,y.default)(this,(t.__proto__||(0,f.default)(t)).call(this,"send",e,r));return n._transportReady=!1,n._stream=new MediaStream,n._nextRid=1,n}return(0,b.default)(t,e),(0,v.default)(t,[{key:"addProducer",value:function(e){var t=this,r=e.track;if(F.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._stream.getTrackById(r.id))return d.default.reject("track already added");var n=void 0,o=void 0;return d.default.resolve().then(function(){t._stream.addTrack(r),n=t._pc.addTrack(r,t._stream)}).then(function(){if(e.simulcast){F.debug("addProducer() | enabling simulcast");var r=[];return e.simulcast.high&&r.push({rid:"high"+t._nextRid,active:!0,priority:"high",maxBitrate:e.simulcast.high}),e.simulcast.medium&&r.push({rid:"medium"+t._nextRid,active:!0,priority:"medium",maxBitrate:e.simulcast.medium}),e.simulcast.low&&r.push({rid:"low"+t._nextRid,active:!0,priority:"low",maxBitrate:e.simulcast.low}),t._nextRid++,n.setParameters({encodings:r})}}).then(function(){return t._pc.createOffer()}).then(function(e){return F.debug("addProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){o=k.default.parse(t._pc.localDescription.sdp);var e=t._remoteSdp.createAnswerSdp(o),r={type:"answer",sdp:e};return F.debug("addProducer() | calling pc.setRemoteDescription() [answer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){var n=T.clone(t._rtpParametersByKind[e.kind]);return N.fillRtpParametersForTrack(n,o,r),n}).catch(function(e){try{t._pc.removeTrack(n)}catch(e){}throw t._stream.removeTrack(r),e})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return F.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),d.default.resolve().then(function(){var e=t._pc.getSenders().find(function(e){return e.track===r});if(!e)throw new Error("RTCRtpSender found");return t._pc.removeTrack(e),t._stream.removeTrack(r),d.default.resolve().then(function(){return t._pc.createOffer()}).then(function(e){return F.debug("removeProducer() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)})}).then(function(){var e=k.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return F.debug("removeProducer() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;F.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id);var n=e.track;return d.default.resolve().then(function(){var e=r._pc.getSenders().find(function(e){return e.track===n});if(!e)throw new Error("local track not found");return e.replaceTrack(t)}).then(function(){r._stream.removeTrack(n),r._stream.addTrack(t)})}},{key:"restartIce",value:function(e){var t=this;return F.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),d.default.resolve().then(function(){return t._pc.createOffer({iceRestart:!0})}).then(function(e){return F.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){var e=k.default.parse(t._pc.localDescription.sdp),r=t._remoteSdp.createAnswerSdp(e),n={type:"answer",sdp:r};return F.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),t._pc.setRemoteDescription(n)})}},{key:"_setupTransport",value:function(){var e=this;return F.debug("_setupTransport()"),d.default.resolve().then(function(){var t={},r=e._pc.localDescription.sdp,n=k.default.parse(r),o=I.extractDtlsParameters(n);return o.role="server",t.dtlsParameters=o,e._remoteSdp.setTransportLocalParameters(t),e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportReady=!0})}}]),t}(L),U=function(e){function t(e,r){(0,m.default)(this,t);var n=(0,y.default)(this,(t.__proto__||(0,f.default)(t)).call(this,"recv",e,r));n._transportCreated=!1,n._transportUpdated=!1,n._consumerInfos=new u.default;var o={mid:"fake-datachannel-consumer",kind:"application",closed:!1,cname:null};return n._consumerInfos.set(555,o),n}return(0,b.default)(t,e),(0,v.default)(t,[{key:"addConsumer",value:function(e){var t=this;if(F.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._consumerInfos.has(e.id))return d.default.reject("Consumer already added");var r=e.rtpParameters.encodings[0],n=e.rtpParameters.rtcp.cname,o={mid:"consumer-"+e.kind+"-"+e.id,kind:e.kind,closed:e.closed,trackId:"consumer-"+e.kind+"-"+e.id,ssrc:r.ssrc,cname:n};return r.rtx&&r.rtx.ssrc&&(o.rtxSsrc=r.rtx.ssrc),this._consumerInfos.set(e.id,o),d.default.resolve().then(function(){if(!t._transportCreated)return t._setupTransport()}).then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return F.debug("addConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return F.debug("addConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)}).then(function(){if(!t._transportUpdated)return t._updateTransport()}).then(function(){var e=t._pc.getReceivers().find(function(e){var t=e.track;return!!t&&t.id===o.trackId});if(!e)throw new Error("remote track not found");return e.track})}},{key:"removeConsumer",value:function(e){var t=this;F.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind);var r=this._consumerInfos.get(e.id);return r?(r.closed=!0,d.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return F.debug("removeConsumer() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return F.debug("removeConsumer() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})):d.default.reject("Consumer not found")}},{key:"restartIce",value:function(e){var t=this;return F.debug("restartIce()"),this._remoteSdp.updateTransportRemoteIceParameters(e),d.default.resolve().then(function(){var e=t._remoteSdp.createOfferSdp((0,i.default)(t._consumerInfos.values())),r={type:"offer",sdp:e};return F.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),t._pc.setRemoteDescription(r)}).then(function(){return t._pc.createAnswer()}).then(function(e){return F.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",e),t._pc.setLocalDescription(e)})}},{key:"_setupTransport",value:function(){var e=this;return F.debug("_setupTransport()"),d.default.resolve().then(function(){return e.safeEmitAsPromise("@needcreatetransport",null)}).then(function(t){e._remoteSdp.setTransportRemoteParameters(t),e._transportCreated=!0})}},{key:"_updateTransport",value:function(){F.debug("_updateTransport()");var e=this._pc.localDescription.sdp,t=k.default.parse(e),r=I.extractDtlsParameters(t),n={dtlsParameters:r};this.safeEmit("@needupdatetransport",n),this._transportUpdated=!0}}]),t}(L),B=function(){function e(t,r,n){(0,m.default)(this,e),F.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",t,r);var o=void 0;switch(t){case"send":return o={audio:O.getSendingRtpParameters("audio",r),video:O.getSendingRtpParameters("video",r)},new W(o,n);case"recv":return o={audio:O.getReceivingFullRtpParameters("audio",r),video:O.getReceivingFullRtpParameters("video",r)},new U(o,n)}}return(0,v.default)(e,null,[{key:"getNativeRtpCapabilities",value:function(){F.debug("getNativeRtpCapabilities()");var e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");var r=t.captureStream(),n=r.getVideoTracks()[0];return e.addTrack(n,r).setParameters({encodings:[{rid:"RID1",maxBitrate:4e4},{rid:"RID2",maxBitrate:1e4}]}),e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(function(r){try{t.remove()}catch(e){}try{e.close()}catch(e){}var n=k.default.parse(r.sdp);return I.extractRtpCapabilities(n)}).catch(function(r){try{t.remove()}catch(e){}try{e.close()}catch(e){}throw r})}},{key:"name",get:function(){return"Firefox50"}}]),e}();t.default=B},function(e,t,r){"use strict";function n(e,t,r){var n=r.kind,o={cname:null,reducedSize:!0,mux:!0},i=(t.media||[]).find(function(e){if(e.type===n){var t=e.msid;if(t){return t.split(" ")[1]===r.id||void 0}}});if(!i)throw new Error("m="+n+" section not found");var s=(i.ssrcs||[]).find(function(e){return"cname"===e.attribute}),u=void 0;s&&(u=s.id,o.cname=s.value);var c=[],d=!0,l=!1,f=void 0;try{for(var p,m=(0,a.default)(i.rids||[]);!(d=(p=m.next()).done);d=!0){var h=p.value;"send"===h.direction&&(/^low/.test(h.id)?c.push({rid:h.id,profile:"low"}):/^medium/.test(h.id)&&c.push({rid:h.id,profile:"medium"}),/^high/.test(h.id)&&c.push({rid:h.id,profile:"high"}))}}catch(e){l=!0,f=e}finally{try{!d&&m.return&&m.return()}finally{if(l)throw f}}if(e.rtcp=o,e.encodings=[],0===c.length){var v={ssrc:u};e.encodings.push(v)}else{var _=!0,y=!1,g=void 0;try{for(var b,w=(0,a.default)(c);!(_=(b=w.next()).done);_=!0){var k=b.value,P={encodingId:k.rid,profile:k.profile};e.encodings.push(P)}}catch(e){y=!0,g=e}finally{try{!_&&w.return&&w.return()}finally{if(y)throw g}}}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(13),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.fillRtpParametersForTrack=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(25),a=n(o),i=r(13),s=n(i),u=r(4),c=n(u),d=r(6),l=n(d),f=r(7),p=n(f),m=r(1),h=n(m),v=r(3),_=n(v),y=r(35),g=n(y),b=r(10),w=n(b),k=r(23),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(k),C=new w.default("RemoteUnifiedPlanSdp"),S=function(){function e(t){(0,h.default)(this,e),this._rtpParametersByKind=t,this._transportLocalParameters=null,this._transportRemoteParameters=null,this._sdpGlobalFields={id:P.randomNumber(),version:0}}return(0,_.default)(e,[{key:"setTransportLocalParameters",value:function(e){C.debug("setTransportLocalParameters() [transportLocalParameters:%o]",e),this._transportLocalParameters=e}},{key:"setTransportRemoteParameters",value:function(e){C.debug("setTransportRemoteParameters() [transportRemoteParameters:%o]",e),this._transportRemoteParameters=e}},{key:"updateTransportRemoteIceParameters",value:function(e){C.debug("updateTransportRemoteIceParameters() [remoteIceParameters:%o]",e),this._transportRemoteParameters.iceParameters=e}}]),e}(),E=function(e){function t(e){return(0,h.default)(this,t),(0,l.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e))}return(0,p.default)(t,e),(0,_.default)(t,[{key:"createAnswerSdp",value:function(e){if(C.debug("createAnswerSdp()"),!this._transportLocalParameters)throw new Error("no transport local parameters");if(!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,o={},i=(e.media||[]).filter(function(e){return e.mid}).map(function(e){return e.mid});this._sdpGlobalFields.version++,o.version=0,o.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},o.name="-",o.timing={start:0,stop:0},o.icelite=t.iceLite?"ice-lite":null,o.msidSemantic={semantic:"WMS",token:"*"},i.length>0&&(o.groups=[{type:"BUNDLE",mids:i.join(" ")}]),o.media=[];var u=n.fingerprints.length;o.fingerprint={type:n.fingerprints[u-1].algorithm,hash:n.fingerprints[u-1].value};var c=!0,d=!1,l=void 0;try{for(var f,p=(0,s.default)(e.media||[]);!(c=(f=p.next()).done);c=!0){var m=f.value,h="inactive"===m.direction,v=m.type,_=this._rtpParametersByKind[v].codecs,y=this._rtpParametersByKind[v].headerExtensions,b={};b.type=m.type,b.port=7,b.protocol="RTP/SAVPF",b.connection={ip:"127.0.0.1",version:4},b.mid=m.mid,b.iceUfrag=t.usernameFragment,b.icePwd=t.password,b.candidates=[];var w=!0,k=!1,P=void 0;try{for(var S,E=(0,s.default)(r);!(w=(S=E.next()).done);w=!0){var x=S.value,T={};T.component=1,T.foundation=x.foundation,T.ip=x.ip,T.port=x.port,T.priority=x.priority,T.transport=x.protocol,T.type=x.type,x.tcpType&&(T.tcptype=x.tcpType),b.candidates.push(T)}}catch(e){k=!0,P=e}finally{try{!w&&E.return&&E.return()}finally{if(k)throw P}}switch(b.endOfCandidates="end-of-candidates",b.iceOptions="renomination",n.role){case"client":b.setup="active";break;case"server":b.setup="passive"}switch(m.direction){case"sendrecv":case"sendonly":b.direction="recvonly";break;case"recvonly":case"inactive":b.direction="inactive"}b.rtp=[],b.rtcpFb=[],b.fmtp=[];var R=!0,O=!1,M=void 0;try{for(var I,A=(0,s.default)(_);!(R=(I=A.next()).done);R=!0){var N=I.value,j={payload:N.payloadType,codec:N.name,rate:N.clockRate};if(N.channels>1&&(j.encoding=N.channels),b.rtp.push(j),N.parameters){var D={payload:N.payloadType,config:""},F=!0,L=!1,W=void 0;try{for(var U,B=(0,s.default)((0,a.default)(N.parameters));!(F=(U=B.next()).done);F=!0){var G=U.value;D.config&&(D.config+=";"),D.config+=G+"="+N.parameters[G]}}catch(e){L=!0,W=e}finally{try{!F&&B.return&&B.return()}finally{if(L)throw W}}D.config&&b.fmtp.push(D)}if(N.rtcpFeedback){var q=!0,z=!1,V=void 0;try{for(var K,H=(0,s.default)(N.rtcpFeedback);!(q=(K=H.next()).done);q=!0){var Y=K.value;b.rtcpFb.push({payload:N.payloadType,type:Y.type,subtype:Y.parameter||""})}}catch(e){z=!0,V=e}finally{try{!q&&H.return&&H.return()}finally{if(z)throw V}}}}}catch(e){O=!0,M=e}finally{try{!R&&A.return&&A.return()}finally{if(O)throw M}}if(b.payloads=_.map(function(e){return e.payloadType}).join(" "),!h){b.ext=[];var J=!0,Q=!1,$=void 0;try{for(var Z,X=(0,s.default)(y);!(J=(Z=X.next()).done);J=!0){(function(){var e=Z.value;if(!(m.ext||[]).find(function(t){return t.uri===e.uri}))return"continue";b.ext.push({uri:e.uri,value:e.id})})()}}catch(e){Q=!0,$=e}finally{try{!J&&X.return&&X.return()}finally{if(Q)throw $}}}if(m.simulcast_03){b.simulcast_03={value:m.simulcast_03.value.replace(/send/g,"recv")},b.rids=[];var ee=!0,te=!1,re=void 0;try{for(var ne,oe=(0,s.default)(m.rids||[]);!(ee=(ne=oe.next()).done);ee=!0){var ae=ne.value;"send"===ae.direction&&b.rids.push({id:ae.id,direction:"recv"})}}catch(e){te=!0,re=e}finally{try{!ee&&oe.return&&oe.return()}finally{if(te)throw re}}}b.rtcpMux="rtcp-mux",b.rtcpRsize="rtcp-rsize",o.media.push(b)}}catch(e){d=!0,l=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw l}}return g.default.write(o)}}]),t}(S),x=function(e){function t(e){(0,h.default)(this,t);var r=(0,l.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return r._streamId="recv-stream-"+P.randomNumber(),r}return(0,p.default)(t,e),(0,_.default)(t,[{key:"createOfferSdp",value:function(e){if(C.debug("createOfferSdp()"),!this._transportRemoteParameters)throw new Error("no transport remote parameters");var t=this._transportRemoteParameters.iceParameters,r=this._transportRemoteParameters.iceCandidates,n=this._transportRemoteParameters.dtlsParameters,o={},i=e.filter(function(e){return!e.closed}).map(function(e){return e.mid});this._sdpGlobalFields.version++,o.version=0,o.origin={address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:this._sdpGlobalFields.id,sessionVersion:this._sdpGlobalFields.version,username:"mediasoup-client"},o.name="-",o.timing={start:0,stop:0},o.icelite=t.iceLite?"ice-lite":null,o.msidSemantic={semantic:"WMS",token:"*"},i.length>0&&(o.groups=[{type:"BUNDLE",mids:i.join(" ")}]),o.media=[];var u=n.fingerprints.length;o.fingerprint={type:n.fingerprints[u-1].algorithm,hash:n.fingerprints[u-1].value};var c=!0,d=!1,l=void 0;try{for(var f,p=(0,s.default)(e);!(c=(f=p.next()).done);c=!0){var m=f.value,h=m.closed,v=m.kind,_=void 0,y=void 0;"application"!==m.kind&&(_=this._rtpParametersByKind[v].codecs,y=this._rtpParametersByKind[v].headerExtensions);var b={};"application"!==m.kind?(b.type=v,b.port=7,b.protocol="RTP/SAVPF",b.connection={ip:"127.0.0.1",version:4},b.mid=m.mid,b.msid=this._streamId+" "+m.trackId):(b.type=v,b.port=9,b.protocol="DTLS/SCTP",b.connection={ip:"127.0.0.1",version:4},b.mid=m.mid),b.iceUfrag=t.usernameFragment,b.icePwd=t.password,b.candidates=[];var w=!0,k=!1,P=void 0;try{for(var S,E=(0,s.default)(r);!(w=(S=E.next()).done);w=!0){var x=S.value,T={};T.component=1,T.foundation=x.foundation,T.ip=x.ip,T.port=x.port,T.priority=x.priority,T.transport=x.protocol,T.type=x.type,x.tcpType&&(T.tcptype=x.tcpType),b.candidates.push(T)}}catch(e){k=!0,P=e}finally{try{!w&&E.return&&E.return()}finally{if(k)throw P}}if(b.endOfCandidates="end-of-candidates",b.iceOptions="renomination",b.setup="actpass","application"!==m.kind){b.direction=h?"inactive":"sendonly",b.rtp=[],b.rtcpFb=[],b.fmtp=[];var R=!0,O=!1,M=void 0;try{for(var I,A=(0,s.default)(_);!(R=(I=A.next()).done);R=!0){var N=I.value,j={payload:N.payloadType,codec:N.name,rate:N.clockRate};if(N.channels>1&&(j.encoding=N.channels),b.rtp.push(j),N.parameters){var D={payload:N.payloadType,config:""},F=!0,L=!1,W=void 0;try{for(var U,B=(0,s.default)((0,a.default)(N.parameters));!(F=(U=B.next()).done);F=!0){var G=U.value;D.config&&(D.config+=";"),D.config+=G+"="+N.parameters[G]}}catch(e){L=!0,W=e}finally{try{!F&&B.return&&B.return()}finally{if(L)throw W}}D.config&&b.fmtp.push(D)}if(N.rtcpFeedback){var q=!0,z=!1,V=void 0;try{for(var K,H=(0,s.default)(N.rtcpFeedback);!(q=(K=H.next()).done);q=!0){var Y=K.value;b.rtcpFb.push({payload:N.payloadType,type:Y.type,subtype:Y.parameter||""})}}catch(e){z=!0,V=e}finally{try{!q&&H.return&&H.return()}finally{if(z)throw V}}}}}catch(e){O=!0,M=e}finally{try{!R&&A.return&&A.return()}finally{if(O)throw M}}if(b.payloads=_.map(function(e){return e.payloadType}).join(" "),!h){b.ext=[];var J=!0,Q=!1,$=void 0;try{for(var Z,X=(0,s.default)(y);!(J=(Z=X.next()).done);J=!0){var ee=Z.value;b.ext.push({uri:ee.uri,value:ee.id})}}catch(e){Q=!0,$=e}finally{try{!J&&X.return&&X.return()}finally{if(Q)throw $}}}b.rtcpMux="rtcp-mux",b.rtcpRsize="rtcp-rsize",h||(b.ssrcs=[],b.ssrcGroups=[],b.ssrcs.push({id:m.ssrc,attribute:"cname",value:m.cname}),m.rtxSsrc&&(b.ssrcs.push({id:m.rtxSsrc,attribute:"cname",value:m.cname}),b.ssrcGroups.push({semantics:"FID",ssrcs:m.ssrc+" "+m.rtxSsrc})))}else b.payloads=5e3,b.sctpmap={app:"webrtc-datachannel",maxMessageSize:256,sctpmapNumber:5e3};o.media.push(b)}}catch(e){d=!0,l=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw l}}return g.default.write(o)}}]),t}(S),T=function e(t,r){switch((0,h.default)(this,e),C.debug("constructor() [direction:%s, rtpParametersByKind:%o]",t,r),t){case"send":return new E(r);case"recv":return new x(r)}};t.default=T},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),i=o(a),s=r(13),u=o(s),c=r(20),d=o(c),l=r(4),f=o(l),p=r(1),m=o(p),h=r(6),v=o(h),_=r(3),y=o(_),g=r(7),b=o(g),w=r(10),k=o(w),P=r(22),C=o(P),S=r(23),E=n(S),x=r(42),T=n(x),R=r(227),O=n(R),M="CNAME-EDGE-"+E.randomNumber(),I=new k.default("Edge11"),A=function(e){function t(e,r,n){(0,m.default)(this,t);var o=(0,v.default)(this,(t.__proto__||(0,f.default)(t)).call(this,I));return I.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",e,r),o._rtpParametersByKind={audio:T.getSendingRtpParameters("audio",r),video:T.getSendingRtpParameters("video",r)},o._transportReady=!1,o._iceGatherer=null,o._iceTransport=null,o._dtlsTransport=null,o._rtpSenders=new d.default,o._rtpReceivers=new d.default,o._transportRemoteParameters=null,o._setIceGatherer(n),o._setIceTransport(),o._setDtlsTransport(),o}return(0,b.default)(t,e),(0,y.default)(t,null,[{key:"getNativeRtpCapabilities",value:function(){return I.debug("getNativeRtpCapabilities()"),O.getCapabilities()}},{key:"name",get:function(){return"Edge11"}}]),(0,y.default)(t,[{key:"close",value:function(){I.debug("close()");try{this._iceGatherer.close()}catch(e){}try{this._iceTransport.stop()}catch(e){}try{this._dtlsTransport.stop()}catch(e){}var e=!0,t=!1,r=void 0;try{for(var n,o=(0,u.default)(this._rtpSenders.values());!(e=(n=o.next()).done);e=!0){var a=n.value;try{a.stop()}catch(e){}}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}var i=!0,s=!1,c=void 0;try{for(var d,l=(0,u.default)(this._rtpReceivers.values());!(i=(d=l.next()).done);i=!0){var f=d.value;try{f.stop()}catch(e){}}}catch(e){s=!0,c=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw c}}}},{key:"addProducer",value:function(e){var t=this,r=e.track;return I.debug("addProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),this._rtpSenders.has(e.id)?i.default.reject("Producer already added"):i.default.resolve().then(function(){if(!t._transportReady)return t._setupTransport()}).then(function(){I.debug("addProducer() | calling new RTCRtpSender()");var n=new RTCRtpSender(r,t._dtlsTransport),o=E.clone(t._rtpParametersByKind[e.kind]),a={ssrc:E.randomNumber()};o.codecs.some(function(e){return"rtx"===e.name})&&(a.rtx={ssrc:E.randomNumber()}),o.encodings.push(a),o.rtcp={cname:M,reducedSize:!0,mux:!0};var i=O.mangleRtpParameters(o);return I.debug("addProducer() | calling rtpSender.send() [params:%o]",i),n.send(i),t._rtpSenders.set(e.id,n),o})}},{key:"removeProducer",value:function(e){var t=this,r=e.track;return I.debug("removeProducer() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,r.id),i.default.resolve().then(function(){var r=t._rtpSenders.get(e.id);if(!r)throw new Error("RTCRtpSender not found");t._rtpSenders.delete(e.id);try{I.debug("removeProducer() | calling rtpSender.stop()"),r.stop()}catch(e){I.warn("rtpSender.stop() failed:%o",e)}})}},{key:"replaceProducerTrack",value:function(e,t){var r=this;return I.debug("replaceProducerTrack() [id:%s, kind:%s, trackId:%s]",e.id,e.kind,t.id),i.default.resolve().then(function(){var n=r._rtpSenders.get(e.id);if(!n)throw new Error("RTCRtpSender not found");n.setTrack(t)})}},{key:"addConsumer",value:function(e){var t=this;return I.debug("addConsumer() [id:%s, kind:%s]",e.id,e.kind),this._rtpReceivers.has(e.id)?i.default.reject("Consumer already added"):i.default.resolve().then(function(){I.debug("addProducer() | calling new RTCRtpReceiver()");var r=new RTCRtpReceiver(t._dtlsTransport,e.kind);r.addEventListener("error",function(e){I.error('iceGatherer "error" event [event:%o]',e)});var n=O.mangleRtpParameters(e.rtpParameters);I.debug("addProducer() | calling rtpReceiver.receive() [params:%o]",n),r.receive(n),t._rtpReceivers.set(e.id,r)})}},{key:"removeConsumer",value:function(e){var t=this;return I.debug("removeConsumer() [id:%s, kind:%s]",e.id,e.kind),i.default.resolve().then(function(){var r=t._rtpReceivers.get(e.id);if(!r)throw new Error("RTCRtpReceiver not found");t._rtpReceivers.delete(e.id);try{I.debug("removeConsumer() | calling rtpReceiver.stop()"),r.stop()}catch(e){I.warn("rtpReceiver.stop() failed:%o",e)}})}},{key:"restartIce",value:function(e){var t=this;I.debug("restartIce()"),i.default.resolve().then(function(){t._transportRemoteParameters.iceParameters=e;var r=t._transportRemoteParameters.iceCandidates;I.debug("restartIce() | calling iceTransport.start()"),t._iceTransport.start(t._iceGatherer,e,"controlling");var n=!0,o=!1,a=void 0;try{for(var i,s=(0,u.default)(r);!(n=(i=s.next()).done);n=!0){var c=i.value;t._iceTransport.addRemoteCandidate(c)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}t._iceTransport.addRemoteCandidate({})})}},{key:"_setIceGatherer",value:function(e){var t=new RTCIceGatherer({iceServers:e.turnServers||[],gatherPolicy:"all"});t.addEventListener("error",function(e){I.error('iceGatherer "error" event [event:%o]',e)});try{t.gather()}catch(e){I.debug("iceGatherer.gather() failed: %s",e.toString())}this._iceGatherer=t}},{key:"_setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}}),t.addEventListener("icestatechange",function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}}),t.addEventListener("candidatepairchange",function(e){I.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)}),this._iceTransport=t}},{key:"_setDtlsTransport",value:function(){var e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",function(){I.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",function(){I.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state)}),e.addEventListener("error",function(e){I.error('dtlsTransport "error" event [event:%o]',e)}),this._dtlsTransport=e}},{key:"_setupTransport",value:function(){var e=this;return I.debug("_setupTransport()"),i.default.resolve().then(function(){var t={},r=e._dtlsTransport.getLocalParameters();return r.role="server",t.dtlsParameters=r,e.safeEmitAsPromise("@needcreatetransport",t)}).then(function(t){e._transportRemoteParameters=t;var r=t.iceParameters,n=t.iceCandidates,o=t.dtlsParameters;e._iceTransport.start(e._iceGatherer,r,"controlling");var a=!0,i=!1,s=void 0;try{for(var c,d=(0,u.default)(n);!(a=(c=d.next()).done);a=!0){var l=c.value;e._iceTransport.addRemoteCandidate(l)}}catch(e){i=!0,s=e}finally{try{!a&&d.return&&d.return()}finally{if(i)throw s}}e._iceTransport.addRemoteCandidate({}),o.fingerprints=o.fingerprints.filter(function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm}),e._dtlsTransport.start(o),e._transportReady=!0})}}]),t}(C.default);t.default=A},function(e,t,r){"use strict";function n(){var e=RTCRtpReceiver.getCapabilities(),t=u.clone(e),r=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(t.codecs);!(r=(a=s.next()).done);r=!0){var c=a.value;c.channels=c.numChannels,delete c.numChannels,"audio"!==c.kind?delete c.channels:c.channels||(c.channels=1),c.mimeType=c.kind+"/"+c.name,"rtx"===c.name&&(c.parameters.apt=Number(c.parameters.apt));var d=!0,l=!1,f=void 0;try{for(var p,m=(0,i.default)(c.rtcpFeedback||[]);!(d=(p=m.next()).done);d=!0){var h=p.value;h.parameter||delete h.parameter}}catch(e){l=!0,f=e}finally{try{!d&&m.return&&m.return()}finally{if(l)throw f}}}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return t}function o(e){var t=u.clone(e),r=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(t.codecs);!(r=(a=s.next()).done);r=!0){var c=a.value;c.channels&&(c.numChannels=c.channels,delete c.channels),delete c.mimeType}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return t}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),i=function(e){return e&&e.__esModule?e:{default:e}}(a);t.getCapabilities=n,t.mangleRtpParameters=o;var s=r(23),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(17),a=n(o),i=r(19),s=n(i),u=r(2),c=n(u),d=r(13),l=n(d),f=r(11),p=n(f),m=r(20),h=n(m),v=r(4),_=n(v),y=r(1),g=n(y),b=r(3),w=n(b),k=r(6),P=n(k),C=r(7),S=n(C),E=r(10),x=n(E),T=r(22),R=n(T),O=r(43),M=r(42),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(M),A=r(72),N=n(A),j=r(229),D=n(j),F=r(231),L=n(F),W=r(232),U=n(W),B=r(233),G=n(B),q=new x.default("Room"),z={new:"new",joining:"joining",joined:"joined",closed:"closed"},V=function(e){function t(e){(0,g.default)(this,t);var r=(0,P.default)(this,(t.__proto__||(0,_.default)(t)).call(this,q));if(q.debug("constructor() [options:%o]",e),!N.default.isSupported())throw new Error("current browser/device not supported");return e=e||{},r._settings={roomSettings:e.roomSettings,requestTimeout:e.requestTimeout||1e4,transportOptions:e.transportOptions||{},turnServers:e.turnServers||[]},r._state=z.new,r._peerName=null,r._transports=new h.default,r._producers=new h.default,r._peers=new h.default,r._extendedRtpCapabilities=null,r._canSendByKind={audio:!1,video:!1},r}return(0,S.default)(t,e),(0,w.default)(t,[{key:"getTransportById",value:function(e){return this._transports.get(e)}},{key:"getProducerById",value:function(e){return this._producers.get(e)}},{key:"getPeerByName",value:function(e){return this._peers.get(e)}},{key:"join",value:function(e,t){var r=this;if(q.debug('join() [peerName:"%s"]',e),"string"!=typeof e)return p.default.reject(new TypeError("invalid peerName"));if(this._state!==z.new&&this._state!==z.closed)return p.default.reject(new O.InvalidStateError('invalid state "'+this._state+'"'));this._peerName=e,this._state=z.joining;var n=void 0;return p.default.resolve().then(function(){return r._settings.roomSettings?void(n=r._settings.roomSettings):r._sendRequest("queryRoom",{target:"room"}).then(function(e){n=e,q.debug("join() | got Room settings:%o",n)})}).then(function(){return N.default.Handler.getNativeRtpCapabilities()}).then(function(e){q.debug("join() | native RTP capabilities:%o",e),r._extendedRtpCapabilities=I.getExtendedRtpCapabilities(e,n.rtpCapabilities),q.debug("join() | extended RTP capabilities:%o",r._extendedRtpCapabilities);var o=I.getUnsupportedCodecs(n.rtpCapabilities,n.mandatoryCodecPayloadTypes,r._extendedRtpCapabilities);if(o.length>0)throw q.error("%s mandatory room codecs not supported:%o",o.length,o),new O.UnsupportedError("mandatory room codecs not supported",o);r._canSendByKind.audio=I.canSend("audio",r._extendedRtpCapabilities),r._canSendByKind.video=I.canSend("video",r._extendedRtpCapabilities);var a=I.getRtpCapabilities(r._extendedRtpCapabilities);q.debug("join() | effective local RTP capabilities for receiving:%o",a);var i={target:"room",peerName:r._peerName,rtpCapabilities:a,appData:t};return r._sendRequest("join",i).then(function(e){return e.peers})}).then(function(e){var t=!0,n=!1,o=void 0;try{for(var a,i=(0,l.default)(e||[]);!(t=(a=i.next()).done);t=!0){var s=a.value;try{r._handlePeerData(s)}catch(e){q.error("join() | error handling Peer:%o",e)}}}catch(e){n=!0,o=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw o}}return r._state=z.joined,q.debug("join() | joined the Room"),r.peers}).catch(function(e){throw r._state=z.new,e})}},{key:"leave",value:function(e){if(q.debug("leave()"),!this.closed){this._sendNotification("leave",{appData:e}),this._state=z.closed,this.safeEmit("close","local",e);var t=!0,r=!1,n=void 0;try{for(var o,a=(0,l.default)(this._transports.values());!(t=(o=a.next()).done);t=!0){o.value.close()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var i=!0,s=!1,u=void 0;try{for(var c,d=(0,l.default)(this._producers.values());!(i=(c=d.next()).done);i=!0){c.value.close()}}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}var f=!0,p=!1,m=void 0;try{for(var h,v=(0,l.default)(this._peers.values());!(f=(h=v.next()).done);f=!0){h.value.close()}}catch(e){p=!0,m=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw m}}}}},{key:"remoteClose",value:function(e){if(q.debug("remoteClose()"),!this.closed){this._state=z.closed,this.safeEmit("close","remote",e);var t=!0,r=!1,n=void 0;try{for(var o,a=(0,l.default)(this._transports.values());!(t=(o=a.next()).done);t=!0){o.value.remoteClose()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var i=!0,s=!1,u=void 0;try{for(var c,d=(0,l.default)(this._producers.values());!(i=(c=d.next()).done);i=!0){c.value.remoteClose()}}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}var f=!0,p=!1,m=void 0;try{for(var h,v=(0,l.default)(this._peers.values());!(f=(h=v.next()).done);f=!0){h.value.remoteClose()}}catch(e){p=!0,m=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw m}}}}},{key:"canSend",value:function(e){if(!this.joined)throw new O.InvalidStateError('invalid state "'+this._state+'"');if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'+e+'"');return this._canSendByKind[e]}},{key:"createTransport",value:function(e,t){var r=this;if(q.debug("createTransport() [direction:%s]",e),!this.joined)throw new O.InvalidStateError('invalid state "'+this._state+'"');if("send"!==e&&"recv"!==e)throw new TypeError('invalid direction "'+e+'"');var n=new D.default(e,this._extendedRtpCapabilities,this._settings,t);return this._transports.set(n.id,n),n.on("@request",function(e,t,n,o){r._sendRequest(e,t).then(n).catch(o)}),n.on("@notify",function(e,t){r._sendNotification(e,t)}),n.on("@close",function(){r._transports.delete(n.id)}),n}},{key:"createProducer",value:function(e,t,r){var n=this;if(q.debug("createProducer() [track:%o, options:%o]",e,t),!this.joined)throw new O.InvalidStateError('invalid state "'+this._state+'"');if(!(e instanceof MediaStreamTrack))throw new TypeError("track is not a MediaStreamTrack");if(!this._canSendByKind[e.kind])throw new Error("cannot send "+e.kind);if("ended"===e.readyState)throw new Error('track.readyState is "ended"');t=t||{};var o=new L.default(e,t,r);return this._producers.set(o.id,o),o.on("@close",function(){n._producers.delete(o.id)}),o}},{key:"restartIce",value:function(){if(!this.joined)throw new O.InvalidStateError('invalid state "'+this._state+'"');var e=!0,t=!1,r=void 0;try{for(var n,o=(0,l.default)(this._transports.values());!(e=(n=o.next()).done);e=!0){n.value.restartIce()}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}},{key:"receiveNotification",value:function(e){var t=this;if(this.closed)return p.default.reject(new O.InvalidStateError("Room closed"));if("object"!==(void 0===e?"undefined":(0,c.default)(e)))return p.default.reject(new TypeError("wrong notification Object"));if(!0!==e.notification)return p.default.reject(new TypeError("not a notification"));if("string"!=typeof e.method)return p.default.reject(new TypeError("wrong/missing notification method"));var r=e.method;return q.debug("receiveNotification() [method:%s, notification:%o]",r,e),p.default.resolve().then(function(){switch(r){case"closed":var n=e.appData;t.remoteClose(n);break;case"transportClosed":var o=e.id,a=e.appData,i=t._transports.get(o);if(!i)throw new Error('Transport not found [id:"'+o+'"]');i.remoteClose(a);break;case"transportStats":var s=e.id,u=e.stats,c=t._transports.get(s);if(!c)throw new Error("transport not found [id:"+s+"]");c.remoteStats(u);break;case"newPeer":var d=e.name;if(t._peers.has(d))throw new Error('Peer already exists [name:"'+d+'"]');var l=e;t._handlePeerData(l);break;case"peerClosed":var f=e.name,p=e.appData,m=t._peers.get(f);if(!m)throw new Error('no Peer found [name:"'+f+'"]');m.remoteClose(p);break;case"producerPaused":var h=e.id,v=e.appData,_=t._producers.get(h);if(!_)throw new Error("Producer not found [id:"+h+"]");_.remotePause(v);break;case"producerResumed":var y=e.id,g=e.appData,b=t._producers.get(y);if(!b)throw new Error("Producer not found [id:"+y+"]");b.remoteResume(g);break;case"producerClosed":var w=e.id,k=e.appData,P=t._producers.get(w);if(!P)throw new Error("Producer not found [id:"+w+"]");P.remoteClose(k);break;case"producerStats":var C=e.id,S=e.stats,E=t._producers.get(C);if(!E)throw new Error("Producer not found [id:"+C+"]");E.remoteStats(S);break;case"newConsumer":var x=e.peerName,T=t._peers.get(x);if(!T)throw new Error('no Peer found [name:"'+x+'"]');var R=e;t._handleConsumerData(R,T);break;case"consumerClosed":var O=e.id,M=e.peerName,I=e.appData,A=t._peers.get(M);if(!A)throw new Error('no Peer found [name:"'+M+'"]');var N=A.getConsumerById(O);if(!N)throw new Error("Consumer not found [id:"+O+"]");N.remoteClose(I);break;case"consumerPaused":var j=e.id,D=e.peerName,F=e.appData,L=t._peers.get(D);if(!L)throw new Error('no Peer found [name:"'+D+'"]');var W=L.getConsumerById(j);if(!W)throw new Error("Consumer not found [id:"+j+"]");W.remotePause(F);break;case"consumerResumed":var U=e.id,B=e.peerName,G=e.appData,q=t._peers.get(B);if(!q)throw new Error('no Peer found [name:"'+B+'"]');var z=q.getConsumerById(U);if(!z)throw new Error("Consumer not found [id:"+U+"]");z.remoteResume(G);break;case"consumerPreferredProfileSet":var V=e.id,K=e.peerName,H=e.profile,Y=t._peers.get(K);if(!Y)throw new Error('no Peer found [name:"'+K+'"]');var J=Y.getConsumerById(V);if(!J)throw new Error("Consumer not found [id:"+V+"]");J.remoteSetPreferredProfile(H);break;case"consumerEffectiveProfileChanged":var Q=e.id,$=e.peerName,Z=e.profile,X=t._peers.get($);if(!X)throw new Error('no Peer found [name:"'+$+'"]');var ee=X.getConsumerById(Q);if(!ee)throw new Error("Consumer not found [id:"+Q+"]");ee.remoteEffectiveProfileChanged(Z);break;case"consumerStats":var te=e.id,re=e.peerName,ne=e.stats,oe=t._peers.get(re);if(!oe)throw new Error('no Peer found [name:"'+re+'"]');var ae=oe.getConsumerById(te);if(!ae)throw new Error("Consumer not found [id:"+te+"]");ae.remoteStats(ne);break;default:throw new Error('unknown notification method "'+r+'"')}}).catch(function(t){q.error("receiveNotification() failed [notification:%o]: %s",e,t)})}},{key:"_sendRequest",value:function(e,t){var r=this,n=(0,s.default)({method:e,target:"peer"},t);return this.closed?(q.error("_sendRequest() | Room closed [method:%s, request:%o]",e,n),p.default.reject(new O.InvalidStateError("Room closed"))):(q.debug("_sendRequest() [method:%s, request:%o]",e,n),new p.default(function(t,o){var a=!1,i=setTimeout(function(){q.error("request failed [method:%s]: timeout",e),a=!0,o(new O.TimeoutError("timeout"))},r._settings.requestTimeout),s=function(n){if(!a){if(a=!0,clearTimeout(i),r.closed)return q.error("request failed [method:%s]: Room closed",e),void o(new Error("Room closed"));q.debug("request succeeded [method:%s, response:%o]",e,n),t(n)}},u=function(t){if(!a){if(a=!0,clearTimeout(i),r.closed)return q.error("request failed [method:%s]: Room closed",e),void o(new Error("Room closed"));t instanceof Error||(t=new Error(String(t))),q.error("request failed [method:%s]:%o",e,t),o(t)}};r.safeEmit("request",n,s,u)}))}},{key:"_sendNotification",value:function(e,t){if(!this.closed){var r=(0,s.default)({method:e,target:"peer",notification:!0},t);q.debug("_sendNotification() [method:%s, notification:%o]",e,r),this.safeEmit("notify",r)}}},{key:"_handlePeerData",value:function(e){var t=this,r=e.name,n=e.consumers,o=e.appData,a=new U.default(r,o);this._peers.set(a.name,a),a.on("@close",function(){t._peers.delete(a.name)});var i=!0,s=!1,u=void 0;try{for(var c,d=(0,l.default)(n);!(i=(c=d.next()).done);i=!0){var f=c.value;try{this._handleConsumerData(f,a)}catch(e){q.error("error handling existing Consumer in Peer:%o",e)}}}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}this.joined&&this.safeEmit("newpeer",a)}},{key:"_handleConsumerData",value:function(e,t){var r=e.id,n=e.kind,o=e.rtpParameters,a=e.paused,i=e.appData,s=new G.default(r,n,o,t,i);I.canReceive(s.rtpParameters,this._extendedRtpCapabilities)&&s.setSupported(!0),a&&s.remotePause(),t.addConsumer(s)}},{key:"joined",get:function(){return this._state===z.joined}},{key:"closed",get:function(){return this._state===z.closed}},{key:"peerName",get:function(){return this._peerName}},{key:"transports",get:function(){return(0,a.default)(this._transports.values())}},{key:"producers",get:function(){return(0,a.default)(this._producers.values())}},{key:"peers",get:function(){return(0,a.default)(this._peers.values())}}]),t}(R.default);t.default=V},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),a=n(o),i=r(4),s=n(i),u=r(1),c=n(u),d=r(3),l=n(d),f=r(6),p=n(f),m=r(7),h=n(m),v=r(10),_=n(v),y=r(22),g=n(y),b=r(43),w=r(23),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(w),P=r(72),C=n(P),S=r(230),E=n(S),x=new _.default("Transport"),T=function(e){function t(e,r,n,o){(0,c.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,s.default)(t)).call(this,x));return x.debug("constructor() [direction:%s, extendedRtpCapabilities:%o]",e,r),a._id=k.randomNumber(),a._closed=!1,a._direction=e,a._settings=n,a._appData=o,a._statsEnabled=!1,a._commandQueue=new E.default,a._handler=new C.default.Handler(e,r,n),a._connectionState="new",a._commandQueue.on("exec",a._execCommand.bind(a)),a._handleHandler(),a}return(0,h.default)(t,e),(0,l.default)(t,[{key:"close",value:function(e){x.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.disableStats()),this.safeEmit("@notify","closeTransport",{id:this._id,appData:e}),this.emit("@close"),this.safeEmit("close","local",e),this._destroy())}},{key:"remoteClose",value:function(e){x.debug("remoteClose()"),this._closed||(this._closed=!0,this.emit("@close"),this.safeEmit("close","remote",e),this._destroy())}},{key:"_destroy",value:function(){this._commandQueue.close(),this._handler.close()}},{key:"restartIce",value:function(){var e=this;x.debug("restartIce()"),this._closed||"new"!==this._connectionState&&a.default.resolve().then(function(){var t={id:e._id};return e.safeEmitAsPromise("@request","restartTransport",t)}).then(function(t){var r=t.iceParameters;return e._commandQueue.push("restartIce",{remoteIceParameters:r})}).catch(function(e){x.error("restartIce() | failed: %o",e)})}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;x.debug("enableStats() [interval:%s]",e),("number"!=typeof e||e<1e3)&&(e=1e3),this._statsEnabled=!0;var t={id:this._id,interval:e};this.safeEmit("@notify","enableTransportStats",t)}},{key:"disableStats",value:function(){x.debug("disableStats()"),this._statsEnabled=!1;var e={id:this._id};this.safeEmit("@notify","disableTransportStats",e)}},{key:"_handleHandler",value:function(){var e=this,t=this._handler;t.on("@connectionstatechange",function(t){e._connectionState!==t&&(x.debug("Transport connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}),t.on("@needcreatetransport",function(t,r,n){var o={id:e._id,direction:e._direction,options:e._settings.transportOptions,appData:e._appData};t&&(o.dtlsParameters=t.dtlsParameters),e.safeEmit("@request","createTransport",o,r,n)}),t.on("@needupdatetransport",function(t){var r={id:e._id,dtlsParameters:t.dtlsParameters};e.safeEmit("@notify","updateTransport",r)}),t.on("@needupdateproducer",function(t,r){var n={id:t.id,rtpParameters:r};t.setRtpParameters(r),e.safeEmit("@notify","updateProducer",n)})}},{key:"addProducer",value:function(e){return x.debug("addProducer() [producer:%o]",e),this._closed?a.default.reject(new b.InvalidStateError("Transport closed")):"send"!==this._direction?a.default.reject(new Error("not a sending Transport")):this._commandQueue.push("addProducer",{producer:e})}},{key:"removeProducer",value:function(e,t,r){x.debug("removeProducer() [producer:%o]",e),this._closed||this._commandQueue.push("removeProducer",{producer:e}).catch(function(){}),"local"===t&&this.safeEmit("@notify","closeProducer",{id:e.id,appData:r})}},{key:"pauseProducer",value:function(e,t){x.debug("pauseProducer() [producer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","pauseProducer",r)}},{key:"resumeProducer",value:function(e,t){x.debug("resumeProducer() [producer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","resumeProducer",r)}},{key:"replaceProducerTrack",value:function(e,t){return x.debug("replaceProducerTrack() [producer:%o]",e),this._commandQueue.push("replaceProducerTrack",{producer:e,track:t})}},{key:"enableProducerStats",value:function(e,t){x.debug("enableProducerStats() [producer:%o]",e);var r={id:e.id,interval:t};this.safeEmit("@notify","enableProducerStats",r)}},{key:"disableProducerStats",value:function(e){x.debug("disableProducerStats() [producer:%o]",e);var t={id:e.id};this.safeEmit("@notify","disableProducerStats",t)}},{key:"addConsumer",value:function(e){return x.debug("addConsumer() [consumer:%o]",e),this._closed?a.default.reject(new b.InvalidStateError("Transport closed")):"recv"!==this._direction?a.default.reject(new Error("not a receiving Transport")):this._commandQueue.push("addConsumer",{consumer:e})}},{key:"removeConsumer",value:function(e){x.debug("removeConsumer() [consumer:%o]",e),this._commandQueue.push("removeConsumer",{consumer:e}).catch(function(){})}},{key:"pauseConsumer",value:function(e,t){x.debug("pauseConsumer() [consumer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","pauseConsumer",r)}},{key:"resumeConsumer",value:function(e,t){x.debug("resumeConsumer() [consumer:%o]",e);var r={id:e.id,appData:t};this.safeEmit("@notify","resumeConsumer",r)}},{key:"setConsumerPreferredProfile",value:function(e,t){x.debug("setConsumerPreferredProfile() [consumer:%o]",e);var r={id:e.id,profile:t};this.safeEmit("@notify","setConsumerPreferredProfile",r)}},{key:"enableConsumerStats",value:function(e,t){x.debug("enableConsumerStats() [consumer:%o]",e);var r={id:e.id,interval:t};this.safeEmit("@notify","enableConsumerStats",r)}},{key:"disableConsumerStats",value:function(e){x.debug("disableConsumerStats() [consumer:%o]",e);var t={id:e.id};this.safeEmit("@notify","disableConsumerStats",t)}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"_execCommand",value:function(e,t){var r=void 0;try{switch(e.method){case"addProducer":var n=e.producer;r=this._execAddProducer(n);break;case"removeProducer":var o=e.producer;r=this._execRemoveProducer(o);break;case"replaceProducerTrack":var i=e.producer,s=e.track;r=this._execReplaceProducerTrack(i,s);break;case"addConsumer":var u=e.consumer;r=this._execAddConsumer(u);break;case"removeConsumer":var c=e.consumer;r=this._execRemoveConsumer(c);break;case"restartIce":var d=e.remoteIceParameters;r=this._execRestartIce(d);break;default:r=a.default.reject(new Error('unknown command method "'+e.method+'"'))}}catch(e){r=a.default.reject(e)}t.promise=r}},{key:"_execAddProducer",value:function(e){var t=this;x.debug("_execAddProducer()");var r=void 0;return a.default.resolve().then(function(){return t._handler.addProducer(e)}).then(function(n){r=n;var o={id:e.id,kind:e.kind,transportId:t._id,rtpParameters:n,paused:e.locallyPaused,appData:e.appData};return t.safeEmitAsPromise("@request","createProducer",o)}).then(function(){e.setRtpParameters(r)})}},{key:"_execRemoveProducer",value:function(e){return x.debug("_execRemoveProducer()"),this._handler.removeProducer(e)}},{key:"_execReplaceProducerTrack",value:function(e,t){return x.debug("_execReplaceProducerTrack()"),this._handler.replaceProducerTrack(e,t)}},{key:"_execAddConsumer",value:function(e){var t=this;x.debug("_execAddConsumer()");var r=void 0;return a.default.resolve().then(function(){return t._handler.addConsumer(e)}).then(function(n){r=n;var o={id:e.id,transportId:t.id,paused:e.locallyPaused,preferredProfile:e.preferredProfile};return t.safeEmitAsPromise("@request","enableConsumer",o)}).then(function(t){var n=t.paused,o=t.preferredProfile,a=t.effectiveProfile;return n&&e.remotePause(),o&&e.remoteSetPreferredProfile(o),a&&e.remoteEffectiveProfileChanged(a),r})}},{key:"_execRemoveConsumer",value:function(e){return x.debug("_execRemoveConsumer()"),this._handler.removeConsumer(e)}},{key:"_execRestartIce",value:function(e){return x.debug("_execRestartIce()"),this._handler.restartIce(e)}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"appData",get:function(){return this._appData}},{key:"connectionState",get:function(){return this._connectionState}}]),t}(g.default);t.default=T},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),a=n(o),i=r(19),s=n(i),u=r(4),c=n(u),d=r(1),l=n(d),f=r(3),p=n(f),m=r(6),h=n(m),v=r(7),_=n(v),y=r(54),g=r(10),b=n(g),w=r(43),k=new b.default("CommandQueue"),P=function(e){function t(){(0,l.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return e.setMaxListeners(1/0),e._closed=!1,e._busy=!1,e._queue=[],e}return(0,_.default)(t,e),(0,p.default)(t,[{key:"close",value:function(){this._closed=!0}},{key:"push",value:function(e,t){var r=this,n=(0,s.default)({method:e},t);return k.debug("push() [method:%s]",e),new a.default(function(e,t){var o=r._queue;n.resolve=e,n.reject=t,o.push(n),r._handlePendingCommands()})}},{key:"_handlePendingCommands",value:function(){var e=this;if(!this._busy){var t=this._queue,r=t[0];r&&(this._busy=!0,this._handleCommand(r).then(function(){e._busy=!1,t.shift(),e._handlePendingCommands()}))}}},{key:"_handleCommand",value:function(e){var t=this;if(k.debug("_handleCommand() [method:%s]",e.method),this._closed)return e.reject(new w.InvalidStateError("closed")),a.default.resolve();var r={promise:null};return this.emit("exec",e,r),a.default.resolve().then(function(){return r.promise}).then(function(r){if(k.debug("_handleCommand() | command succeeded [method:%s]",e.method),t._closed)return void e.reject(new w.InvalidStateError("closed"));e.resolve(r)}).catch(function(t){k.error("_handleCommand() | command failed [method:%s]: %o",e.method,t),e.reject(t)})}}]),t}(y.EventEmitter);t.default=P},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=n(o),i=r(11),s=n(i),u=r(19),c=n(u),d=r(4),l=n(d),f=r(1),p=n(f),m=r(3),h=n(m),v=r(6),_=n(v),y=r(7),g=n(y),b=r(10),w=n(b),k=r(22),P=n(k),C=r(43),S=r(23),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(S),x=1e3,T={low:1e5,medium:3e5,high:15e5},R=new w.default("Producer"),O=function(e){function t(e,r,n){(0,p.default)(this,t);var o=(0,_.default)(this,(t.__proto__||(0,l.default)(t)).call(this,R));return o._id=E.randomNumber(),o._closed=!1,o._originalTrack=e,o._track=e.clone(),o._appData=n,o._simulcast=!1,r.simulcast&&(o._simulcast=(0,c.default)({},T,r.simulcast)),o._transport=null,o._rtpParameters=null,o._locallyPaused=!o._track.enabled,o._remotelyPaused=!1,o._statsEnabled=!1,o._statsInterval=x,o._handleTrack(),o}return(0,g.default)(t,e),(0,h.default)(t,[{key:"close",value:function(e){R.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.transport&&this.transport.disableProducerStats(this)),this._transport&&this._transport.removeProducer(this,"local",e),this._destroy(),this.emit("@close","local",e),this.safeEmit("close","local",e))}},{key:"remoteClose",value:function(e){R.debug("remoteClose()"),this._closed||(this._closed=!0,this._transport&&this._transport.removeProducer(this,"remote",e),this._destroy(),this.emit("@close","remote",e),this.safeEmit("close","remote",e))}},{key:"_destroy",value:function(){this._transport=!1,this._rtpParameters=null;try{this._track.stop()}catch(e){}}},{key:"send",value:function(e){var t=this;return R.debug("send() [transport:%o]",e),this._closed?s.default.reject(new C.InvalidStateError("Producer closed")):this._transport?s.default.reject(new Error("already handled by a Transport")):"object"!==(void 0===e?"undefined":(0,a.default)(e))?s.default.reject(new TypeError("invalid Transport")):(this._transport=e,e.addProducer(this).then(function(){e.once("@close",function(){t._closed||t._transport!==e||(t._transport.removeProducer(t,"local"),t._transport=null,t._rtpParameters=null,t.safeEmit("unhandled"))}),t.safeEmit("handled"),t._statsEnabled&&e.enableProducerStats(t,t._statsInterval)}).catch(function(e){throw t._transport=null,e}))}},{key:"pause",value:function(e){return R.debug("pause()"),this._closed?(R.error("pause() | Producer closed"),!1):!!this._locallyPaused||(this._locallyPaused=!0,this._track.enabled=!1,this._transport&&this._transport.pauseProducer(this,e),this.safeEmit("pause","local",e),this.paused)}},{key:"remotePause",value:function(e){R.debug("remotePause()"),this._closed||this._remotelyPaused||(this._remotelyPaused=!0,this._track.enabled=!1,this.safeEmit("pause","remote",e))}},{key:"resume",value:function(e){return R.debug("resume()"),this._closed?(R.error("resume() | Producer closed"),!1):!this._locallyPaused||(this._locallyPaused=!1,this._remotelyPaused||(this._track.enabled=!0),this._transport&&this._transport.resumeProducer(this,e),this.safeEmit("resume","local",e),!this.paused)}},{key:"remoteResume",value:function(e){R.debug("remoteResume()"),!this._closed&&this._remotelyPaused&&(this._remotelyPaused=!1,this._locallyPaused||(this._track.enabled=!0),this.safeEmit("resume","remote",e))}},{key:"replaceTrack",value:function(e){var t=this;if(R.debug("replaceTrack() [track:%o]",e),this._closed)return s.default.reject(new C.InvalidStateError("Producer closed"));if(!(e instanceof MediaStreamTrack))return s.default.reject(new TypeError("track is not a MediaStreamTrack"));if("ended"===e.readyState)return s.default.reject(new Error('track.readyState is "ended"'));var r=e.clone();return s.default.resolve().then(function(){if(t._transport)return t._transport.replaceProducerTrack(t,r)}).then(function(){try{t._track.onended=null,t._track.stop()}catch(e){}return t.paused?r.enabled=!1:r.enabled=!0,t._originalTrack=e,t._track=r,t._handleTrack(),t._track})}},{key:"setRtpParameters",value:function(e){this._rtpParameters=e}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;if(R.debug("enableStats() [interval:%s]",e),this._closed)return void R.error("enableStats() | Producer closed");this._statsEnabled||(this._statsInterval="number"!=typeof e||e<1e3?x:e,this._statsEnabled=!0,this._transport&&this._transport.enableProducerStats(this,this._statsInterval))}},{key:"disableStats",value:function(){if(R.debug("disableStats()"),this._closed)return void R.error("disableStats() | Producer closed");this._statsEnabled&&(this._statsEnabled=!1,this._transport&&this._transport.disableProducerStats(this))}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"_handleTrack",value:function(){var e=this;this._track.onended=function(){e._closed||(R.warn('track "ended" event, closing Producer'),e.safeEmit("trackended"),e.close())}}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"track",get:function(){return this._track}},{key:"originalTrack",get:function(){return this._originalTrack}},{key:"simulcast",get:function(){return this._simulcast}},{key:"appData",get:function(){return this._appData}},{key:"transport",get:function(){return this._transport}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"locallyPaused",get:function(){return this._locallyPaused}},{key:"remotelyPaused",get:function(){return this._remotelyPaused}},{key:"paused",get:function(){return this._locallyPaused||this._remotelyPaused}}]),t}(P.default);t.default=O},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(17),a=n(o),i=r(13),s=n(i),u=r(20),c=n(u),d=r(4),l=n(d),f=r(1),p=n(f),m=r(3),h=n(m),v=r(6),_=n(v),y=r(7),g=n(y),b=r(10),w=n(b),k=r(22),P=n(k),C=new w.default("Peer"),S=function(e){function t(e,r){(0,p.default)(this,t);var n=(0,_.default)(this,(t.__proto__||(0,l.default)(t)).call(this,C));return n._name=e,n._closed=!1,n._appData=r,n._consumers=new c.default,n}return(0,g.default)(t,e),(0,h.default)(t,[{key:"close",value:function(){if(C.debug("close()"),!this._closed){this._closed=!0,this.emit("@close"),this.safeEmit("close","local");var e=!0,t=!1,r=void 0;try{for(var n,o=(0,s.default)(this._consumers.values());!(e=(n=o.next()).done);e=!0){n.value.close()}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}}},{key:"remoteClose",value:function(e){if(C.debug("remoteClose()"),!this._closed){this._closed=!0,this.emit("@close"),this.safeEmit("close","remote",e);var t=!0,r=!1,n=void 0;try{for(var o,a=(0,s.default)(this._consumers.values());!(t=(o=a.next()).done);t=!0){o.value.remoteClose()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}}},{key:"getConsumerById",value:function(e){return this._consumers.get(e)}},{key:"addConsumer",value:function(e){var t=this;if(this._consumers.has(e.id))throw new Error("Consumer already exists [id:"+e.id+"]");this._consumers.set(e.id,e),e.on("@close",function(){t._consumers.delete(e.id)}),this.safeEmit("newconsumer",e)}},{key:"name",get:function(){return this._name}},{key:"closed",get:function(){return this._closed}},{key:"appData",get:function(){return this._appData}},{key:"consumers",get:function(){return(0,a.default)(this._consumers.values())}}]),t}(P.default);t.default=S},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=n(o),i=r(11),s=n(i),u=r(4),c=n(u),d=r(1),l=n(d),f=r(3),p=n(f),m=r(6),h=n(m),v=r(7),_=n(v),y=r(53),g=n(y),b=r(10),w=n(b),k=r(22),P=n(k),C=r(43),S=new g.default(["default","low","medium","high"]),E=1e3,x=new w.default("Consumer"),T=function(e){function t(e,r,n,o,a){(0,l.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,x));return i._id=e,i._closed=!1,i._kind=r,i._rtpParameters=n,i._peer=o,i._appData=a,i._supported=!1,i._transport=null,i._track=null,i._locallyPaused=!1,i._remotelyPaused=!1,i._statsEnabled=!1,i._statsInterval=E,i._preferredProfile="default",i._effectiveProfile=null,i}return(0,_.default)(t,e),(0,p.default)(t,[{key:"close",value:function(){x.debug("close()"),this._closed||(this._closed=!0,this._statsEnabled&&(this._statsEnabled=!1,this.transport&&this.transport.disableConsumerStats(this)),this.emit("@close"),this.safeEmit("close","local"),this._destroy())}},{key:"remoteClose",value:function(){x.debug("remoteClose()"),this._closed||(this._closed=!0,this._transport&&this._transport.removeConsumer(this),this._destroy(),this.emit("@close"),this.safeEmit("close","remote"))}},{key:"_destroy",value:function(){this._transport=null;try{this._track.stop()}catch(e){}this._track=null}},{key:"receive",value:function(e){var t=this;return x.debug("receive() [transport:%o]",e),this._closed?s.default.reject(new C.InvalidStateError("Consumer closed")):this._supported?this._transport?s.default.reject(new Error("already handled by a Transport")):"object"!==(void 0===e?"undefined":(0,a.default)(e))?s.default.reject(new TypeError("invalid Transport")):(this._transport=e,e.addConsumer(this).then(function(r){return t._track=r,t.paused&&(r.enabled=!1),e.once("@close",function(){if(!t._closed&&t._transport===e){t._transport=null;try{t._track.stop()}catch(e){}t._track=null,t.safeEmit("unhandled")}}),t.safeEmit("handled"),t._statsEnabled&&e.enableConsumerStats(t,t._statsInterval),r}).catch(function(e){throw t._transport=null,e})):s.default.reject(new Error("unsupported codecs"))}},{key:"pause",value:function(e){return x.debug("pause()"),this._closed?(x.error("pause() | Consumer closed"),!1):!!this._locallyPaused||(this._locallyPaused=!0,this._track&&(this._track.enabled=!1),this._transport&&this._transport.pauseConsumer(this,e),this.safeEmit("pause","local",e),this.paused)}},{key:"remotePause",value:function(e){x.debug("remotePause()"),this._closed||this._remotelyPaused||(this._remotelyPaused=!0,this._track&&(this._track.enabled=!1),this.safeEmit("pause","remote",e))}},{key:"resume",value:function(e){return x.debug("resume()"),this._closed?(x.error("resume() | Consumer closed"),!1):!this._locallyPaused||(this._locallyPaused=!1,this._track&&!this._remotelyPaused&&(this._track.enabled=!0),this._transport&&this._transport.resumeConsumer(this,e),this.safeEmit("resume","local",e),!this.paused)}},{key:"remoteResume",value:function(e){x.debug("remoteResume()"),!this._closed&&this._remotelyPaused&&(this._remotelyPaused=!1,this._track&&!this._locallyPaused&&(this._track.enabled=!0),this.safeEmit("resume","remote",e))}},{key:"setPreferredProfile",value:function(e){if(x.debug("setPreferredProfile() [profile:%s]",e),this._closed)return void x.error("setPreferredProfile() | Consumer closed");if(e!==this._preferredProfile){if(!S.has(e))return void x.error('setPreferredProfile() | invalid profile "%s"',e);this._preferredProfile=e,this._transport&&this._transport.setConsumerPreferredProfile(this,this._preferredProfile)}}},{key:"remoteSetPreferredProfile",value:function(e){x.debug("remoteSetPreferredProfile() [profile:%s]",e),this._closed||e===this._preferredProfile||(this._preferredProfile=e)}},{key:"remoteEffectiveProfileChanged",value:function(e){x.debug("remoteEffectiveProfileChanged() [profile:%s]",e),this._closed||e===this._effectiveProfile||(this._effectiveProfile=e,this.safeEmit("effectiveprofilechange",this._effectiveProfile))}},{key:"enableStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;if(x.debug("enableStats() [interval:%s]",e),this._closed)return void x.error("enableStats() | Consumer closed");this._statsEnabled||(this._statsInterval="number"!=typeof e||e<1e3?E:e,this._statsEnabled=!0,this._transport&&this._transport.enableConsumerStats(this,this._statsInterval))}},{key:"disableStats",value:function(){if(x.debug("disableStats()"),this._closed)return void x.error("disableStats() | Consumer closed");this._statsEnabled&&(this._statsEnabled=!1,this._transport&&this._transport.disableConsumerStats(this))}},{key:"setSupported",value:function(e){this._supported=e}},{key:"remoteStats",value:function(e){this.safeEmit("stats",e)}},{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"peer",get:function(){return this._peer}},{key:"appData",get:function(){return this._appData}},{key:"supported",get:function(){return this._supported}},{key:"transport",get:function(){return this._transport}},{key:"track",get:function(){return this._track}},{key:"locallyPaused",get:function(){return this._locallyPaused}},{key:"remotelyPaused",get:function(){return this._remotelyPaused}},{key:"paused",get:function(){return this._locallyPaused||this._remotelyPaused}},{key:"preferredProfile",get:function(){return this._preferredProfile}},{key:"effectiveProfile",get:function(){return this._effectiveProfile}}]),t}(P.default);t.default=T},function(e,t,r){"use strict";function n(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function o(e){function r(){if(r.enabled){var e=r,n=+new Date,a=n-(o||n);e.diff=a,e.prev=o,e.curr=n,o=n;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var o=t.formatters[n];if("function"==typeof o){var a=i[u];r=o.call(e,a),i.splice(u,1),u--}return r}),t.formatArgs.call(e,i);(r.log||t.log||console.log.bind(console)).apply(e,i)}}var o;return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=n(e),r.destroy=a,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function a(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function i(e){t.save(e),t.names=[],t.skips=[];var r,n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&(e=n[r].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var a=t.instances[r];a.enabled=t.enabled(a.namespace)}}function s(){t.enable("")}function u(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o.debug=o.default=o,t.coerce=c,t.disable=s,t.enable=i,t.enabled=u,t.humanize=r(106),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,r){"use strict";function n(){return u=document.getElementById("mediasoup-demo-app-media-query-detector"),s.default.resolve()}function o(){return Boolean(u.offsetParent)}function a(){return!u.offsetParent}Object.defineProperty(t,"__esModule",{value:!0});var i=r(11),s=function(e){return e&&e.__esModule?e:{default:e}}(i);t.initialize=n,t.isDesktop=o,t.isMobile=a;var u=void 0},function(e,t,r){"use strict";function n(e){return e||(e={}),{length:e.length||8,numeric:"boolean"!=typeof e.numeric||e.numeric,letters:"boolean"!=typeof e.letters||e.letters,special:"boolean"==typeof e.special&&e.special,exclude:Array.isArray(e.exclude)?e.exclude:[]}}function o(e){var t="";e.numeric&&(t+=a),e.letters&&(t+=i),e.special&&(t+=s);for(var r=0;r<=e.exclude.length;r++)t=t.replace(e.exclude[r],"");return t}var a="0123456789",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",s="!$%^&*()_+|~-=`{}[]:;<>?,./";e.exports=function(e){e=n(e);var t,r,a="",i=e.length,s=(e.exclude,o(e));for(t=1;t<=i;t++)a+=s.substring(r=Math.floor(Math.random()*s.length),r+1);return a}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(95),a=r(238),i=n(a),s=r(239),u=n(s),c=r(240),d=n(c),l=r(241),f=n(l),p=r(242),m=n(p),h=r(243),v=n(h),_=(0,o.combineReducers)({room:i.default,me:u.default,producers:d.default,peers:f.default,consumers:m.default,notifications:v.default});t.default=_},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a={url:null,state:"new",activeSpeakerName:null},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,r=arguments[1];switch(r.type){case"SET_ROOM_URL":var n=r.payload.url;return(0,o.default)({},t,{url:n});case"SET_ROOM_STATE":var i=r.payload.state;return e.emitter.emit("SET_ROOM_STATE",i),"connected"==i?(0,o.default)({},t,{state:i}):(0,o.default)({},t,{state:i,activeSpeakerName:null});case"SET_ROOM_ACTIVE_SPEAKER":var s=r.payload.peerName;return e.emitter.emit("SET_ROOM_ACTIVE_SPEAKER",s),(0,o.default)({},t,{activeSpeakerName:s});default:return t}};t.default=i}).call(t,r(14))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a={name:null,displayName:null,displayNameSet:!1,device:null,canSendMic:!1,canSendWebcam:!1,canChangeWebcam:!1,webcamInProgress:!1,audioOnly:!1,audioOnlyInProgress:!1,restartIceInProgress:!1},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,r=arguments[1];switch(r.type){case"SET_ME":var n=r.payload,i=n.peerName,s=n.displayName,u=n.displayNameSet,c=n.device;return e.emitter.emit("SET_ME",r.payload),(0,o.default)({},t,{name:i,displayName:s,displayNameSet:u,device:c});case"SET_MEDIA_CAPABILITIES":var d=r.payload,l=d.canSendMic,f=d.canSendWebcam;return(0,o.default)({},t,{canSendMic:l,canSendWebcam:f});case"SET_CAN_CHANGE_WEBCAM":var p=r.payload;return e.emitter.emit("SET_CAN_CHANGE_WEBCAM",r.payload),(0,o.default)({},t,{canChangeWebcam:p});case"SET_WEBCAM_IN_PROGRESS":var m=r.payload.flag;return e.emitter.emit("SET_WEBCAM_IN_PROGRESS",r.payload),(0,o.default)({},t,{webcamInProgress:m});case"SET_DISPLAY_NAME":var h=r.payload.displayName;return h||(h=t.displayName),(0,o.default)({},t,{displayName:h,displayNameSet:!0});case"SET_AUDIO_ONLY_STATE":var v=r.payload.enabled;return(0,o.default)({},t,{audioOnly:v});case"SET_AUDIO_ONLY_IN_PROGRESS":var _=r.payload.flag;return(0,o.default)({},t,{audioOnlyInProgress:_});case"SET_RESTART_ICE_IN_PROGRESS":var y=r.payload.flag;return(0,o.default)({},t,{restartIceInProgress:y});default:return t}};t.default=i}).call(t,r(14))},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(79),a=n(o),i=r(19),s=n(i),u={},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,r=arguments[1];switch(r.type){case"ADD_PRODUCER":var n=r.payload.producer;return e.emitter.emit("ADD_PRODUCER",n),(0,s.default)({},t,(0,a.default)({},n.id,n));case"REMOVE_PRODUCER":var o=r.payload.producerId,i=(0,s.default)({},t);return delete i[o],e.emitter.emit("REMOVE_PRODUCER",producer),i;case"SET_PRODUCER_PAUSED":var c=r.payload,d=c.producerId,l=c.originator,f=t[d],p=void 0;return p="local"===l?(0,s.default)({},f,{locallyPaused:!0}):(0,s.default)({},f,{remotelyPaused:!0}),e.emitter.emit("SET_PRODUCER_PAUSED",p),(0,s.default)({},t,(0,a.default)({},d,p));case"SET_PRODUCER_RESUMED":var m=r.payload,h=m.producerId,v=m.originator,_=t[h],y=void 0;return y="local"===v?(0,s.default)({},_,{locallyPaused:!1}):(0,s.default)({},_,{remotelyPaused:!1}),e.emitter.emit("SET_PRODUCER_RESUMED",y),(0,s.default)({},t,(0,a.default)({},h,y));case"SET_PRODUCER_TRACK":var g=r.payload,b=g.producerId,w=g.track,k=t[b],P=(0,s.default)({},k,{track:w});return e.emitter.emit("SET_PRODUCER_TRACK",P),(0,s.default)({},t,(0,a.default)({},b,P));default:return t}};t.default=c}).call(t,r(14))},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(125),a=n(o),i=r(79),s=n(i),u=r(19),c=n(u),d={},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,r=arguments[1];switch(r.type){case"ADD_PEER":var n=r.payload.peer;return e.emitter.emit("peerAdded",n),(0,c.default)({},t,(0,s.default)({},n.name,n));case"REMOVE_PEER":var o=r.payload.peerName,i=(0,c.default)({},t);return delete i[o],e.emitter.emit("peerRemoved",o),i;case"SET_PEER_DISPLAY_NAME":var u=r.payload,l=u.displayName,f=u.peerName,p=t[f];if(!p)throw new Error("no Peer found");var m=(0,c.default)({},p,{displayName:l});return(0,c.default)({},t,(0,s.default)({},m.name,m));case"ADD_CONSUMER":var h=r.payload,v=h.consumer,_=h.peerName,y=t[_];if(!y)throw new Error("no Peer found for new Consumer");var g=[].concat((0,a.default)(y.consumers),[v.id]),b=(0,c.default)({},y,{consumers:g});return e.emitter.emit("peerConsumerAdded",b),(0,c.default)({},t,(0,s.default)({},b.name,b));case"REMOVE_CONSUMER":var w=r.payload,k=w.consumerId,P=w.peerName,C=t[P];if(!C)return t;var S=C.consumers.indexOf(k);if(-1===S)throw new Error("Consumer not found");var E=C.consumers.slice();E.splice(S,1);var x=(0,c.default)({},C,{consumers:E});return e.emitter.emit("peerConsumerRemoved",x),(0,c.default)({},t,(0,s.default)({},x.name,x));default:return t}};t.default=l}).call(t,r(14))},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(79),a=n(o),i=r(19),s=n(i),u={},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,r=arguments[1];switch(r.type){case"ADD_CONSUMER":var n=r.payload.consumer;return e.emitter.emit("ADD_CONSUMER",r.payload),(0,s.default)({},t,(0,a.default)({},n.id,n));case"REMOVE_CONSUMER":var o=r.payload.consumerId,i=(0,s.default)({},t);return delete i[o],e.emitter.emit("REMOVE_CONSUMER",r.payload),i;case"SET_CONSUMER_PAUSED":var c=r.payload,d=c.consumerId,l=c.originator,f=t[d],p=void 0;return p="local"===l?(0,s.default)({},f,{locallyPaused:!0}):(0,s.default)({},f,{remotelyPaused:!0}),e.emitter.emit("SET_CONSUMER_PAUSED",r.payload),(0,s.default)({},t,(0,a.default)({},d,p));case"SET_CONSUMER_RESUMED":var m=r.payload,h=m.consumerId,v=m.originator,_=t[h],y=void 0;return y="local"===v?(0,s.default)({},_,{locallyPaused:!1}):(0,s.default)({},_,{remotelyPaused:!1}),e.emitter.emit("SET_CONSUMER_RESUMED",r.payload),(0,s.default)({},t,(0,a.default)({},h,y));case"SET_CONSUMER_EFFECTIVE_PROFILE":var g=r.payload,b=g.consumerId,w=g.profile,k=t[b],P=(0,s.default)({},k,{profile:w});return e.emitter.emit("SET_CONSUMER_EFFECTIVE_PROFILE",P),(0,s.default)({},t,(0,a.default)({},b,P));case"SET_CONSUMER_TRACK":var C=r.payload,S=C.consumerId,E=C.track,x=t[S],T=(0,s.default)({},x,{track:E});return e.emitter.emit("SET_CONSUMER_TRACK",T),(0,s.default)({},t,(0,a.default)({},S,T));default:return t}};t.default=c}).call(t,r(14))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(125),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=[],i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case"ADD_NOTIFICATION":var r=t.payload.notification;return[].concat((0,o.default)(e),[r]);case"REMOVE_NOTIFICATION":var n=t.payload.notificationId;return e.filter(function(e){return e.id!==n});case"REMOVE_ALL_NOTIFICATIONS":return[];default:return e}};t.default=i},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(245),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(t){var r=t.dispatch,n=t.getState;return function(t){var a=void 0;return function(i){switch(i.type){case"JOIN_ROOM":var s=i.payload,u=s.media_server_wss,c=s.roomId,d=s.peerName,l=s.displayName,f=s.device,p=s.useSimulcast,m=s.produce,h=s.turnservers;a=new o.default({media_server_wss:u,roomId:c,peerName:d,displayName:l,device:f,useSimulcast:p,produce:m,dispatch:r,getState:n,turnservers:h}),e.CLIENT=a,e.emitter.emit("joinRoom",a);break;case"LEAVE_ROOM":a.close(),e.emitter.emit("leaveRoom",a);break;case"CHANGE_DISPLAY_NAME":var v=i.payload.displayName;a.changeDisplayName(v),e.emitter.emit("changeDisplayName",a);break;case"MUTE_MIC":a.muteMic(),e.emitter.emit("muteMic",a);break;case"UNMUTE_MIC":a.unmuteMic(),e.emitter.emit("unmuteMic",a);break;case"ENABLE_WEBCAM":a.enableWebcam(),e.emitter.emit("enableWebcam",a);break;case"DISABLE_WEBCAM":a.disableWebcam(),e.emitter.emit("disableWebcam",a);break;case"CHANGE_WEBCAM":a.changeWebcam(),e.emitter.emit("changeWebcam",a);break;case"ENABLE_AUDIO_ONLY":a.enableAudioOnly(),e.emitter.emit("enableAudioOnly",a);break;case"DISABLE_AUDIO_ONLY":a.disableAudioOnly(),e.emitter.emit("disableAudioOnly",a);break;case"RESTART_ICE":a.restartIce(),e.emitter.emit("restartIce",a)}return t(i)}}}}).call(t,r(14))},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),i=o(a),s=r(19),u=o(s),c=r(17),d=o(c),l=r(11),f=o(l),p=r(20),m=o(p),h=r(1),v=o(h),_=r(3),y=o(_),g=r(246),b=o(g),w=r(104),k=n(w),P=r(122),C=o(P),S=r(257),E=r(124),x=n(E),T=r(78),R=n(T),O=new C.default("RoomClient"),M={requestTimeout:1e4,transportOptions:{tcp:!1}},I={qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}}},A=function(){function e(t){var r=t.media_server_wss,n=t.roomId,o=t.peerName,a=t.displayName,i=t.device,s=t.useSimulcast,u=t.produce,c=t.dispatch,d=t.getState,l=t.turnservers;(0,v.default)(this,e),O.debug('constructor() [roomId:"%s", peerName:"%s", displayName:"%s", device:%s]',n,o,a,i.flag);var f=(0,S.getProtooUrl)(r,o,n),p=new b.default.WebSocketTransport(f);this._closed=!1,this._produce=u,this._useSimulcast=s,this._dispatch=c,this._getState=d,this._peerName=o,this._protoo=new b.default.Peer(p),M.turnServers=l,this._room=new k.Room(M),this._sendTransport=null,this._recvTransport=null,this._micProducer=null,this._webcamProducer=null,this._webcams=new m.default,this._webcam={device:null,resolution:"hd"},this._join({displayName:a,device:i})}return(0,y.default)(e,[{key:"close",value:function(){var e=this;this._closed||(this._closed=!0,O.debug("close()"),this._room.leave(),setTimeout(function(){return e._protoo.close()},250),this._dispatch(R.setRoomState("closed")))}},{key:"changeDisplayName",value:function(e){var t=this;return O.debug('changeDisplayName() [displayName:"%s"]',e),this._protoo.send("change-display-name",{displayName:e}).then(function(){t._dispatch(R.setDisplayName(e)),t._dispatch(x.notify({text:"Display name changed"}))}).catch(function(e){O.error("changeDisplayName() | failed: %o",e),t._dispatch(x.notify({type:"error",text:"Could not change display name: "+e})),t._dispatch(R.setDisplayName())})}},{key:"muteMic",value:function(){O.debug("muteMic()"),this._micProducer.pause()}},{key:"unmuteMic",value:function(){O.debug("unmuteMic()"),this._micProducer.resume()}},{key:"enableWebcam",value:function(){var e=this;return O.debug("enableWebcam()"),this._dispatch(R.setWebcamInProgress(!0)),f.default.resolve().then(function(){return e._updateWebcams()}).then(function(){return e._setWebcamProducer()}).then(function(){e._dispatch(R.setWebcamInProgress(!1))}).catch(function(t){O.error("enableWebcam() | failed: %o",t),e._dispatch(R.setWebcamInProgress(!1))})}},{key:"disableWebcam",value:function(){var e=this;return O.debug("disableWebcam()"),this._dispatch(R.setWebcamInProgress(!0)),f.default.resolve().then(function(){e._webcamProducer.close(),e._dispatch(R.setWebcamInProgress(!1))}).catch(function(t){O.error("disableWebcam() | failed: %o",t),e._dispatch(R.setWebcamInProgress(!1))})}},{key:"changeWebcam",value:function(){var e=this;return O.debug("changeWebcam()"),this._dispatch(R.setWebcamInProgress(!0)),f.default.resolve().then(function(){return e._updateWebcams()}).then(function(){var t=(0,d.default)(e._webcams.keys()),r=t.length,n=e._webcam.device?e._webcam.device.deviceId:void 0,o=t.indexOf(n);o<r-1?o++:o=0,e._webcam.device=e._webcams.get(t[o]),O.debug("changeWebcam() | new selected webcam [device:%o]",e._webcam.device),e._webcam.resolution="hd"}).then(function(){var t=e._webcam,r=t.device,n=t.resolution;if(!r)throw new Error("no webcam devices");return O.debug("changeWebcam() | calling getUserMedia()"),navigator.mediaDevices.getUserMedia({video:(0,u.default)({deviceId:{exact:r.deviceId}},I[n])})}).then(function(t){var r=t.getVideoTracks()[0];return e._webcamProducer.replaceTrack(r).then(function(e){return r.stop(),e})}).then(function(t){e._dispatch(R.setProducerTrack(e._webcamProducer.id,t)),e._dispatch(R.setWebcamInProgress(!1))}).catch(function(t){O.error("changeWebcam() failed: %o",t),e._dispatch(R.setWebcamInProgress(!1))})}},{key:"changeWebcamResolution",value:function(){var e=this;O.debug("changeWebcamResolution()");var t=void 0,r=void 0;return this._dispatch(R.setWebcamInProgress(!0)),f.default.resolve().then(function(){switch(t=e._webcam.resolution){case"qvga":r="vga";break;case"vga":r="hd";break;case"hd":r="qvga"}e._webcam.resolution=r}).then(function(){var t=e._webcam,r=t.device,n=t.resolution;return O.debug("changeWebcamResolution() | calling getUserMedia()"),navigator.mediaDevices.getUserMedia({video:(0,u.default)({deviceId:{exact:r.deviceId}},I[n])})}).then(function(t){var r=t.getVideoTracks()[0];return e._webcamProducer.replaceTrack(r).then(function(e){return r.stop(),e})}).then(function(t){e._dispatch(R.setProducerTrack(e._webcamProducer.id,t)),e._dispatch(R.setWebcamInProgress(!1))}).catch(function(r){O.error("changeWebcamResolution() failed: %o",r),e._dispatch(R.setWebcamInProgress(!1)),e._webcam.resolution=t})}},{key:"enableAudioOnly",value:function(){var e=this;return O.debug("enableAudioOnly()"),this._dispatch(R.setAudioOnlyInProgress(!0)),f.default.resolve().then(function(){e._webcamProducer&&e._webcamProducer.close();var t=!0,r=!1,n=void 0;try{for(var o,a=(0,i.default)(e._room.peers);!(t=(o=a.next()).done);t=!0){var s=o.value,u=!0,c=!1,d=void 0;try{for(var l,f=(0,i.default)(s.consumers);!(u=(l=f.next()).done);u=!0){var p=l.value;"video"===p.kind&&p.pause("audio-only-mode")}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}e._dispatch(R.setAudioOnlyState(!0)),e._dispatch(R.setAudioOnlyInProgress(!1))}).catch(function(t){O.error("enableAudioOnly() failed: %o",t),e._dispatch(R.setAudioOnlyInProgress(!1))})}},{key:"disableAudioOnly",value:function(){var e=this;return O.debug("disableAudioOnly()"),this._dispatch(R.setAudioOnlyInProgress(!0)),f.default.resolve().then(function(){if(!e._webcamProducer&&e._room.canSend("video"))return e.enableWebcam()}).then(function(){var t=!0,r=!1,n=void 0;try{for(var o,a=(0,i.default)(e._room.peers);!(t=(o=a.next()).done);t=!0){var s=o.value,u=!0,c=!1,d=void 0;try{for(var l,f=(0,i.default)(s.consumers);!(u=(l=f.next()).done);u=!0){var p=l.value;"video"===p.kind&&p.supported&&p.resume()}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}e._dispatch(R.setAudioOnlyState(!1)),e._dispatch(R.setAudioOnlyInProgress(!1))}).catch(function(t){O.error("disableAudioOnly() failed: %o",t),e._dispatch(R.setAudioOnlyInProgress(!1))})}},{key:"restartIce",value:function(){var e=this;return O.debug("restartIce()"),this._dispatch(R.setRestartIceInProgress(!0)),f.default.resolve().then(function(){e._room.restartIce(),setTimeout(function(){e._dispatch(R.setRestartIceInProgress(!1))},500)}).catch(function(t){O.error("restartIce() failed: %o",t),e._dispatch(R.setRestartIceInProgress(!1))})}},{key:"_join",value:function(e){var t=this,r=e.displayName,n=e.device;this._dispatch(R.setRoomState("connecting")),this._protoo.on("open",function(){O.debug('protoo Peer "open" event'),t._joinRoom({displayName:r,device:n})}),this._protoo.on("disconnected",function(){O.warn('protoo Peer "disconnected" event'),t._dispatch(x.notify({type:"error",text:"WebSocket disconnected"}));try{t._room.remoteClose({cause:"protoo disconnected"})}catch(e){}t._dispatch(R.setRoomState("connecting"))}),this._protoo.on("close",function(){t._closed||(O.warn('protoo Peer "close" event'),t.close())}),this._protoo.on("request",function(e,r,n){switch(O.debug("_handleProtooRequest() [method:%s, data:%o]",e.method,e.data),e.method){case"mediasoup-notification":r();var o=e.data;t._room.receiveNotification(o);break;case"active-speaker":r();var a=e.data.peerName;t._dispatch(R.setRoomActiveSpeaker(a));break;case"display-name-changed":r();var i=e.data,s=i.peerName,u=i.displayName,c=i.oldDisplayName,d=t._room.getPeerByName(s);if(!d){O.error("peer not found");break}d.appData.displayName=u,t._dispatch(R.setPeerDisplayName(u,s)),t._dispatch(x.notify({text:c+" is now "+u}));break;default:O.error('unknown protoo method "%s"',e.method),n(404,"unknown method")}})}},{key:"_joinRoom",value:function(e){var t=this,r=e.displayName,n=e.device;O.debug("_joinRoom()"),this._room.removeAllListeners(),this._room.on("close",function(e,r){if("remote"===e)return O.warn("mediasoup Peer/Room remotely closed [appData:%o]",r),void t._dispatch(R.setRoomState("closed"))}),this._room.on("request",function(e,r,n){O.debug("sending mediasoup request [method:%s]:%o",e.method,e),t._protoo.send("mediasoup-request",e).then(r).catch(n)}),this._room.on("notify",function(e){O.debug("sending mediasoup notification [method:%s]:%o",e.method,e),t._protoo.send("mediasoup-notification",e).catch(function(e){O.warn("could not send mediasoup notification:%o",e)})}),this._room.on("newpeer",function(e){O.debug('room "newpeer" event [name:"%s", peer:%o]',e.name,e),t._handlePeer(e)}),this._room.join(this._peerName,{displayName:r,device:n}).then(function(){t._sendTransport=t._room.createTransport("send",{media:"SEND_MIC_WEBCAM"}),t._sendTransport.on("close",function(e){O.debug('Transport "close" event [originator:%s]',e)}),t._recvTransport=t._room.createTransport("recv",{media:"RECV"}),t._recvTransport.on("close",function(e){O.debug('receiving Transport "close" event [originator:%s]',e)})}).then(function(){t._dispatch(R.setMediaCapabilities({canSendMic:t._room.canSend("audio"),canSendWebcam:t._room.canSend("video")}))}).then(function(){t._produce&&f.default.resolve().then(function(){t._room.canSend("audio")&&t._setMicProducer().catch(function(){})}).then(function(){t._room.canSend("video")&&t.enableWebcam()})}).then(function(){t._dispatch(R.setRoomState("connected")),t._dispatch(R.removeAllNotifications()),t._dispatch(x.notify({text:"You are in the room",timeout:5e3}));var e=t._room.peers,r=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(e);!(r=(a=s.next()).done);r=!0){var u=a.value;t._handlePeer(u,{notify:!1})}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}}).catch(function(e){O.error("_joinRoom() failed:%o",e),t._dispatch(x.notify({type:"error",text:"Could not join the room: "+e.toString()})),t.close()})}},{key:"_setMicProducer",value:function(){var e=this;if(!this._room.canSend("audio"))return f.default.reject(new Error("cannot send audio"));if(this._micProducer)return f.default.reject(new Error("mic Producer already exists"));var t=void 0;return f.default.resolve().then(function(){return O.debug("_setMicProducer() | calling getUserMedia()"),navigator.mediaDevices.getUserMedia({audio:!0})}).then(function(r){var n=r.getAudioTracks()[0];return t=e._room.createProducer(n,null,{source:"mic"}),n.stop(),t.send(e._sendTransport)}).then(function(){e._micProducer=t,e._dispatch(R.addProducer({id:t.id,source:"mic",locallyPaused:t.locallyPaused,remotelyPaused:t.remotelyPaused,track:t.track,codec:t.rtpParameters.codecs[0].name})),t.on("close",function(r){O.debug('mic Producer "close" event [originator:%s]',r),e._micProducer=null,e._dispatch(R.removeProducer(t.id))}),t.on("pause",function(r){O.debug('mic Producer "pause" event [originator:%s]',r),e._dispatch(R.setProducerPaused(t.id,r))}),t.on("resume",function(r){O.debug('mic Producer "resume" event [originator:%s]',r),e._dispatch(R.setProducerResumed(t.id,r))}),t.on("handled",function(){O.debug('mic Producer "handled" event')}),t.on("unhandled",function(){O.debug('mic Producer "unhandled" event')})}).then(function(){O.debug("_setMicProducer() succeeded")}).catch(function(r){throw O.error("_setMicProducer() failed:%o",r),e._dispatch(x.notify({text:"Mic producer failed: "+r.name+":"+r.message})),t&&t.close(),r})}},{key:"_setWebcamProducer",value:function(){var e=this;if(!this._room.canSend("video"))return f.default.reject(new Error("cannot send video"));if(this._webcamProducer)return f.default.reject(new Error("webcam Producer already exists"));var t=void 0;return f.default.resolve().then(function(){var t=e._webcam,r=t.device,n=t.resolution;if(!r)throw new Error("no webcam devices");return O.debug("_setWebcamProducer() | calling getUserMedia()"),navigator.mediaDevices.getUserMedia({video:(0,u.default)({deviceId:{exact:r.deviceId}},I[n])})}).then(function(r){var n=r.getVideoTracks()[0];return t=e._room.createProducer(n,{simulcast:e._useSimulcast},{source:"webcam"}),n.stop(),t.send(e._sendTransport)}).then(function(){e._webcamProducer=t;var r=e._webcam.device;e._dispatch(R.addProducer({id:t.id,source:"webcam",deviceLabel:r.label,type:e._getWebcamType(r),locallyPaused:t.locallyPaused,remotelyPaused:t.remotelyPaused,track:t.track,codec:t.rtpParameters.codecs[0].name})),t.on("close",function(r){O.debug('webcam Producer "close" event [originator:%s]',r),e._webcamProducer=null,e._dispatch(R.removeProducer(t.id))}),t.on("pause",function(r){O.debug('webcam Producer "pause" event [originator:%s]',r),e._dispatch(R.setProducerPaused(t.id,r))}),t.on("resume",function(r){O.debug('webcam Producer "resume" event [originator:%s]',r),e._dispatch(R.setProducerResumed(t.id,r))}),t.on("handled",function(){O.debug('webcam Producer "handled" event')}),t.on("unhandled",function(){O.debug('webcam Producer "unhandled" event')})}).then(function(){O.debug("_setWebcamProducer() succeeded")}).catch(function(r){throw O.error("_setWebcamProducer() failed:%o",r),e._dispatch(x.notify({text:"Webcam producer failed: "+r.name+":"+r.message})),t&&t.close(),r})}},{key:"_updateWebcams",value:function(){var e=this;return O.debug("_updateWebcams()"),this._webcams=new m.default,f.default.resolve().then(function(){return O.debug("_updateWebcams() | calling enumerateDevices()"),navigator.mediaDevices.enumerateDevices()}).then(function(t){var r=!0,n=!1,o=void 0;try{for(var a,s=(0,i.default)(t);!(r=(a=s.next()).done);r=!0){var u=a.value;"videoinput"===u.kind&&e._webcams.set(u.deviceId,u)}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}}).then(function(){var t=(0,d.default)(e._webcams.values()),r=t.length,n=e._webcam.device?e._webcam.device.deviceId:void 0;O.debug("_updateWebcams() [webcams:%o]",t),0===r?e._webcam.device=null:e._webcams.has(n)||(e._webcam.device=t[0]),e._dispatch(R.setCanChangeWebcam(e._webcams.size>=2))})}},{key:"_getWebcamType",value:function(e){return/(back|rear)/i.test(e.label)?(O.debug("_getWebcamType() | it seems to be a back camera"),"back"):(O.debug("_getWebcamType() | it seems to be a front camera"),"front")}},{key:"_handlePeer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.notify,o=void 0===n||n,a=e.appData.displayName;this._dispatch(R.addPeer({name:e.name,displayName:a,device:e.appData.device,consumers:[]})),o&&this._dispatch(x.notify({text:a+" joined the room"}));var s=!0,u=!1,c=void 0;try{for(var d,l=(0,i.default)(e.consumers);!(s=(d=l.next()).done);s=!0){var f=d.value;this._handleConsumer(f)}}catch(e){u=!0,c=e}finally{try{!s&&l.return&&l.return()}finally{if(u)throw c}}e.on("close",function(r){O.debug('peer "close" event [name:"%s", originator:%s]',e.name,r),t._dispatch(R.removePeer(e.name)),t._room.joined&&t._dispatch(x.notify({text:e.appData.displayName+" left the room"}))}),e.on("newconsumer",function(r){O.debug('peer "newconsumer" event [name:"%s", id:%s, consumer:%o]',e.name,r.id,r),t._handleConsumer(r)})}},{key:"_handleConsumer",value:function(e){var t=this,r=e.rtpParameters.codecs[0];this._dispatch(R.addConsumer({id:e.id,peerName:e.peer.name,source:e.appData.source,supported:e.supported,locallyPaused:e.locallyPaused,remotelyPaused:e.remotelyPaused,track:null,codec:r?r.name:null},e.peer.name)),e.on("close",function(r){O.debug('consumer "close" event [id:%s, originator:%s, consumer:%o]',e.id,r,e),t._dispatch(R.removeConsumer(e.id,e.peer.name))}),e.on("pause",function(r){O.debug('consumer "pause" event [id:%s, originator:%s, consumer:%o]',e.id,r,e),t._dispatch(R.setConsumerPaused(e.id,r))}),e.on("resume",function(r){O.debug('consumer "resume" event [id:%s, originator:%s, consumer:%o]',e.id,r,e),t._dispatch(R.setConsumerResumed(e.id,r))}),e.on("effectiveprofilechange",function(r){O.debug('consumer "effectiveprofilechange" event [id:%s, consumer:%o, profile:%s]',e.id,e,r),t._dispatch(R.setConsumerEffectiveProfile(e.id,r))}),e.supported&&("video"===e.kind&&this._getState().me.audioOnly&&e.pause("audio-only-mode"),e.receive(this._recvTransport).then(function(r){t._dispatch(R.setConsumerTrack(e.id,r))}).catch(function(e){O.error("unexpected error while receiving a new Consumer:%o",e)}))}}]),e}();t.default=A},function(e,t,r){"use strict";var n=r(247),o=r(249);e.exports={Peer:n,WebSocketTransport:o.WebSocketTransport}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(11),a=n(o),i=r(20),s=n(i),u=r(4),c=n(u),d=r(1),l=n(d),f=r(3),p=n(f),m=r(6),h=n(m),v=r(7),_=n(v),y=r(54).EventEmitter,g=r(80)("Peer"),b=r(126),w=function(e){function t(e){(0,l.default)(this,t),g.debug("constructor()");var r=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return r.setMaxListeners(1/0),r._transport=e,r._closed=!1,r._data={},r._requestHandlers=new s.default,r._handleTransport(),r}return(0,_.default)(t,e),(0,p.default)(t,[{key:"send",value:function(e,t){var r=this,n=b.requestFactory(e,t);return this._transport.send(n).then(function(){return new a.default(function(e,t){var o={resolve:function(t){r._requestHandlers.delete(n.id)&&(clearTimeout(o.timer),e(t))},reject:function(e){r._requestHandlers.delete(n.id)&&(clearTimeout(o.timer),t(e))},timer:setTimeout(function(){r._requestHandlers.delete(n.id)&&t(new Error("request timeout"))},2e4),close:function(){clearTimeout(o.timer),t(new Error("peer closed"))}};r._requestHandlers.set(n.id,o)})})}},{key:"close",value:function(){g.debug("close()"),this._closed||(this._closed=!0,this._transport.close(),this._requestHandlers.forEach(function(e){return e.close()}),this.emit("close"))}},{key:"_handleTransport",value:function(){var e=this;if(this._transport.closed)return this._closed=!0,void setTimeout(function(){return e.emit("close")});this._transport.on("connecting",function(t){e.emit("connecting",t)}),this._transport.on("open",function(){e._closed||e.emit("open")}),this._transport.on("disconnected",function(){e.emit("disconnected")}),this._transport.on("failed",function(t){e.emit("failed",t)}),this._transport.on("close",function(){e._closed||(e._closed=!0,e.emit("close"))}),this._transport.on("message",function(t){t.response?e._handleResponse(t):t.request&&e._handleRequest(t)})}},{key:"_handleResponse",value:function(e){var t=this._requestHandlers.get(e.id);if(!t)return void g.error("received response does not match any sent request");if(e.ok)t.resolve(e.data);else{var r=new Error(e.errorReason);r.code=e.errorCode,t.reject(r)}}},{key:"_handleRequest",value:function(e){var t=this;this.emit("request",e,function(r){var n=b.successResponseFactory(e,r);t._transport.send(n).catch(function(e){g.warn("accept() failed, response could not be sent: %o",e)})},function(r,n){r instanceof Error?(n=r.toString(),r=500):"number"==typeof r&&n instanceof Error&&(n=n.toString());var o=b.errorResponseFactory(e,r,n);t._transport.send(o).catch(function(e){g.warn("reject() failed, response could not be sent: %o",e)})})}},{key:"data",get:function(){return this._data},set:function(e){this._data=e||{}}},{key:"closed",get:function(){return this._closed}}]),t}(y);e.exports=w},function(e,t,r){"use strict";var n=r(119),o=n.generator({min:1e6,max:9999999,integer:!0});e.exports={randomNumber:o}},function(e,t,r){"use strict";var n=r(250);e.exports={WebSocketTransport:n}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(34),a=n(o),i=r(11),s=n(i),u=r(4),c=n(u),d=r(1),l=n(d),f=r(3),p=n(f),m=r(6),h=n(m),v=r(7),_=n(v),y=r(54).EventEmitter,g=r(251).w3cwebsocket,b=r(254),w=r(80)("WebSocketTransport"),k=r(126),P={retries:10,factor:2,minTimeout:1e3,maxTimeout:8e3},C=function(e){function t(e,r){(0,l.default)(this,t),w.debug('constructor() [url:"%s", options:%o]',e,r);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return n.setMaxListeners(1/0),n._url=e,n._options=r||{},n._ws=null,n._closed=!1,n._setWebSocket(),n}return(0,_.default)(t,e),(0,p.default)(t,[{key:"send",value:function(e){if(this._closed)return s.default.reject(new Error("transport closed"));try{return this._ws.send((0,a.default)(e)),s.default.resolve()}catch(e){return w.error("send() | error sending message: %o",e),s.default.reject(e)}}},{key:"close",value:function(){if(w.debug("close()"),!this._closed){this._closed=!0,this.emit("close");try{this._ws.onopen=null,this._ws.onclose=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.close()}catch(e){w.error("close() | error closing the WebSocket: %o",e)}}}},{key:"_setWebSocket",value:function(){var e=this,t=this._options,r=b.operation(this._options.retry||P),n=!1;r.attempt(function(o){if(e._closed)return void r.stop();w.debug("_setWebSocket() [currentAttempt:%s]",o),e._ws=new g(e._url,"protoo",t.origin,t.headers,t.requestOptions,t.clientConfig),e.emit("connecting",o),e._ws.onopen=function(){e._closed||(n=!0,e.emit("open"))},e._ws.onclose=function(t){if(!e._closed){if(w.warn('WebSocket "close" event [wasClean:%s, code:%s, reason:"%s"]',t.wasClean,t.code,t.reason),4e3!==t.code){if(n)return r.stop(),e.emit("disconnected"),void e._setWebSocket();if(e.emit("failed",o),r.retry(!0))return}e._closed=!0,e.emit("close")}},e._ws.onerror=function(){e._closed||w.error('WebSocket "error" event')},e._ws.onmessage=function(t){if(!e._closed){var r=k.parse(t.data);if(r)return 0===e.listenerCount("message")?void w.error('no listeners for WebSocket "message" event, ignoring received message'):void e.emit("message",r)}}})}},{key:"closed",get:function(){return this._closed}}]),t}(y);e.exports=C},function(e,t,r){"use strict";function n(e,t){return t?new s(e,t):new s(e)}var o=r(45),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(){return this}(),s=i.WebSocket||i.MozWebSocket,u=r(252);s&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){(0,a.default)(n,e,{get:function(){return s[e]}})}),e.exports={w3cwebsocket:s?n:null,version:u}},function(e,t,r){"use strict";e.exports=r(253).version},function(e,t){e.exports={_from:"websocket@^1.0.25",_id:"websocket@1.0.25",_inBundle:!1,_integrity:"sha512-M58njvi6ZxVb5k7kpnHh2BvNKuBWiwIYvsToErBzWhvBZYwlEiLcyLrG41T1jRcrY9ettqPYEqduLI7ul54CVQ==",_location:"/websocket",_phantomChildren:{ms:"2.0.0"},_requested:{type:"range",registry:!0,raw:"websocket@^1.0.25",name:"websocket",escapedName:"websocket",rawSpec:"^1.0.25",saveSpec:null,fetchSpec:"^1.0.25"},_requiredBy:["/protoo-client"],_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.25.tgz",_shasum:"998ec790f0a3eacb8b08b50a4350026692a11958",_spec:"websocket@^1.0.25",_where:"/home/alex/Desktop/JS/easy-mediasoup/node_modules/protoo-client",author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},browser:"lib/browser.js",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},bundleDependencies:!1,config:{verbose:!1},contributors:[{name:"Iñaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],dependencies:{debug:"^2.2.0",nan:"^2.3.3","typedarray-to-buffer":"^3.1.2",yaeti:"^0.0.6"},deprecated:!1,description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",devDependencies:{"buffer-equal":"^1.0.0",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^2.0.4",jshint:"^2.0.0","jshint-stylish":"^2.2.1",tape:"^4.0.1"},directories:{lib:"./lib"},engines:{node:">=0.10.0"},homepage:"https://github.com/theturtle32/WebSocket-Node",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],license:"Apache-2.0",main:"index",name:"websocket",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},scripts:{gulp:"gulp",install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit"},version:"1.0.25"}},function(e,t,r){"use strict";e.exports=r(255)},function(e,t,r){"use strict";var n=r(256);t.operation=function(e){var r=t.timeouts(e);return new n(r,{forever:e&&e.forever,unref:e&&e.unref})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<t.retries;o++)n.push(this.createTimeout(o,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(o,t)),n.sort(function(e,t){return e-t}),n},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,n=Math.round(r*t.minTimeout*Math.pow(t.factor,e));return n=Math.min(n,t.maxTimeout)},t.wrap=function(e,r,n){if(r instanceof Array&&(n=r,r=null),!n){n=[];for(var o in e)"function"==typeof e[o]&&n.push(o)}for(var a=0;a<n.length;a++){var i=n[a],s=e[i];e[i]=function(){var n=t.operation(r),o=Array.prototype.slice.call(arguments),a=o.pop();o.push(function(e){n.retry(e)||(e&&(arguments[0]=n.mainError()),a.apply(this,arguments))}),n.attempt(function(){s.apply(e,o)})},e[i].options=r}}},function(e,t,r){"use strict";function n(e,t){"boolean"==typeof t&&(t={forever:t}),this._timeouts=e,this._options=t||{},this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=n,n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;this._errors.push(e);var t=this._timeouts.shift();if(void 0===t){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),t=this._timeouts.shift()}var r=this,n=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),this._options.unref&&r._timeout.unref()),r._fn(r._attempts)},t);return this._options.unref&&n.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],a=o.message,i=(e[a]||0)+1;e[a]=i,i>=r&&(t=o,r=i)}return t}},function(e,t,r){"use strict";function n(e,t,r){window.location.hostname;return e||console.error("config.media_server_wss don't set."),e+"/?peerName="+t+"&roomId="+r}Object.defineProperty(t,"__esModule",{value:!0}),t.getProtooUrl=n},function(e,t,r){"use strict";function n(){}e.exports=n,n.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,r){this.callbacks=this.callbacks||{};var n=3===arguments.length,o=n?arguments[1]:void 0,a=n?arguments[2]:arguments[1];return a._groupName=o,(this.callbacks[e]=this.callbacks[e]||[]).push(a),this},t.once=function(e,t,r){function n(){o.off(e,n),s.apply(this,arguments)}var o=this,a=3===arguments.length,i=a?arguments[1]:void 0,s=a?arguments[2]:arguments[1];return this.on(e,i,n),this},t.releaseGroup=function(e){this.callbacks=this.callbacks||{};var t,r,n,o;for(t in this.callbacks)for(o=this.callbacks[t],r=0,n=o.length;r<n;r++)o[r]._groupName===e&&(o.splice(r,1),r--,n--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var r,n=this.callbacks[e];return n?1===arguments.length?(delete this.callbacks[e],this):(r=n.indexOf(t),n.splice(r,1),0===n.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,r,n,o=[].slice.call(arguments,1),a=this.callbacks[e],i=this.getWildcardCallbacks(e);if(a)for(n=a.slice(),t=0,r=n.length;t<r&&n[t];++t)n[t].apply(this,o);if(i)for(r=i.length,n=i.slice(),t=0,r=n.length;t<r&&n[t];++t)n[t].apply(this,[e].concat(o));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,r,n=[];for(t in this.callbacks)r=t.split("*"),("*"===t||2===r.length&&e.slice(0,r[0].length)===r[0])&&(n=n.concat(this.callbacks[t]));return n}},n.mixin(n)}]);